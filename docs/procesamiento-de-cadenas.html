<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 24 Procesamiento de cadenas | Introducción a la Ciencia de Datos</title>
  <meta name="description" content="Este libro presenta conceptos y destrezas que les ayudarán abordar los retos de situaciones actuales del análisis de datos. Cubre conceptos de probabilidad, inferencia estadística, regresión lineal y machine learning. Además, les permitirá desarrollar destrezas como la programación R, el wrangling de datos con dplyr, la visualización de datos con ggplot2, la organización de archivos con Shell de UNIX / Linux, el control de versiones con GitHub y la preparación de documentos reproducibles con R markdown." />
  <meta name="generator" content="bookdown 0.20.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 24 Procesamiento de cadenas | Introducción a la Ciencia de Datos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este libro presenta conceptos y destrezas que les ayudarán abordar los retos de situaciones actuales del análisis de datos. Cubre conceptos de probabilidad, inferencia estadística, regresión lineal y machine learning. Además, les permitirá desarrollar destrezas como la programación R, el wrangling de datos con dplyr, la visualización de datos con ggplot2, la organización de archivos con Shell de UNIX / Linux, el control de versiones con GitHub y la preparación de documentos reproducibles con R markdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 24 Procesamiento de cadenas | Introducción a la Ciencia de Datos" />
  
  <meta name="twitter:description" content="Este libro presenta conceptos y destrezas que les ayudarán abordar los retos de situaciones actuales del análisis de datos. Cubre conceptos de probabilidad, inferencia estadística, regresión lineal y machine learning. Además, les permitirá desarrollar destrezas como la programación R, el wrangling de datos con dplyr, la visualización de datos con ggplot2, la organización de archivos con Shell de UNIX / Linux, el control de versiones con GitHub y la preparación de documentos reproducibles con R markdown." />
  

<meta name="author" content="Rafael A. Irizarry" />


<meta name="date" content="2020-09-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="web-scraping.html"/>
<link rel="next" href="analizando-fechas-y-horas.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introducción a la Ciencia de Datos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="" data-path="agradecimientos.html"><a href="agradecimientos.html"><i class="fa fa-check"></i>Agradecimientos</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i>Introducción</a><ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#los-casos-de-estudio"><i class="fa fa-check"></i>Los casos de estudio</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#quién-encontrará-útil-este-libro"><i class="fa fa-check"></i>¿Quién encontrará útil este libro?</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#que-cubre-este-libro"><i class="fa fa-check"></i>¿Que cubre este libro?</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#qué-no-cubre-este-libro"><i class="fa fa-check"></i>¿Qué no cubre este libro?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Comenzando con R y RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#por-qué-r"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué R?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#la-consola-r"><i class="fa fa-check"></i><b>1.2</b> La consola R</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#scripts"><i class="fa fa-check"></i><b>1.3</b> <em>Scripts</em></a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#rstudio"><i class="fa fa-check"></i><b>1.4</b> RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="getting-started.html"><a href="getting-started.html#paneles"><i class="fa fa-check"></i><b>1.4.1</b> Paneles</a></li>
<li class="chapter" data-level="1.4.2" data-path="getting-started.html"><a href="getting-started.html#key-bindings"><i class="fa fa-check"></i><b>1.4.2</b> <em>Key bindings</em></a></li>
<li class="chapter" data-level="1.4.3" data-path="getting-started.html"><a href="getting-started.html#cómo-ejecutar-comandos-mientras-edita-scripts"><i class="fa fa-check"></i><b>1.4.3</b> Cómo ejecutar comandos mientras edita <em>scripts</em></a></li>
<li class="chapter" data-level="1.4.4" data-path="getting-started.html"><a href="getting-started.html#cómo-cambiar-las-opciones-globales"><i class="fa fa-check"></i><b>1.4.4</b> Cómo cambiar las opciones globales</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#instalación-de-paquetes-de-r"><i class="fa fa-check"></i><b>1.5</b> Instalación de paquetes de R</a></li>
</ul></li>
<li class="part"><span><b>I R</b></span></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> Lo básico de R</a><ul>
<li class="chapter" data-level="2.1" data-path="r-basics.html"><a href="r-basics.html#caso-de-estudio-los-asesinatos-con-armas-en-ee.-uu."><i class="fa fa-check"></i><b>2.1</b> Caso de estudio: los asesinatos con armas en EE. UU.</a></li>
<li class="chapter" data-level="2.2" data-path="r-basics.html"><a href="r-basics.html#lo-básico"><i class="fa fa-check"></i><b>2.2</b> Lo básico</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-basics.html"><a href="r-basics.html#objetos"><i class="fa fa-check"></i><b>2.2.1</b> Objetos</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-basics.html"><a href="r-basics.html#el-espacio-de-trabajo"><i class="fa fa-check"></i><b>2.2.2</b> El espacio de trabajo</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-basics.html"><a href="r-basics.html#funciones"><i class="fa fa-check"></i><b>2.2.3</b> Funciones</a></li>
<li class="chapter" data-level="2.2.4" data-path="r-basics.html"><a href="r-basics.html#otros-objetos-predefinidos"><i class="fa fa-check"></i><b>2.2.4</b> Otros objetos predefinidos</a></li>
<li class="chapter" data-level="2.2.5" data-path="r-basics.html"><a href="r-basics.html#nombres-de-variables"><i class="fa fa-check"></i><b>2.2.5</b> Nombres de variables</a></li>
<li class="chapter" data-level="2.2.6" data-path="r-basics.html"><a href="r-basics.html#cómo-guardar-su-espacio-de-trabajo"><i class="fa fa-check"></i><b>2.2.6</b> Cómo guardar su espacio de trabajo</a></li>
<li class="chapter" data-level="2.2.7" data-path="r-basics.html"><a href="r-basics.html#scripts-motivantes"><i class="fa fa-check"></i><b>2.2.7</b> <em>Scripts</em> motivantes</a></li>
<li class="chapter" data-level="2.2.8" data-path="r-basics.html"><a href="r-basics.html#cómo-comentar-su-código"><i class="fa fa-check"></i><b>2.2.8</b> Cómo comentar su código</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="r-basics.html"><a href="r-basics.html#tipos-de-datos"><i class="fa fa-check"></i><b>2.4</b> Tipos de datos</a><ul>
<li class="chapter" data-level="2.4.1" data-path="r-basics.html"><a href="r-basics.html#data-frames"><i class="fa fa-check"></i><b>2.4.1</b> <em>data frames</em></a></li>
<li class="chapter" data-level="2.4.2" data-path="r-basics.html"><a href="r-basics.html#cómo-examinar-un-objeto"><i class="fa fa-check"></i><b>2.4.2</b> Cómo examinar un objeto</a></li>
<li class="chapter" data-level="2.4.3" data-path="r-basics.html"><a href="r-basics.html#el-operador-de-acceso"><i class="fa fa-check"></i><b>2.4.3</b> El operador de acceso: <code>$</code></a></li>
<li class="chapter" data-level="2.4.4" data-path="r-basics.html"><a href="r-basics.html#vectores-numéricos-de-caracteres-y-lógicos"><i class="fa fa-check"></i><b>2.4.4</b> Vectores: numéricos, de caracteres y lógicos</a></li>
<li class="chapter" data-level="2.4.5" data-path="r-basics.html"><a href="r-basics.html#factors"><i class="fa fa-check"></i><b>2.4.5</b> Factores</a></li>
<li class="chapter" data-level="2.4.6" data-path="r-basics.html"><a href="r-basics.html#listas"><i class="fa fa-check"></i><b>2.4.6</b> Listas</a></li>
<li class="chapter" data-level="2.4.7" data-path="r-basics.html"><a href="r-basics.html#matrices"><i class="fa fa-check"></i><b>2.4.7</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r-basics.html"><a href="r-basics.html#ejercicios-1"><i class="fa fa-check"></i><b>2.5</b> Ejercicios</a></li>
<li class="chapter" data-level="2.6" data-path="r-basics.html"><a href="r-basics.html#vectors"><i class="fa fa-check"></i><b>2.6</b> Vectores</a><ul>
<li class="chapter" data-level="2.6.1" data-path="r-basics.html"><a href="r-basics.html#cómo-crear-vectores"><i class="fa fa-check"></i><b>2.6.1</b> Cómo crear vectores</a></li>
<li class="chapter" data-level="2.6.2" data-path="r-basics.html"><a href="r-basics.html#nombres"><i class="fa fa-check"></i><b>2.6.2</b> Nombres</a></li>
<li class="chapter" data-level="2.6.3" data-path="r-basics.html"><a href="r-basics.html#secuencias"><i class="fa fa-check"></i><b>2.6.3</b> Secuencias</a></li>
<li class="chapter" data-level="2.6.4" data-path="r-basics.html"><a href="r-basics.html#cómo-crear-un-subconjunto"><i class="fa fa-check"></i><b>2.6.4</b> Cómo crear un subconjunto</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="r-basics.html"><a href="r-basics.html#la-conversión-forzada"><i class="fa fa-check"></i><b>2.7</b> La conversión forzada</a><ul>
<li class="chapter" data-level="2.7.1" data-path="r-basics.html"><a href="r-basics.html#not-available-na"><i class="fa fa-check"></i><b>2.7.1</b> <em>Not available</em> (NA)</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="r-basics.html"><a href="r-basics.html#ejercicios-2"><i class="fa fa-check"></i><b>2.8</b> Ejercicios</a></li>
<li class="chapter" data-level="2.9" data-path="r-basics.html"><a href="r-basics.html#sorting"><i class="fa fa-check"></i><b>2.9</b> <em>Sorting</em></a><ul>
<li class="chapter" data-level="2.9.1" data-path="r-basics.html"><a href="r-basics.html#sort"><i class="fa fa-check"></i><b>2.9.1</b> <code>sort</code></a></li>
<li class="chapter" data-level="2.9.2" data-path="r-basics.html"><a href="r-basics.html#order"><i class="fa fa-check"></i><b>2.9.2</b> <code>order</code></a></li>
<li class="chapter" data-level="2.9.3" data-path="r-basics.html"><a href="r-basics.html#max-y-which.max"><i class="fa fa-check"></i><b>2.9.3</b> <code>max</code> y <code>which.max</code></a></li>
<li class="chapter" data-level="2.9.4" data-path="r-basics.html"><a href="r-basics.html#rank"><i class="fa fa-check"></i><b>2.9.4</b> <code>rank</code></a></li>
<li class="chapter" data-level="2.9.5" data-path="r-basics.html"><a href="r-basics.html#cuidado-con-el-reciclaje"><i class="fa fa-check"></i><b>2.9.5</b> Cuidado con el reciclaje</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="r-basics.html"><a href="r-basics.html#ejercicios-3"><i class="fa fa-check"></i><b>2.10</b> Ejercicios</a></li>
<li class="chapter" data-level="2.11" data-path="r-basics.html"><a href="r-basics.html#aritmética-de-vectores"><i class="fa fa-check"></i><b>2.11</b> Aritmética de vectores</a><ul>
<li class="chapter" data-level="2.11.1" data-path="r-basics.html"><a href="r-basics.html#rescaling-un-vector"><i class="fa fa-check"></i><b>2.11.1</b> <em>Rescaling</em> un vector</a></li>
<li class="chapter" data-level="2.11.2" data-path="r-basics.html"><a href="r-basics.html#dos-vectores"><i class="fa fa-check"></i><b>2.11.2</b> Dos vectores</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="r-basics.html"><a href="r-basics.html#ejercicios-4"><i class="fa fa-check"></i><b>2.12</b> Ejercicios</a></li>
<li class="chapter" data-level="2.13" data-path="r-basics.html"><a href="r-basics.html#indexación"><i class="fa fa-check"></i><b>2.13</b> Indexación</a><ul>
<li class="chapter" data-level="2.13.1" data-path="r-basics.html"><a href="r-basics.html#crear-subconjuntos-con-lógicos"><i class="fa fa-check"></i><b>2.13.1</b> Crear subconjuntos con lógicos</a></li>
<li class="chapter" data-level="2.13.2" data-path="r-basics.html"><a href="r-basics.html#operadores-lógicos"><i class="fa fa-check"></i><b>2.13.2</b> Operadores lógicos</a></li>
<li class="chapter" data-level="2.13.3" data-path="r-basics.html"><a href="r-basics.html#which"><i class="fa fa-check"></i><b>2.13.3</b> <code>which</code></a></li>
<li class="chapter" data-level="2.13.4" data-path="r-basics.html"><a href="r-basics.html#match"><i class="fa fa-check"></i><b>2.13.4</b> <code>match</code></a></li>
<li class="chapter" data-level="2.13.5" data-path="r-basics.html"><a href="r-basics.html#in"><i class="fa fa-check"></i><b>2.13.5</b> <code>%in%</code></a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="r-basics.html"><a href="r-basics.html#ejercicios-5"><i class="fa fa-check"></i><b>2.14</b> Ejercicios</a></li>
<li class="chapter" data-level="2.15" data-path="r-basics.html"><a href="r-basics.html#gráficos-básicos"><i class="fa fa-check"></i><b>2.15</b> Gráficos básicos</a><ul>
<li class="chapter" data-level="2.15.1" data-path="r-basics.html"><a href="r-basics.html#plot"><i class="fa fa-check"></i><b>2.15.1</b> <code>plot</code></a></li>
<li class="chapter" data-level="2.15.2" data-path="r-basics.html"><a href="r-basics.html#hist"><i class="fa fa-check"></i><b>2.15.2</b> <code>hist</code></a></li>
<li class="chapter" data-level="2.15.3" data-path="r-basics.html"><a href="r-basics.html#boxplot"><i class="fa fa-check"></i><b>2.15.3</b> <code>boxplot</code></a></li>
<li class="chapter" data-level="2.15.4" data-path="r-basics.html"><a href="r-basics.html#image"><i class="fa fa-check"></i><b>2.15.4</b> <code>image</code></a></li>
</ul></li>
<li class="chapter" data-level="2.16" data-path="r-basics.html"><a href="r-basics.html#ejercicios-6"><i class="fa fa-check"></i><b>2.16</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html"><i class="fa fa-check"></i><b>3</b> Conceptos básicos de programación</a><ul>
<li class="chapter" data-level="3.1" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html#conditionals"><i class="fa fa-check"></i><b>3.1</b> Expresiones condicionales</a></li>
<li class="chapter" data-level="3.2" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html#cómo-definir-funciones"><i class="fa fa-check"></i><b>3.2</b> Cómo definir funciones</a></li>
<li class="chapter" data-level="3.3" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html#namespaces"><i class="fa fa-check"></i><b>3.3</b> <em>Namespaces</em></a></li>
<li class="chapter" data-level="3.4" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html#bucles-for"><i class="fa fa-check"></i><b>3.4</b> Bucles-for</a></li>
<li class="chapter" data-level="3.5" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html#vectorization"><i class="fa fa-check"></i><b>3.5</b> Vectorización y funcionales</a></li>
<li class="chapter" data-level="3.6" data-path="conceptos-básicos-de-programación.html"><a href="conceptos-básicos-de-programación.html#ejercicios-7"><i class="fa fa-check"></i><b>3.6</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> <em>tidyverse</em></a><ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>4.1</b> Data <em>tidy</em></a></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-8"><i class="fa fa-check"></i><b>4.2</b> Ejercicios</a></li>
<li class="chapter" data-level="4.3" data-path="tidyverse.html"><a href="tidyverse.html#cómo-manipular-los-data-frames"><i class="fa fa-check"></i><b>4.3</b> Cómo manipular los <em>data frames</em></a><ul>
<li class="chapter" data-level="4.3.1" data-path="tidyverse.html"><a href="tidyverse.html#cómo-añadir-una-columna-con-mutate"><i class="fa fa-check"></i><b>4.3.1</b> Cómo añadir una columna con <code>mutate</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="tidyverse.html"><a href="tidyverse.html#cómo-crear-subconjuntos-con-filter"><i class="fa fa-check"></i><b>4.3.2</b> Cómo crear subconjuntos con <code>filter</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="tidyverse.html"><a href="tidyverse.html#cómo-seleccionar-columnas-con-select"><i class="fa fa-check"></i><b>4.3.3</b> Cómo seleccionar columnas con <code>select</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-9"><i class="fa fa-check"></i><b>4.4</b> Ejercicios</a></li>
<li class="chapter" data-level="4.5" data-path="tidyverse.html"><a href="tidyverse.html#el-pipe"><i class="fa fa-check"></i><b>4.5</b> El <em>pipe</em>: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.6" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-10"><i class="fa fa-check"></i><b>4.6</b> Ejercicios</a></li>
<li class="chapter" data-level="4.7" data-path="tidyverse.html"><a href="tidyverse.html#cómo-resumir-datos"><i class="fa fa-check"></i><b>4.7</b> Cómo resumir datos</a><ul>
<li class="chapter" data-level="4.7.1" data-path="tidyverse.html"><a href="tidyverse.html#summarize"><i class="fa fa-check"></i><b>4.7.1</b> <code>summarize</code></a></li>
<li class="chapter" data-level="4.7.2" data-path="tidyverse.html"><a href="tidyverse.html#pull"><i class="fa fa-check"></i><b>4.7.2</b> <code>pull</code></a></li>
<li class="chapter" data-level="4.7.3" data-path="tidyverse.html"><a href="tidyverse.html#group-by"><i class="fa fa-check"></i><b>4.7.3</b> Cómo agrupar y luego resumir con <code>group_by</code></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="tidyverse.html"><a href="tidyverse.html#cómo-ordenar-los-data-frames"><i class="fa fa-check"></i><b>4.8</b> Cómo ordenar los <em>data frames</em></a><ul>
<li class="chapter" data-level="4.8.1" data-path="tidyverse.html"><a href="tidyverse.html#cómo-ordenar-anidadamente"><i class="fa fa-check"></i><b>4.8.1</b> Cómo ordenar anidadamente</a></li>
<li class="chapter" data-level="4.8.2" data-path="tidyverse.html"><a href="tidyverse.html#los-primeros-n"><i class="fa fa-check"></i><b>4.8.2</b> Los primeros <span class="math inline">\(n\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-11"><i class="fa fa-check"></i><b>4.9</b> Ejercicios</a></li>
<li class="chapter" data-level="4.10" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>4.10</b> <em>Tibbles</em></a><ul>
<li class="chapter" data-level="4.10.1" data-path="tidyverse.html"><a href="tidyverse.html#los-tibbles-se-ven-mejor"><i class="fa fa-check"></i><b>4.10.1</b> Los <em>tibbles</em> se ven mejor</a></li>
<li class="chapter" data-level="4.10.2" data-path="tidyverse.html"><a href="tidyverse.html#los-subconjuntos-de-tibbles-son-tibbles"><i class="fa fa-check"></i><b>4.10.2</b> Los subconjuntos de <em>tibbles</em> son <em>tibbles</em></a></li>
<li class="chapter" data-level="4.10.3" data-path="tidyverse.html"><a href="tidyverse.html#los-tibbles-pueden-tener-entradas-complejas"><i class="fa fa-check"></i><b>4.10.3</b> Los <em>tibbles</em> pueden tener entradas complejas</a></li>
<li class="chapter" data-level="4.10.4" data-path="tidyverse.html"><a href="tidyverse.html#los-tibbles-se-pueden-agrupar"><i class="fa fa-check"></i><b>4.10.4</b> Los <em>tibbles</em> se pueden agrupar</a></li>
<li class="chapter" data-level="4.10.5" data-path="tidyverse.html"><a href="tidyverse.html#cómo-crear-un-tibble-usando-tibble-en-lugar-de-data.frame"><i class="fa fa-check"></i><b>4.10.5</b> Cómo crear un <em>tibble</em> usando <code>tibble</code> en lugar de <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="tidyverse.html"><a href="tidyverse.html#el-operador-punto"><i class="fa fa-check"></i><b>4.11</b> El operador punto</a></li>
<li class="chapter" data-level="4.12" data-path="tidyverse.html"><a href="tidyverse.html#do"><i class="fa fa-check"></i><b>4.12</b> <code>do</code></a></li>
<li class="chapter" data-level="4.13" data-path="tidyverse.html"><a href="tidyverse.html#el-paquete-purrr"><i class="fa fa-check"></i><b>4.13</b> El paquete <strong>purrr</strong></a></li>
<li class="chapter" data-level="4.14" data-path="tidyverse.html"><a href="tidyverse.html#los-condicionales-de-tidyverse"><i class="fa fa-check"></i><b>4.14</b> Los condicionales de <em>tidyverse</em></a><ul>
<li class="chapter" data-level="4.14.1" data-path="tidyverse.html"><a href="tidyverse.html#case_when"><i class="fa fa-check"></i><b>4.14.1</b> <code>case_when</code></a></li>
<li class="chapter" data-level="4.14.2" data-path="tidyverse.html"><a href="tidyverse.html#between"><i class="fa fa-check"></i><b>4.14.2</b> <code>between</code></a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="tidyverse.html"><a href="tidyverse.html#ejercicios-12"><i class="fa fa-check"></i><b>4.15</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>5</b> Importando datos</a><ul>
<li class="chapter" data-level="5.1" data-path="importing-data.html"><a href="importing-data.html#las-rutas-y-el-directorio-de-trabajo"><i class="fa fa-check"></i><b>5.1</b> Las rutas y el directorio de trabajo</a><ul>
<li class="chapter" data-level="5.1.1" data-path="importing-data.html"><a href="importing-data.html#el-sistema-de-archivos"><i class="fa fa-check"></i><b>5.1.1</b> El sistema de archivos</a></li>
<li class="chapter" data-level="5.1.2" data-path="importing-data.html"><a href="importing-data.html#las-rutas-relativas-y-completas"><i class="fa fa-check"></i><b>5.1.2</b> Las rutas relativas y completas</a></li>
<li class="chapter" data-level="5.1.3" data-path="importing-data.html"><a href="importing-data.html#el-directorio-de-trabajo"><i class="fa fa-check"></i><b>5.1.3</b> El directorio de trabajo</a></li>
<li class="chapter" data-level="5.1.4" data-path="importing-data.html"><a href="importing-data.html#cómo-generar-los-nombres-de-ruta"><i class="fa fa-check"></i><b>5.1.4</b> Cómo generar los nombres de ruta</a></li>
<li class="chapter" data-level="5.1.5" data-path="importing-data.html"><a href="importing-data.html#cómo-copiar-los-archivos-usando-rutas"><i class="fa fa-check"></i><b>5.1.5</b> Cómo copiar los archivos usando rutas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="importing-data.html"><a href="importing-data.html#los-paquetes-readr-y-readxl"><i class="fa fa-check"></i><b>5.2</b> Los paquetes readr y readxl</a><ul>
<li class="chapter" data-level="5.2.1" data-path="importing-data.html"><a href="importing-data.html#readr"><i class="fa fa-check"></i><b>5.2.1</b> readr</a></li>
<li class="chapter" data-level="5.2.2" data-path="importing-data.html"><a href="importing-data.html#readxl"><i class="fa fa-check"></i><b>5.2.2</b> readxl</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="importing-data.html"><a href="importing-data.html#ejercicios-13"><i class="fa fa-check"></i><b>5.3</b> Ejercicios</a></li>
<li class="chapter" data-level="5.4" data-path="importing-data.html"><a href="importing-data.html#cómo-descargar-archivos"><i class="fa fa-check"></i><b>5.4</b> Cómo descargar archivos</a></li>
<li class="chapter" data-level="5.5" data-path="importing-data.html"><a href="importing-data.html#las-funciones-de-importación-de-base-r"><i class="fa fa-check"></i><b>5.5</b> Las funciones de importación de base R</a><ul>
<li class="chapter" data-level="5.5.1" data-path="importing-data.html"><a href="importing-data.html#scan"><i class="fa fa-check"></i><b>5.5.1</b> <code>scan</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="importing-data.html"><a href="importing-data.html#archivos-de-texto-versus-archivos-binarios"><i class="fa fa-check"></i><b>5.6</b> Archivos de texto versus archivos binarios</a></li>
<li class="chapter" data-level="5.7" data-path="importing-data.html"><a href="importing-data.html#unicode-versus-ascii"><i class="fa fa-check"></i><b>5.7</b> Unicode versus ASCII</a></li>
<li class="chapter" data-level="5.8" data-path="importing-data.html"><a href="importing-data.html#cómo-organizar-datos-con-hojas-de-cálculo"><i class="fa fa-check"></i><b>5.8</b> Cómo organizar datos con hojas de cálculo</a></li>
<li class="chapter" data-level="5.9" data-path="importing-data.html"><a href="importing-data.html#ejercicios-14"><i class="fa fa-check"></i><b>5.9</b> Ejercicios</a></li>
</ul></li>
<li class="part"><span><b>II Visualización de datos</b></span></li>
<li class="chapter" data-level="6" data-path="introducción-a-la-visualización-de-datos.html"><a href="introducción-a-la-visualización-de-datos.html"><i class="fa fa-check"></i><b>6</b> Introducción a la visualización de datos</a></li>
<li class="chapter" data-level="7" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>7</b> ggplot2</a><ul>
<li class="chapter" data-level="7.1" data-path="ggplot2.html"><a href="ggplot2.html#los-componentes-de-un-gráfico"><i class="fa fa-check"></i><b>7.1</b> Los componentes de un gráfico</a></li>
<li class="chapter" data-level="7.2" data-path="ggplot2.html"><a href="ggplot2.html#objetos-ggplot"><i class="fa fa-check"></i><b>7.2</b> objetos <code>ggplot</code></a></li>
<li class="chapter" data-level="7.3" data-path="ggplot2.html"><a href="ggplot2.html#geometrías"><i class="fa fa-check"></i><b>7.3</b> Geometrías</a></li>
<li class="chapter" data-level="7.4" data-path="ggplot2.html"><a href="ggplot2.html#mapeos-estéticos"><i class="fa fa-check"></i><b>7.4</b> Mapeos estéticos</a></li>
<li class="chapter" data-level="7.5" data-path="ggplot2.html"><a href="ggplot2.html#capas"><i class="fa fa-check"></i><b>7.5</b> Capas</a><ul>
<li class="chapter" data-level="7.5.1" data-path="ggplot2.html"><a href="ggplot2.html#cómo-probar-varios-argumentos"><i class="fa fa-check"></i><b>7.5.1</b> Cómo probar varios argumentos</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ggplot2.html"><a href="ggplot2.html#mapeos-estéticos-globales-versus-locales"><i class="fa fa-check"></i><b>7.6</b> Mapeos estéticos globales versus locales</a></li>
<li class="chapter" data-level="7.7" data-path="ggplot2.html"><a href="ggplot2.html#escalas"><i class="fa fa-check"></i><b>7.7</b> Escalas</a></li>
<li class="chapter" data-level="7.8" data-path="ggplot2.html"><a href="ggplot2.html#etiquetas-y-títulos"><i class="fa fa-check"></i><b>7.8</b> Etiquetas y títulos</a></li>
<li class="chapter" data-level="7.9" data-path="ggplot2.html"><a href="ggplot2.html#categorías-como-colores"><i class="fa fa-check"></i><b>7.9</b> Categorías como colores</a></li>
<li class="chapter" data-level="7.10" data-path="ggplot2.html"><a href="ggplot2.html#anotación-formas-y-ajustes"><i class="fa fa-check"></i><b>7.10</b> Anotación, formas y ajustes</a></li>
<li class="chapter" data-level="7.11" data-path="ggplot2.html"><a href="ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>7.11</b> Paquetes complementarios</a></li>
<li class="chapter" data-level="7.12" data-path="ggplot2.html"><a href="ggplot2.html#cómo-combinarlo-todo"><i class="fa fa-check"></i><b>7.12</b> Cómo combinarlo todo</a></li>
<li class="chapter" data-level="7.13" data-path="ggplot2.html"><a href="ggplot2.html#qplot"><i class="fa fa-check"></i><b>7.13</b> Gráficos rápidos con <code>qplot</code></a></li>
<li class="chapter" data-level="7.14" data-path="ggplot2.html"><a href="ggplot2.html#cuadrículas-de-gráficos"><i class="fa fa-check"></i><b>7.14</b> Cuadrículas de gráficos</a></li>
<li class="chapter" data-level="7.15" data-path="ggplot2.html"><a href="ggplot2.html#ejercicios-15"><i class="fa fa-check"></i><b>7.15</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>8</b> Cómo visualizar distribuciones de datos</a><ul>
<li class="chapter" data-level="8.1" data-path="distributions.html"><a href="distributions.html#tipos-de-variables"><i class="fa fa-check"></i><b>8.1</b> Tipos de variables</a></li>
<li class="chapter" data-level="8.2" data-path="distributions.html"><a href="distributions.html#estudio-de-caso-describiendo-alturas-de-estudiantes"><i class="fa fa-check"></i><b>8.2</b> Estudio de caso: describiendo alturas de estudiantes</a></li>
<li class="chapter" data-level="8.3" data-path="distributions.html"><a href="distributions.html#la-función-de-distribución"><i class="fa fa-check"></i><b>8.3</b> La función de distribución</a></li>
<li class="chapter" data-level="8.4" data-path="distributions.html"><a href="distributions.html#cdf-intro"><i class="fa fa-check"></i><b>8.4</b> Funciones de distribución acumulada</a></li>
<li class="chapter" data-level="8.5" data-path="distributions.html"><a href="distributions.html#histogramas"><i class="fa fa-check"></i><b>8.5</b> Histogramas</a></li>
<li class="chapter" data-level="8.6" data-path="distributions.html"><a href="distributions.html#densidad-suave"><i class="fa fa-check"></i><b>8.6</b> Densidad suave</a><ul>
<li class="chapter" data-level="8.6.1" data-path="distributions.html"><a href="distributions.html#cómo-interpretar-el-eje-y"><i class="fa fa-check"></i><b>8.6.1</b> Cómo interpretar el eje-y</a></li>
<li class="chapter" data-level="8.6.2" data-path="distributions.html"><a href="distributions.html#densidades-permiten-estratificación"><i class="fa fa-check"></i><b>8.6.2</b> Densidades permiten estratificación</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="distributions.html"><a href="distributions.html#ejercicios-16"><i class="fa fa-check"></i><b>8.7</b> Ejercicios</a></li>
<li class="chapter" data-level="8.8" data-path="distributions.html"><a href="distributions.html#normal-distribution"><i class="fa fa-check"></i><b>8.8</b> La distribución normal</a></li>
<li class="chapter" data-level="8.9" data-path="distributions.html"><a href="distributions.html#unidades-estándar"><i class="fa fa-check"></i><b>8.9</b> Unidades estándar</a></li>
<li class="chapter" data-level="8.10" data-path="distributions.html"><a href="distributions.html#gráficos-q-q"><i class="fa fa-check"></i><b>8.10</b> Gráficos Q-Q</a></li>
<li class="chapter" data-level="8.11" data-path="distributions.html"><a href="distributions.html#percentiles"><i class="fa fa-check"></i><b>8.11</b> Percentiles</a></li>
<li class="chapter" data-level="8.12" data-path="distributions.html"><a href="distributions.html#diagramas-de-caja"><i class="fa fa-check"></i><b>8.12</b> Diagramas de caja</a></li>
<li class="chapter" data-level="8.13" data-path="distributions.html"><a href="distributions.html#stratification"><i class="fa fa-check"></i><b>8.13</b> Estratificación</a></li>
<li class="chapter" data-level="8.14" data-path="distributions.html"><a href="distributions.html#student-height-cont"><i class="fa fa-check"></i><b>8.14</b> Estudio de caso: descripción de alturas de estudiantes (continuación)</a></li>
<li class="chapter" data-level="8.15" data-path="distributions.html"><a href="distributions.html#ejercicios-17"><i class="fa fa-check"></i><b>8.15</b> Ejercicios</a></li>
<li class="chapter" data-level="8.16" data-path="distributions.html"><a href="distributions.html#other-geometries"><i class="fa fa-check"></i><b>8.16</b> Geometrías ggplot2</a><ul>
<li class="chapter" data-level="8.16.1" data-path="distributions.html"><a href="distributions.html#diagramas-de-barras"><i class="fa fa-check"></i><b>8.16.1</b> Diagramas de barras</a></li>
<li class="chapter" data-level="8.16.2" data-path="distributions.html"><a href="distributions.html#histogramas-1"><i class="fa fa-check"></i><b>8.16.2</b> Histogramas</a></li>
<li class="chapter" data-level="8.16.3" data-path="distributions.html"><a href="distributions.html#gráficos-de-densidad"><i class="fa fa-check"></i><b>8.16.3</b> Gráficos de densidad</a></li>
<li class="chapter" data-level="8.16.4" data-path="distributions.html"><a href="distributions.html#diagramas-de-caja-1"><i class="fa fa-check"></i><b>8.16.4</b> Diagramas de caja</a></li>
<li class="chapter" data-level="8.16.5" data-path="distributions.html"><a href="distributions.html#gráficos-q-q-1"><i class="fa fa-check"></i><b>8.16.5</b> Gráficos Q-Q</a></li>
<li class="chapter" data-level="8.16.6" data-path="distributions.html"><a href="distributions.html#imágenes"><i class="fa fa-check"></i><b>8.16.6</b> Imágenes</a></li>
<li class="chapter" data-level="8.16.7" data-path="distributions.html"><a href="distributions.html#gráficos-rápidos"><i class="fa fa-check"></i><b>8.16.7</b> Gráficos rápidos</a></li>
</ul></li>
<li class="chapter" data-level="8.17" data-path="distributions.html"><a href="distributions.html#ejercicios-18"><i class="fa fa-check"></i><b>8.17</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gapminder.html"><a href="gapminder.html"><i class="fa fa-check"></i><b>9</b> Visualización de datos en la práctica</a><ul>
<li class="chapter" data-level="9.1" data-path="gapminder.html"><a href="gapminder.html#estudio-de-caso-nuevas-ideas-sobre-la-pobreza"><i class="fa fa-check"></i><b>9.1</b> Estudio de caso: nuevas ideas sobre la pobreza</a><ul>
<li class="chapter" data-level="9.1.1" data-path="gapminder.html"><a href="gapminder.html#la-prueba-de-hans-rosling"><i class="fa fa-check"></i><b>9.1.1</b> La prueba de Hans Rosling</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="gapminder.html"><a href="gapminder.html#diagrama-de-dispersión"><i class="fa fa-check"></i><b>9.2</b> Diagrama de dispersión</a></li>
<li class="chapter" data-level="9.3" data-path="gapminder.html"><a href="gapminder.html#separar-en-facetas"><i class="fa fa-check"></i><b>9.3</b> Separar en facetas</a><ul>
<li class="chapter" data-level="9.3.1" data-path="gapminder.html"><a href="gapminder.html#facet_wrap"><i class="fa fa-check"></i><b>9.3.1</b> <code>facet_wrap</code></a></li>
<li class="chapter" data-level="9.3.2" data-path="gapminder.html"><a href="gapminder.html#escalas-fijas-para-mejores-comparaciones"><i class="fa fa-check"></i><b>9.3.2</b> Escalas fijas para mejores comparaciones</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="gapminder.html"><a href="gapminder.html#gráficos-de-series-de-tiempo"><i class="fa fa-check"></i><b>9.4</b> Gráficos de series de tiempo</a><ul>
<li class="chapter" data-level="9.4.1" data-path="gapminder.html"><a href="gapminder.html#etiquetas-en-lugar-de-leyendas"><i class="fa fa-check"></i><b>9.4.1</b> Etiquetas en lugar de leyendas</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="gapminder.html"><a href="gapminder.html#transformaciones-de-datos"><i class="fa fa-check"></i><b>9.5</b> Transformaciones de datos</a><ul>
<li class="chapter" data-level="9.5.1" data-path="gapminder.html"><a href="gapminder.html#transformación-logarítmica"><i class="fa fa-check"></i><b>9.5.1</b> Transformación logarítmica</a></li>
<li class="chapter" data-level="9.5.2" data-path="gapminder.html"><a href="gapminder.html#qué-base"><i class="fa fa-check"></i><b>9.5.2</b> ¿Qué base?</a></li>
<li class="chapter" data-level="9.5.3" data-path="gapminder.html"><a href="gapminder.html#transformar-los-valores-o-la-escala"><i class="fa fa-check"></i><b>9.5.3</b> ¿Transformar los valores o la escala?</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="gapminder.html"><a href="gapminder.html#cómo-visualizar-distribuciones-multimodales"><i class="fa fa-check"></i><b>9.6</b> Cómo visualizar distribuciones multimodales</a></li>
<li class="chapter" data-level="9.7" data-path="gapminder.html"><a href="gapminder.html#cómo-comparar-múltiples-distribuciones-con-diagramas-de-caja-y-gráficos-ridge"><i class="fa fa-check"></i><b>9.7</b> Cómo comparar múltiples distribuciones con diagramas de caja y gráficos <em>ridge</em></a><ul>
<li class="chapter" data-level="9.7.1" data-path="gapminder.html"><a href="gapminder.html#diagrama-de-caja"><i class="fa fa-check"></i><b>9.7.1</b> Diagrama de caja</a></li>
<li class="chapter" data-level="9.7.2" data-path="gapminder.html"><a href="gapminder.html#gráficos-ridge"><i class="fa fa-check"></i><b>9.7.2</b> Gráficos <em>ridge</em></a></li>
<li class="chapter" data-level="9.7.3" data-path="gapminder.html"><a href="gapminder.html#ejemplo-distribuciones-de-ingresos-de-1970-versus-2010"><i class="fa fa-check"></i><b>9.7.3</b> Ejemplo: distribuciones de ingresos de 1970 versus 2010</a></li>
<li class="chapter" data-level="9.7.4" data-path="gapminder.html"><a href="gapminder.html#cómo-obtener-acceso-a-variables-calculadas"><i class="fa fa-check"></i><b>9.7.4</b> Cómo obtener acceso a variables calculadas</a></li>
<li class="chapter" data-level="9.7.5" data-path="gapminder.html"><a href="gapminder.html#densidades-ponderadas"><i class="fa fa-check"></i><b>9.7.5</b> Densidades ponderadas</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="gapminder.html"><a href="gapminder.html#la-falacia-ecológica-y-la-importancia-de-mostrar-los-datos"><i class="fa fa-check"></i><b>9.8</b> La falacia ecológica y la importancia de mostrar los datos</a><ul>
<li class="chapter" data-level="9.8.1" data-path="gapminder.html"><a href="gapminder.html#logit"><i class="fa fa-check"></i><b>9.8.1</b> Transformación logística</a></li>
<li class="chapter" data-level="9.8.2" data-path="gapminder.html"><a href="gapminder.html#mostrar-los-datos"><i class="fa fa-check"></i><b>9.8.2</b> Mostrar los datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html"><i class="fa fa-check"></i><b>10</b> Principios de visualización de datos</a><ul>
<li class="chapter" data-level="10.1" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#cómo-codificar-datos-utilizando-señales-visuales"><i class="fa fa-check"></i><b>10.1</b> Cómo codificar datos utilizando señales visuales</a></li>
<li class="chapter" data-level="10.2" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#sepa-cuándo-incluir-0"><i class="fa fa-check"></i><b>10.2</b> Sepa cuándo incluir 0</a></li>
<li class="chapter" data-level="10.3" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#no-distorsionar-cantidades"><i class="fa fa-check"></i><b>10.3</b> No distorsionar cantidades</a></li>
<li class="chapter" data-level="10.4" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#ordenar-categorías-por-un-valor-significativo"><i class="fa fa-check"></i><b>10.4</b> Ordenar categorías por un valor significativo</a></li>
<li class="chapter" data-level="10.5" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#mostrar-los-datos-1"><i class="fa fa-check"></i><b>10.5</b> Mostrar los datos</a></li>
<li class="chapter" data-level="10.6" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#cómo-facilitar-comparaciones"><i class="fa fa-check"></i><b>10.6</b> Cómo facilitar comparaciones</a><ul>
<li class="chapter" data-level="10.6.1" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#use-ejes-comunes"><i class="fa fa-check"></i><b>10.6.1</b> Use ejes comunes</a></li>
<li class="chapter" data-level="10.6.2" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#alinee-gráficos-verticalmente-para-ver-cambios-horizontales-y-horizontalmente-para-ver-cambios-verticales"><i class="fa fa-check"></i><b>10.6.2</b> Alinee gráficos verticalmente para ver cambios horizontales y horizontalmente para ver cambios verticales</a></li>
<li class="chapter" data-level="10.6.3" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#considere-transformaciones"><i class="fa fa-check"></i><b>10.6.3</b> Considere transformaciones</a></li>
<li class="chapter" data-level="10.6.4" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#señales-visuales-comparadas-deben-estar-adyacentes"><i class="fa fa-check"></i><b>10.6.4</b> Señales visuales comparadas deben estar adyacentes</a></li>
<li class="chapter" data-level="10.6.5" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#use-color"><i class="fa fa-check"></i><b>10.6.5</b> Use color</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#piense-en-los-daltónicos"><i class="fa fa-check"></i><b>10.7</b> Piense en los daltónicos</a></li>
<li class="chapter" data-level="10.8" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#gráficos-para-dos-variables"><i class="fa fa-check"></i><b>10.8</b> Gráficos para dos variables</a><ul>
<li class="chapter" data-level="10.8.1" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#slope-charts"><i class="fa fa-check"></i><b>10.8.1</b> Slope charts</a></li>
<li class="chapter" data-level="10.8.2" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#gráfico-bland-altman"><i class="fa fa-check"></i><b>10.8.2</b> Gráfico Bland-Altman</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#cómo-codificar-una-tercera-variable"><i class="fa fa-check"></i><b>10.9</b> Cómo codificar una tercera variable</a></li>
<li class="chapter" data-level="10.10" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#evite-los-gráficos-pseudo-tridimensionales"><i class="fa fa-check"></i><b>10.10</b> Evite los gráficos pseudo-tridimensionales</a></li>
<li class="chapter" data-level="10.11" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#evite-demasiados-dígitos-significativos"><i class="fa fa-check"></i><b>10.11</b> Evite demasiados dígitos significativos</a></li>
<li class="chapter" data-level="10.12" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#conozca-a-su-audiencia"><i class="fa fa-check"></i><b>10.12</b> Conozca a su audiencia</a></li>
<li class="chapter" data-level="10.13" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#ejercicios-19"><i class="fa fa-check"></i><b>10.13</b> Ejercicios</a></li>
<li class="chapter" data-level="10.14" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#vaccines"><i class="fa fa-check"></i><b>10.14</b> Estudio de caso: las vacunas y las enfermedades infecciosas</a></li>
<li class="chapter" data-level="10.15" data-path="principios-de-visualización-de-datos.html"><a href="principios-de-visualización-de-datos.html#ejercicios-20"><i class="fa fa-check"></i><b>10.15</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="robust-summaries.html"><a href="robust-summaries.html"><i class="fa fa-check"></i><b>11</b> Resúmenes robustos</a><ul>
<li class="chapter" data-level="11.1" data-path="robust-summaries.html"><a href="robust-summaries.html#valores-atípicos"><i class="fa fa-check"></i><b>11.1</b> Valores atípicos</a></li>
<li class="chapter" data-level="11.2" data-path="robust-summaries.html"><a href="robust-summaries.html#mediana"><i class="fa fa-check"></i><b>11.2</b> Mediana</a></li>
<li class="chapter" data-level="11.3" data-path="robust-summaries.html"><a href="robust-summaries.html#el-rango-intercuartil-iqr"><i class="fa fa-check"></i><b>11.3</b> El rango intercuartil (IQR)</a></li>
<li class="chapter" data-level="11.4" data-path="robust-summaries.html"><a href="robust-summaries.html#la-definición-de-tukey-de-un-valor-atípico"><i class="fa fa-check"></i><b>11.4</b> La definición de Tukey de un valor atípico</a></li>
<li class="chapter" data-level="11.5" data-path="robust-summaries.html"><a href="robust-summaries.html#desviación-absoluta-mediana"><i class="fa fa-check"></i><b>11.5</b> Desviación absoluta mediana</a></li>
<li class="chapter" data-level="11.6" data-path="robust-summaries.html"><a href="robust-summaries.html#ejercicios-21"><i class="fa fa-check"></i><b>11.6</b> Ejercicios</a></li>
<li class="chapter" data-level="11.7" data-path="robust-summaries.html"><a href="robust-summaries.html#estudio-de-caso-alturas-autoreportadas-de-estudiantes"><i class="fa fa-check"></i><b>11.7</b> Estudio de caso: alturas autoreportadas de estudiantes</a></li>
</ul></li>
<li class="part"><span><b>III Estadísticas con R</b></span></li>
<li class="chapter" data-level="12" data-path="introducción-a-las-estadísticas-con-r.html"><a href="introducción-a-las-estadísticas-con-r.html"><i class="fa fa-check"></i><b>12</b> Introducción a las estadísticas con R</a></li>
<li class="chapter" data-level="13" data-path="probabilidad.html"><a href="probabilidad.html"><i class="fa fa-check"></i><b>13</b> Probabilidad</a><ul>
<li class="chapter" data-level="13.1" data-path="probabilidad.html"><a href="probabilidad.html#probabilidad-discreta"><i class="fa fa-check"></i><b>13.1</b> Probabilidad discreta</a><ul>
<li class="chapter" data-level="13.1.1" data-path="probabilidad.html"><a href="probabilidad.html#frecuencia-relativa"><i class="fa fa-check"></i><b>13.1.1</b> Frecuencia relativa</a></li>
<li class="chapter" data-level="13.1.2" data-path="probabilidad.html"><a href="probabilidad.html#notación"><i class="fa fa-check"></i><b>13.1.2</b> Notación</a></li>
<li class="chapter" data-level="13.1.3" data-path="probabilidad.html"><a href="probabilidad.html#distribuciones-de-probabilidad"><i class="fa fa-check"></i><b>13.1.3</b> Distribuciones de probabilidad</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="probabilidad.html"><a href="probabilidad.html#simulaciones-monte-carlo-para-datos-categóricos"><i class="fa fa-check"></i><b>13.2</b> Simulaciones Monte Carlo para datos categóricos</a><ul>
<li class="chapter" data-level="13.2.1" data-path="probabilidad.html"><a href="probabilidad.html#fijar-la-semilla-aleatoria"><i class="fa fa-check"></i><b>13.2.1</b> Fijar la semilla aleatoria</a></li>
<li class="chapter" data-level="13.2.2" data-path="probabilidad.html"><a href="probabilidad.html#con-y-sin-reemplazo"><i class="fa fa-check"></i><b>13.2.2</b> Con y sin reemplazo</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="probabilidad.html"><a href="probabilidad.html#independencia"><i class="fa fa-check"></i><b>13.3</b> Independencia</a></li>
<li class="chapter" data-level="13.4" data-path="probabilidad.html"><a href="probabilidad.html#probabilidades-condicionales"><i class="fa fa-check"></i><b>13.4</b> Probabilidades condicionales</a></li>
<li class="chapter" data-level="13.5" data-path="probabilidad.html"><a href="probabilidad.html#reglas-de-la-adición-y-de-la-multiplicación"><i class="fa fa-check"></i><b>13.5</b> Reglas de la adición y de la multiplicación</a><ul>
<li class="chapter" data-level="13.5.1" data-path="probabilidad.html"><a href="probabilidad.html#regla-de-la-multiplicación"><i class="fa fa-check"></i><b>13.5.1</b> Regla de la multiplicación</a></li>
<li class="chapter" data-level="13.5.2" data-path="probabilidad.html"><a href="probabilidad.html#regla-de-la-multiplicación-bajo-independencia"><i class="fa fa-check"></i><b>13.5.2</b> Regla de la multiplicación bajo independencia</a></li>
<li class="chapter" data-level="13.5.3" data-path="probabilidad.html"><a href="probabilidad.html#regla-de-la-adición"><i class="fa fa-check"></i><b>13.5.3</b> Regla de la adición</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="probabilidad.html"><a href="probabilidad.html#combinaciones-y-permutaciones"><i class="fa fa-check"></i><b>13.6</b> Combinaciones y permutaciones</a><ul>
<li class="chapter" data-level="13.6.1" data-path="probabilidad.html"><a href="probabilidad.html#ejemplo-monte-carlo"><i class="fa fa-check"></i><b>13.6.1</b> Ejemplo Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="probabilidad.html"><a href="probabilidad.html#ejemplos"><i class="fa fa-check"></i><b>13.7</b> Ejemplos</a><ul>
<li class="chapter" data-level="13.7.1" data-path="probabilidad.html"><a href="probabilidad.html#problema-monty-hall"><i class="fa fa-check"></i><b>13.7.1</b> Problema Monty Hall</a></li>
<li class="chapter" data-level="13.7.2" data-path="probabilidad.html"><a href="probabilidad.html#problema-de-cumpleaños"><i class="fa fa-check"></i><b>13.7.2</b> Problema de cumpleaños</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="probabilidad.html"><a href="probabilidad.html#infinito-en-la-práctica"><i class="fa fa-check"></i><b>13.8</b> Infinito en la práctica</a></li>
<li class="chapter" data-level="13.9" data-path="probabilidad.html"><a href="probabilidad.html#ejercicios-22"><i class="fa fa-check"></i><b>13.9</b> Ejercicios</a></li>
<li class="chapter" data-level="13.10" data-path="probabilidad.html"><a href="probabilidad.html#probabilidad-continua"><i class="fa fa-check"></i><b>13.10</b> Probabilidad continua</a></li>
<li class="chapter" data-level="13.11" data-path="probabilidad.html"><a href="probabilidad.html#distribuciones-teóricas-continuas"><i class="fa fa-check"></i><b>13.11</b> Distribuciones teóricas continuas</a><ul>
<li class="chapter" data-level="13.11.1" data-path="probabilidad.html"><a href="probabilidad.html#distribuciones-teóricas-como-aproximaciones"><i class="fa fa-check"></i><b>13.11.1</b> Distribuciones teóricas como aproximaciones</a></li>
<li class="chapter" data-level="13.11.2" data-path="probabilidad.html"><a href="probabilidad.html#la-densidad-de-probabilidad"><i class="fa fa-check"></i><b>13.11.2</b> La densidad de probabilidad</a></li>
</ul></li>
<li class="chapter" data-level="13.12" data-path="probabilidad.html"><a href="probabilidad.html#simulaciones-monte-carlo-para-variables-continuas"><i class="fa fa-check"></i><b>13.12</b> Simulaciones Monte Carlo para variables continuas</a></li>
<li class="chapter" data-level="13.13" data-path="probabilidad.html"><a href="probabilidad.html#distribuciones-continuas"><i class="fa fa-check"></i><b>13.13</b> Distribuciones continuas</a></li>
<li class="chapter" data-level="13.14" data-path="probabilidad.html"><a href="probabilidad.html#ejercicios-23"><i class="fa fa-check"></i><b>13.14</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>14</b> Variables aleatorias</a><ul>
<li class="chapter" data-level="14.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-1"><i class="fa fa-check"></i><b>14.1</b> Variables aleatorias</a></li>
<li class="chapter" data-level="14.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#modelos-de-muestreo"><i class="fa fa-check"></i><b>14.2</b> Modelos de muestreo</a></li>
<li class="chapter" data-level="14.3" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#la-distribución-de-probabilidad-de-una-variable-aleatoria"><i class="fa fa-check"></i><b>14.3</b> La distribución de probabilidad de una variable aleatoria</a></li>
<li class="chapter" data-level="14.4" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribuciones-versus-distribuciones-de-probabilidad"><i class="fa fa-check"></i><b>14.4</b> Distribuciones versus distribuciones de probabilidad</a></li>
<li class="chapter" data-level="14.5" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#notación-para-variables-aleatorias"><i class="fa fa-check"></i><b>14.5</b> Notación para variables aleatorias</a></li>
<li class="chapter" data-level="14.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#el-valor-esperado-y-el-error-estándar"><i class="fa fa-check"></i><b>14.6</b> El valor esperado y el error estándar</a><ul>
<li class="chapter" data-level="14.6.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#población-sd-versus-la-muestra-sd"><i class="fa fa-check"></i><b>14.6.1</b> Población SD versus la muestra SD</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#teorema-del-límite-central"><i class="fa fa-check"></i><b>14.7</b> Teorema del límite central</a><ul>
<li class="chapter" data-level="14.7.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#cuán-grande-es-grande-en-el-teorema-del-límite-central"><i class="fa fa-check"></i><b>14.7.1</b> ¿Cuán grande es grande en el teorema del límite central?</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#propiedades-estadísticas-de-promedios"><i class="fa fa-check"></i><b>14.8</b> Propiedades estadísticas de promedios</a></li>
<li class="chapter" data-level="14.9" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#ley-de-los-grandes-números"><i class="fa fa-check"></i><b>14.9</b> Ley de los grandes números</a><ul>
<li class="chapter" data-level="14.9.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#malinterpretando-la-ley-de-promedios"><i class="fa fa-check"></i><b>14.9.1</b> Malinterpretando la ley de promedios</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#ejercicios-24"><i class="fa fa-check"></i><b>14.10</b> Ejercicios</a></li>
<li class="chapter" data-level="14.11" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#estudio-de-caso-the-big-short"><i class="fa fa-check"></i><b>14.11</b> Estudio de caso: The Big Short</a><ul>
<li class="chapter" data-level="14.11.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#tasas-de-interés-explicadas-con-modelo-de-oportunidad"><i class="fa fa-check"></i><b>14.11.1</b> Tasas de interés explicadas con modelo de oportunidad</a></li>
<li class="chapter" data-level="14.11.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#the-big-short"><i class="fa fa-check"></i><b>14.11.2</b> The Big Short</a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#ejercicios-25"><i class="fa fa-check"></i><b>14.12</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>15</b> Inferencia estadística</a><ul>
<li class="chapter" data-level="15.1" data-path="inference.html"><a href="inference.html#encuestas"><i class="fa fa-check"></i><b>15.1</b> Encuestas</a><ul>
<li class="chapter" data-level="15.1.1" data-path="inference.html"><a href="inference.html#el-modelo-de-muestreo-para-encuestas"><i class="fa fa-check"></i><b>15.1.1</b> El modelo de muestreo para encuestas</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="inference.html"><a href="inference.html#poblaciones-muestras-parámetros-y-estimaciones"><i class="fa fa-check"></i><b>15.2</b> Poblaciones, muestras, parámetros y estimaciones</a><ul>
<li class="chapter" data-level="15.2.1" data-path="inference.html"><a href="inference.html#el-promedio-de-la-muestra"><i class="fa fa-check"></i><b>15.2.1</b> El promedio de la muestra</a></li>
<li class="chapter" data-level="15.2.2" data-path="inference.html"><a href="inference.html#parámetros"><i class="fa fa-check"></i><b>15.2.2</b> Parámetros</a></li>
<li class="chapter" data-level="15.2.3" data-path="inference.html"><a href="inference.html#encuesta-versus-pronóstico"><i class="fa fa-check"></i><b>15.2.3</b> Encuesta versus pronóstico</a></li>
<li class="chapter" data-level="15.2.4" data-path="inference.html"><a href="inference.html#propiedades-de-nuestra-estimación-valor-esperado-y-error-estándar"><i class="fa fa-check"></i><b>15.2.4</b> Propiedades de nuestra estimación: valor esperado y error estándar</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="inference.html"><a href="inference.html#ejercicios-26"><i class="fa fa-check"></i><b>15.3</b> Ejercicios</a></li>
<li class="chapter" data-level="15.4" data-path="inference.html"><a href="inference.html#clt"><i class="fa fa-check"></i><b>15.4</b> Teorema del límite central en la práctica</a><ul>
<li class="chapter" data-level="15.4.1" data-path="inference.html"><a href="inference.html#una-simulación-monte-carlo"><i class="fa fa-check"></i><b>15.4.1</b> Una simulación Monte Carlo</a></li>
<li class="chapter" data-level="15.4.2" data-path="inference.html"><a href="inference.html#la-diferencia"><i class="fa fa-check"></i><b>15.4.2</b> La diferencia</a></li>
<li class="chapter" data-level="15.4.3" data-path="inference.html"><a href="inference.html#sesgo-por-qué-no-realizar-una-encuesta-bien-grande"><i class="fa fa-check"></i><b>15.4.3</b> Sesgo: ¿por qué no realizar una encuesta bien grande?</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="inference.html"><a href="inference.html#ejercicios-27"><i class="fa fa-check"></i><b>15.5</b> Ejercicios</a></li>
<li class="chapter" data-level="15.6" data-path="inference.html"><a href="inference.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>15.6</b> Intervalos de confianza</a><ul>
<li class="chapter" data-level="15.6.1" data-path="inference.html"><a href="inference.html#una-simulación-monte-carlo-1"><i class="fa fa-check"></i><b>15.6.1</b> Una simulación Monte Carlo</a></li>
<li class="chapter" data-level="15.6.2" data-path="inference.html"><a href="inference.html#el-idioma-correcto"><i class="fa fa-check"></i><b>15.6.2</b> El idioma correcto</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="inference.html"><a href="inference.html#ejercicios-28"><i class="fa fa-check"></i><b>15.7</b> Ejercicios</a></li>
<li class="chapter" data-level="15.8" data-path="inference.html"><a href="inference.html#poder"><i class="fa fa-check"></i><b>15.8</b> Poder</a></li>
<li class="chapter" data-level="15.9" data-path="inference.html"><a href="inference.html#valores-p"><i class="fa fa-check"></i><b>15.9</b> valores p</a></li>
<li class="chapter" data-level="15.10" data-path="inference.html"><a href="inference.html#association-tests"><i class="fa fa-check"></i><b>15.10</b> Pruebas de asociación</a><ul>
<li class="chapter" data-level="15.10.1" data-path="inference.html"><a href="inference.html#lady-tasting-tea"><i class="fa fa-check"></i><b>15.10.1</b> Lady Tasting Tea</a></li>
<li class="chapter" data-level="15.10.2" data-path="inference.html"><a href="inference.html#tablas-2x2"><i class="fa fa-check"></i><b>15.10.2</b> Tablas 2x2</a></li>
<li class="chapter" data-level="15.10.3" data-path="inference.html"><a href="inference.html#prueba-de-chi-cuadrado"><i class="fa fa-check"></i><b>15.10.3</b> Prueba de chi-cuadrado</a></li>
<li class="chapter" data-level="15.10.4" data-path="inference.html"><a href="inference.html#odds-ratio"><i class="fa fa-check"></i><b>15.10.4</b> Riesgo relativo</a></li>
<li class="chapter" data-level="15.10.5" data-path="inference.html"><a href="inference.html#intervalos-de-confianza-para-el-riesgo-relativo"><i class="fa fa-check"></i><b>15.10.5</b> Intervalos de confianza para el riesgo relativo</a></li>
<li class="chapter" data-level="15.10.6" data-path="inference.html"><a href="inference.html#corrección-de-recuento-pequeño"><i class="fa fa-check"></i><b>15.10.6</b> Corrección de recuento pequeño</a></li>
<li class="chapter" data-level="15.10.7" data-path="inference.html"><a href="inference.html#muestras-grandes-valores-p-pequeños"><i class="fa fa-check"></i><b>15.10.7</b> Muestras grandes, valores p pequeños</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="inference.html"><a href="inference.html#ejercicios-29"><i class="fa fa-check"></i><b>15.11</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>16</b> Modelos estadísticos</a><ul>
<li class="chapter" data-level="16.1" data-path="models.html"><a href="models.html#agregadores-de-encuestas"><i class="fa fa-check"></i><b>16.1</b> Agregadores de encuestas</a><ul>
<li class="chapter" data-level="16.1.1" data-path="models.html"><a href="models.html#datos-de-encuesta"><i class="fa fa-check"></i><b>16.1.1</b> Datos de encuesta</a></li>
<li class="chapter" data-level="16.1.2" data-path="models.html"><a href="models.html#sesgo-de-los-encuestadores"><i class="fa fa-check"></i><b>16.1.2</b> Sesgo de los encuestadores</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="models.html"><a href="models.html#data-driven-model"><i class="fa fa-check"></i><b>16.2</b> Modelos basados en datos</a></li>
<li class="chapter" data-level="16.3" data-path="models.html"><a href="models.html#ejercicios-30"><i class="fa fa-check"></i><b>16.3</b> Ejercicios</a></li>
<li class="chapter" data-level="16.4" data-path="models.html"><a href="models.html#bayesian-statistics"><i class="fa fa-check"></i><b>16.4</b> Estadísticas bayesianas</a><ul>
<li class="chapter" data-level="16.4.1" data-path="models.html"><a href="models.html#teorema-de-bayes"><i class="fa fa-check"></i><b>16.4.1</b> Teorema de Bayes</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="models.html"><a href="models.html#simulación-del-teorema-de-bayes"><i class="fa fa-check"></i><b>16.5</b> Simulación del teorema de Bayes</a><ul>
<li class="chapter" data-level="16.5.1" data-path="models.html"><a href="models.html#bayes-en-la-práctica"><i class="fa fa-check"></i><b>16.5.1</b> Bayes en la práctica</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="models.html"><a href="models.html#modelos-jerárquicos"><i class="fa fa-check"></i><b>16.6</b> Modelos jerárquicos</a></li>
<li class="chapter" data-level="16.7" data-path="models.html"><a href="models.html#ejercicios-31"><i class="fa fa-check"></i><b>16.7</b> Ejercicios</a></li>
<li class="chapter" data-level="16.8" data-path="models.html"><a href="models.html#election-forecasting"><i class="fa fa-check"></i><b>16.8</b> Estudio de caso: pronóstico de elecciones</a><ul>
<li class="chapter" data-level="16.8.1" data-path="models.html"><a href="models.html#bayesian-approach"><i class="fa fa-check"></i><b>16.8.1</b> Enfoque bayesiano</a></li>
<li class="chapter" data-level="16.8.2" data-path="models.html"><a href="models.html#el-sesgo-general"><i class="fa fa-check"></i><b>16.8.2</b> El sesgo general</a></li>
<li class="chapter" data-level="16.8.3" data-path="models.html"><a href="models.html#representaciones-matemáticas-de-modelos"><i class="fa fa-check"></i><b>16.8.3</b> Representaciones matemáticas de modelos</a></li>
<li class="chapter" data-level="16.8.4" data-path="models.html"><a href="models.html#prediciendo-el-colegio-electoral"><i class="fa fa-check"></i><b>16.8.4</b> Prediciendo el colegio electoral</a></li>
<li class="chapter" data-level="16.8.5" data-path="models.html"><a href="models.html#pronósticos"><i class="fa fa-check"></i><b>16.8.5</b> Pronósticos</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="models.html"><a href="models.html#ejercicios-32"><i class="fa fa-check"></i><b>16.9</b> Ejercicios</a></li>
<li class="chapter" data-level="16.10" data-path="models.html"><a href="models.html#t-dist"><i class="fa fa-check"></i><b>16.10</b> La distribución t</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>17</b> Regresión</a><ul>
<li class="chapter" data-level="17.1" data-path="regression.html"><a href="regression.html#estudio-de-caso-la-altura-es-hereditaria"><i class="fa fa-check"></i><b>17.1</b> Estudio de caso: ¿la altura es hereditaria?</a></li>
<li class="chapter" data-level="17.2" data-path="regression.html"><a href="regression.html#corr-coef"><i class="fa fa-check"></i><b>17.2</b> El coeficiente de correlación</a><ul>
<li class="chapter" data-level="17.2.1" data-path="regression.html"><a href="regression.html#la-correlación-de-muestra-es-una-variable-aleatoria"><i class="fa fa-check"></i><b>17.2.1</b> La correlación de muestra es una variable aleatoria</a></li>
<li class="chapter" data-level="17.2.2" data-path="regression.html"><a href="regression.html#la-correlación-no-siempre-es-un-resumen-útil"><i class="fa fa-check"></i><b>17.2.2</b> La correlación no siempre es un resumen útil</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="regression.html"><a href="regression.html#conditional-expectation"><i class="fa fa-check"></i><b>17.3</b> Valor esperado condicional</a></li>
<li class="chapter" data-level="17.4" data-path="regression.html"><a href="regression.html#la-línea-de-regresión"><i class="fa fa-check"></i><b>17.4</b> La línea de regresión</a><ul>
<li class="chapter" data-level="17.4.1" data-path="regression.html"><a href="regression.html#regresión-mejora-precisión"><i class="fa fa-check"></i><b>17.4.1</b> Regresión mejora precisión</a></li>
<li class="chapter" data-level="17.4.2" data-path="regression.html"><a href="regression.html#distribución-normal-de-dos-variables-avanzada"><i class="fa fa-check"></i><b>17.4.2</b> Distribución normal de dos variables (avanzada)</a></li>
<li class="chapter" data-level="17.4.3" data-path="regression.html"><a href="regression.html#varianza-explicada"><i class="fa fa-check"></i><b>17.4.3</b> Varianza explicada</a></li>
<li class="chapter" data-level="17.4.4" data-path="regression.html"><a href="regression.html#advertencia-hay-dos-líneas-de-regresión"><i class="fa fa-check"></i><b>17.4.4</b> Advertencia: hay dos líneas de regresión</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="regression.html"><a href="regression.html#ejercicios-33"><i class="fa fa-check"></i><b>17.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modelos-lineales.html"><a href="modelos-lineales.html"><i class="fa fa-check"></i><b>18</b> Modelos lineales</a><ul>
<li class="chapter" data-level="18.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#estudio-de-caso-moneyball"><i class="fa fa-check"></i><b>18.1</b> Estudio de caso: Moneyball</a><ul>
<li class="chapter" data-level="18.1.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#sabermetrics"><i class="fa fa-check"></i><b>18.1.1</b> Sabermetrics</a></li>
<li class="chapter" data-level="18.1.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#conceptos-básicos-de-béisbol"><i class="fa fa-check"></i><b>18.1.2</b> Conceptos básicos de béisbol</a></li>
<li class="chapter" data-level="18.1.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#no-hay-premios-para-bb"><i class="fa fa-check"></i><b>18.1.3</b> No hay premios para BB</a></li>
<li class="chapter" data-level="18.1.4" data-path="modelos-lineales.html"><a href="modelos-lineales.html#base-por-bolas-o-bases-robadas"><i class="fa fa-check"></i><b>18.1.4</b> ¿Base por bolas o bases robadas?</a></li>
<li class="chapter" data-level="18.1.5" data-path="modelos-lineales.html"><a href="modelos-lineales.html#regresión-aplicada-a-las-estadísticas-de-béisbol"><i class="fa fa-check"></i><b>18.1.5</b> Regresión aplicada a las estadísticas de béisbol</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#confusión"><i class="fa fa-check"></i><b>18.2</b> Confusión</a><ul>
<li class="chapter" data-level="18.2.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#entender-confusión-a-través-de-estratificación"><i class="fa fa-check"></i><b>18.2.1</b> Entender confusión a través de estratificación</a></li>
<li class="chapter" data-level="18.2.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#regresión-lineal-múltiple"><i class="fa fa-check"></i><b>18.2.2</b> Regresión lineal múltiple</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#lse"><i class="fa fa-check"></i><b>18.3</b> Estimaciones de mínimos cuadrados</a><ul>
<li class="chapter" data-level="18.3.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#interpretando-modelos-lineales"><i class="fa fa-check"></i><b>18.3.1</b> Interpretando modelos lineales</a></li>
<li class="chapter" data-level="18.3.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#estimaciones-de-mínimos-cuadrados-lse"><i class="fa fa-check"></i><b>18.3.2</b> Estimaciones de mínimos cuadrados (LSE)</a></li>
<li class="chapter" data-level="18.3.3" data-path="modelos-lineales.html"><a href="modelos-lineales.html#la-función-lm"><i class="fa fa-check"></i><b>18.3.3</b> La función <code>lm</code></a></li>
<li class="chapter" data-level="18.3.4" data-path="modelos-lineales.html"><a href="modelos-lineales.html#lse-son-variables-aleatorias"><i class="fa fa-check"></i><b>18.3.4</b> LSE son variables aleatorias</a></li>
<li class="chapter" data-level="18.3.5" data-path="modelos-lineales.html"><a href="modelos-lineales.html#valores-pronosticados-son-variables-aleatorias"><i class="fa fa-check"></i><b>18.3.5</b> Valores pronosticados son variables aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ejercicios-34"><i class="fa fa-check"></i><b>18.4</b> Ejercicios</a></li>
<li class="chapter" data-level="18.5" data-path="modelos-lineales.html"><a href="modelos-lineales.html#regresión-lineal-en-el-tidyverse"><i class="fa fa-check"></i><b>18.5</b> Regresión lineal en el tidyverse</a><ul>
<li class="chapter" data-level="18.5.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#el-paquete-broom"><i class="fa fa-check"></i><b>18.5.1</b> El paquete broom</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ejercicios-35"><i class="fa fa-check"></i><b>18.6</b> Ejercicios</a></li>
<li class="chapter" data-level="18.7" data-path="modelos-lineales.html"><a href="modelos-lineales.html#estudio-de-caso-moneyball-continuación"><i class="fa fa-check"></i><b>18.7</b> Estudio de caso: Moneyball (continuación)</a><ul>
<li class="chapter" data-level="18.7.1" data-path="modelos-lineales.html"><a href="modelos-lineales.html#añadiendo-información-sobre-salario-y-posición"><i class="fa fa-check"></i><b>18.7.1</b> Añadiendo información sobre salario y posición</a></li>
<li class="chapter" data-level="18.7.2" data-path="modelos-lineales.html"><a href="modelos-lineales.html#escoger-nueve-jugadores"><i class="fa fa-check"></i><b>18.7.2</b> Escoger nueve jugadores</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="modelos-lineales.html"><a href="modelos-lineales.html#la-falacia-de-la-regresión"><i class="fa fa-check"></i><b>18.8</b> La falacia de la regresión</a></li>
<li class="chapter" data-level="18.9" data-path="modelos-lineales.html"><a href="modelos-lineales.html#modelos-de-error-de-medición"><i class="fa fa-check"></i><b>18.9</b> Modelos de error de medición</a></li>
<li class="chapter" data-level="18.10" data-path="modelos-lineales.html"><a href="modelos-lineales.html#ejercicios-36"><i class="fa fa-check"></i><b>18.10</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html"><i class="fa fa-check"></i><b>19</b> La asociación no implica causalidad</a><ul>
<li class="chapter" data-level="19.1" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#correlación-espuria"><i class="fa fa-check"></i><b>19.1</b> Correlación espuria</a></li>
<li class="chapter" data-level="19.2" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#valores-atípicos-1"><i class="fa fa-check"></i><b>19.2</b> Valores atípicos</a></li>
<li class="chapter" data-level="19.3" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#inversión-de-causa-y-efecto"><i class="fa fa-check"></i><b>19.3</b> Inversión de causa y efecto</a></li>
<li class="chapter" data-level="19.4" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#factores-de-confusión"><i class="fa fa-check"></i><b>19.4</b> Factores de confusión</a><ul>
<li class="chapter" data-level="19.4.1" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#ejemplo-admisiones-a-la-universidad-de-california-berkeley"><i class="fa fa-check"></i><b>19.4.1</b> Ejemplo: admisiones a la Universidad de California, Berkeley</a></li>
<li class="chapter" data-level="19.4.2" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#confusión-explicada-gráficamente"><i class="fa fa-check"></i><b>19.4.2</b> Confusión explicada gráficamente</a></li>
<li class="chapter" data-level="19.4.3" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#promedio-después-de-estratificar"><i class="fa fa-check"></i><b>19.4.3</b> Promedio después de estratificar</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#la-paradoja-de-simpson"><i class="fa fa-check"></i><b>19.5</b> La paradoja de Simpson</a></li>
<li class="chapter" data-level="19.6" data-path="la-asociación-no-implica-causalidad.html"><a href="la-asociación-no-implica-causalidad.html#ejercicios-37"><i class="fa fa-check"></i><b>19.6</b> Ejercicios</a></li>
</ul></li>
<li class="part"><span><b>IV Disposición de datos</b></span></li>
<li class="chapter" data-level="20" data-path="introducción-a-la-disputa-de-datos.html"><a href="introducción-a-la-disputa-de-datos.html"><i class="fa fa-check"></i><b>20</b> Introducción a la disputa de datos</a></li>
<li class="chapter" data-level="21" data-path="reformar-datos.html"><a href="reformar-datos.html"><i class="fa fa-check"></i><b>21</b> Reformar datos</a><ul>
<li class="chapter" data-level="21.1" data-path="reformar-datos.html"><a href="reformar-datos.html#gather"><i class="fa fa-check"></i><b>21.1</b> <code>gather</code></a></li>
<li class="chapter" data-level="21.2" data-path="reformar-datos.html"><a href="reformar-datos.html#spread"><i class="fa fa-check"></i><b>21.2</b> <code>spread</code></a></li>
<li class="chapter" data-level="21.3" data-path="reformar-datos.html"><a href="reformar-datos.html#separate"><i class="fa fa-check"></i><b>21.3</b> <code>separate</code></a></li>
<li class="chapter" data-level="21.4" data-path="reformar-datos.html"><a href="reformar-datos.html#unite"><i class="fa fa-check"></i><b>21.4</b> <code>unite</code></a></li>
<li class="chapter" data-level="21.5" data-path="reformar-datos.html"><a href="reformar-datos.html#ejercicios-38"><i class="fa fa-check"></i><b>21.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="unir-mesas.html"><a href="unir-mesas.html"><i class="fa fa-check"></i><b>22</b> Unir mesas</a><ul>
<li class="chapter" data-level="22.1" data-path="unir-mesas.html"><a href="unir-mesas.html#joins"><i class="fa fa-check"></i><b>22.1</b> Uniones</a><ul>
<li class="chapter" data-level="22.1.1" data-path="unir-mesas.html"><a href="unir-mesas.html#izquierda-unirse"><i class="fa fa-check"></i><b>22.1.1</b> Izquierda unirse</a></li>
<li class="chapter" data-level="22.1.2" data-path="unir-mesas.html"><a href="unir-mesas.html#únete-a-la-derecha"><i class="fa fa-check"></i><b>22.1.2</b> Únete a la derecha</a></li>
<li class="chapter" data-level="22.1.3" data-path="unir-mesas.html"><a href="unir-mesas.html#unir-internamente"><i class="fa fa-check"></i><b>22.1.3</b> Unir internamente</a></li>
<li class="chapter" data-level="22.1.4" data-path="unir-mesas.html"><a href="unir-mesas.html#unión-completa"><i class="fa fa-check"></i><b>22.1.4</b> Unión completa</a></li>
<li class="chapter" data-level="22.1.5" data-path="unir-mesas.html"><a href="unir-mesas.html#semi-unirse"><i class="fa fa-check"></i><b>22.1.5</b> Semi unirse</a></li>
<li class="chapter" data-level="22.1.6" data-path="unir-mesas.html"><a href="unir-mesas.html#anti-unirse"><i class="fa fa-check"></i><b>22.1.6</b> Anti unirse</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="unir-mesas.html"><a href="unir-mesas.html#unión"><i class="fa fa-check"></i><b>22.2</b> Unión</a><ul>
<li class="chapter" data-level="22.2.1" data-path="unir-mesas.html"><a href="unir-mesas.html#columnas-de-enlace"><i class="fa fa-check"></i><b>22.2.1</b> Columnas de enlace</a></li>
<li class="chapter" data-level="22.2.2" data-path="unir-mesas.html"><a href="unir-mesas.html#enlace-por-filas"><i class="fa fa-check"></i><b>22.2.2</b> Enlace por filas</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="unir-mesas.html"><a href="unir-mesas.html#establecer-operadores"><i class="fa fa-check"></i><b>22.3</b> Establecer operadores</a><ul>
<li class="chapter" data-level="22.3.1" data-path="unir-mesas.html"><a href="unir-mesas.html#intersecar"><i class="fa fa-check"></i><b>22.3.1</b> Intersecar</a></li>
<li class="chapter" data-level="22.3.2" data-path="unir-mesas.html"><a href="unir-mesas.html#unión-1"><i class="fa fa-check"></i><b>22.3.2</b> Unión</a></li>
<li class="chapter" data-level="22.3.3" data-path="unir-mesas.html"><a href="unir-mesas.html#setdiff"><i class="fa fa-check"></i><b>22.3.3</b> <code>setdiff</code></a></li>
<li class="chapter" data-level="22.3.4" data-path="unir-mesas.html"><a href="unir-mesas.html#setequal"><i class="fa fa-check"></i><b>22.3.4</b> <code>setequal</code></a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="unir-mesas.html"><a href="unir-mesas.html#ejercicios-39"><i class="fa fa-check"></i><b>22.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>23</b> Web scraping</a><ul>
<li class="chapter" data-level="23.1" data-path="web-scraping.html"><a href="web-scraping.html#html"><i class="fa fa-check"></i><b>23.1</b> HTML</a></li>
<li class="chapter" data-level="23.2" data-path="web-scraping.html"><a href="web-scraping.html#el-paquete-rvest"><i class="fa fa-check"></i><b>23.2</b> El paquete rvest</a></li>
<li class="chapter" data-level="23.3" data-path="web-scraping.html"><a href="web-scraping.html#css-selectors"><i class="fa fa-check"></i><b>23.3</b> Selectores CSS</a></li>
<li class="chapter" data-level="23.4" data-path="web-scraping.html"><a href="web-scraping.html#json"><i class="fa fa-check"></i><b>23.4</b> JSON</a></li>
<li class="chapter" data-level="23.5" data-path="web-scraping.html"><a href="web-scraping.html#ejercicios-40"><i class="fa fa-check"></i><b>23.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html"><i class="fa fa-check"></i><b>24</b> Procesamiento de cadenas</a><ul>
<li class="chapter" data-level="24.1" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#stringr"><i class="fa fa-check"></i><b>24.1</b> El paquete stringr</a></li>
<li class="chapter" data-level="24.2" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#estudio-de-caso-1-datos-de-asesinatos-en-ee.-uu."><i class="fa fa-check"></i><b>24.2</b> Estudio de caso 1: datos de asesinatos en EE. UU.</a></li>
<li class="chapter" data-level="24.3" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#estudio-de-caso-2-alturas-autoinformadas"><i class="fa fa-check"></i><b>24.3</b> Estudio de caso 2: alturas autoinformadas</a></li>
<li class="chapter" data-level="24.4" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#cómo-escape-al-definir-cadenas"><i class="fa fa-check"></i><b>24.4</b> Cómo <em>escape</em> al definir cadenas</a></li>
<li class="chapter" data-level="24.5" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#expresiones-regulares"><i class="fa fa-check"></i><b>24.5</b> Expresiones regulares</a><ul>
<li class="chapter" data-level="24.5.1" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#las-cadenas-son-una-expresión-regular"><i class="fa fa-check"></i><b>24.5.1</b> Las cadenas son una expresión regular</a></li>
<li class="chapter" data-level="24.5.2" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#caracteres-especiales"><i class="fa fa-check"></i><b>24.5.2</b> Caracteres especiales</a></li>
<li class="chapter" data-level="24.5.3" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#clases-de-personajes"><i class="fa fa-check"></i><b>24.5.3</b> Clases de personajes</a></li>
<li class="chapter" data-level="24.5.4" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#anclas"><i class="fa fa-check"></i><b>24.5.4</b> Anclas</a></li>
<li class="chapter" data-level="24.5.5" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#cuantificadores"><i class="fa fa-check"></i><b>24.5.5</b> Cuantificadores</a></li>
<li class="chapter" data-level="24.5.6" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#espacio-en-blanco-s"><i class="fa fa-check"></i><b>24.5.6</b> Espacio en blanco <code>\s</code></a></li>
<li class="chapter" data-level="24.5.7" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#cuantificadores-1"><i class="fa fa-check"></i><b>24.5.7</b> Cuantificadores: <code>*</code>, <code>?</code>, <code>+</code></a></li>
<li class="chapter" data-level="24.5.8" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#no"><i class="fa fa-check"></i><b>24.5.8</b> No</a></li>
<li class="chapter" data-level="24.5.9" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#groups"><i class="fa fa-check"></i><b>24.5.9</b> Grupos</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#buscar-y-reemplazar-con-expresiones-regulares"><i class="fa fa-check"></i><b>24.6</b> Buscar y reemplazar con expresiones regulares</a><ul>
<li class="chapter" data-level="24.6.1" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#buscar-y-reemplazar-usando-grupos"><i class="fa fa-check"></i><b>24.6.1</b> Buscar y reemplazar usando grupos</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#prueba-y-mejora"><i class="fa fa-check"></i><b>24.7</b> Prueba y mejora</a></li>
<li class="chapter" data-level="24.8" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#recorte"><i class="fa fa-check"></i><b>24.8</b> Recorte</a></li>
<li class="chapter" data-level="24.9" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#cambio-de-letra"><i class="fa fa-check"></i><b>24.9</b> Cambio de letra</a></li>
<li class="chapter" data-level="24.10" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#estudio-de-caso-2-alturas-autoinformadas-continuación"><i class="fa fa-check"></i><b>24.10</b> Estudio de caso 2: alturas autoinformadas (continuación)</a><ul>
<li class="chapter" data-level="24.10.1" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#los-extract-función"><i class="fa fa-check"></i><b>24.10.1</b> Los <code>extract</code> función</a></li>
<li class="chapter" data-level="24.10.2" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#poniendolo-todo-junto"><i class="fa fa-check"></i><b>24.10.2</b> Poniendolo todo junto</a></li>
</ul></li>
<li class="chapter" data-level="24.11" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#división-de-cadenas"><i class="fa fa-check"></i><b>24.11</b> División de cadenas</a></li>
<li class="chapter" data-level="24.12" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#estudio-de-caso-3-extracción-de-tablas-de-un-pdf"><i class="fa fa-check"></i><b>24.12</b> Estudio de caso 3: extracción de tablas de un PDF</a></li>
<li class="chapter" data-level="24.13" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#recode"><i class="fa fa-check"></i><b>24.13</b> Recodificación</a></li>
<li class="chapter" data-level="24.14" data-path="procesamiento-de-cadenas.html"><a href="procesamiento-de-cadenas.html#ejercicios-41"><i class="fa fa-check"></i><b>24.14</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="analizando-fechas-y-horas.html"><a href="analizando-fechas-y-horas.html"><i class="fa fa-check"></i><b>25</b> Analizando fechas y horas</a><ul>
<li class="chapter" data-level="25.1" data-path="analizando-fechas-y-horas.html"><a href="analizando-fechas-y-horas.html#el-tipo-de-datos-de-fecha"><i class="fa fa-check"></i><b>25.1</b> El tipo de datos de fecha</a></li>
<li class="chapter" data-level="25.2" data-path="analizando-fechas-y-horas.html"><a href="analizando-fechas-y-horas.html#lubridate"><i class="fa fa-check"></i><b>25.2</b> El paquete lubridate</a></li>
<li class="chapter" data-level="25.3" data-path="analizando-fechas-y-horas.html"><a href="analizando-fechas-y-horas.html#ejercicios-42"><i class="fa fa-check"></i><b>25.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="extracción-de-textos.html"><a href="extracción-de-textos.html"><i class="fa fa-check"></i><b>26</b> Extracción de textos</a><ul>
<li class="chapter" data-level="26.1" data-path="extracción-de-textos.html"><a href="extracción-de-textos.html#estudio-de-caso-tuits-de-trump"><i class="fa fa-check"></i><b>26.1</b> Estudio de caso: tuits de Trump</a></li>
<li class="chapter" data-level="26.2" data-path="extracción-de-textos.html"><a href="extracción-de-textos.html#texto-como-datos"><i class="fa fa-check"></i><b>26.2</b> Texto como datos</a></li>
<li class="chapter" data-level="26.3" data-path="extracción-de-textos.html"><a href="extracción-de-textos.html#análisis-de-los-sentimientos"><i class="fa fa-check"></i><b>26.3</b> Análisis de los sentimientos</a></li>
<li class="chapter" data-level="26.4" data-path="extracción-de-textos.html"><a href="extracción-de-textos.html#ejercicios-43"><i class="fa fa-check"></i><b>26.4</b> Ejercicios</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción a la Ciencia de Datos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="procesamiento-de-cadenas" class="section level1">
<h1><span class="header-section-number">Capítulo 24</span> Procesamiento de cadenas</h1>
<p>Uno de los desafíos de discusión de datos más comunes consiste en extraer datos numéricos contenidos en cadenas de caracteres y convertirlos en las representaciones numéricas requeridas para hacer gráficos, calcular resúmenes o ajustar modelos en R. También es común procesar texto no organizado en nombres de variables significativas o variables categóricas . Muchos de los desafíos de procesamiento de cadenas que enfrenta un científico de datos son únicos y a menudo inesperados. Por lo tanto, es bastante ambicioso escribir una sección completa sobre este tema. Aquí usamos una serie de estudios de casos que nos ayudan a demostrar cómo el procesamiento de cadenas es un paso necesario para muchos desafíos de disputas de datos. Específicamente, describimos el proceso de convertir los datos <em>raw</em> originales aún no mostrados de los que extrajimos <code>murders</code>, <code>heights</code> y <code>research_funding_rates</code> ejemplo en los marcos de datos que hemos estudiado en este libro.</p>
<p>Al repasar estos estudios de caso, cubriremos algunas de las tareas más comunes en el procesamiento de cadenas, incluyendo
extrayendo números de cadenas,
eliminar caracteres no deseados del texto,
encontrar y reemplazar personajes,
extracción de partes específicas de cuerdas,
convertir texto de forma libre a formatos más uniformes, y
dividir cadenas en múltiples valores.</p>
<p>Base R incluye funciones para realizar todas estas tareas. Sin embargo, no siguen una convención unificadora, lo que los hace un poco difíciles de memorizar y usar. El paquete <strong>stringr</strong> básicamente reempaqueta esta funcionalidad, pero utiliza un enfoque más consistente de nombrar funciones y ordenar sus argumentos. Por ejemplo, en <strong>stringr</strong>, todas las funciones de procesamiento de cadenas comienzan con <code>str_</code>. Esto significa que si escribe <code>str_</code> y presione la pestaña, R se completará automáticamente y mostrará todas las funciones disponibles. Como resultado, no necesariamente tenemos que memorizar todos los nombres de funciones. Otra ventaja es que en las funciones de este paquete, la cadena que se procesa es siempre el primer argumento, lo que significa que podemos usar la tubería más fácilmente. Por lo tanto, comenzaremos describiendo cómo usar las funciones en el paquete <strong>stringr</strong>.</p>
<p>La mayoría de los ejemplos provendrán del segundo estudio de caso que trata sobre las alturas autoinformadas por los estudiantes y la mayor parte del capítulo está dedicado al aprendizaje de expresiones regulares (expresiones regulares) y funciones en el paquete <strong>stringr</strong>.</p>
<div id="stringr" class="section level2">
<h2><span class="header-section-number">24.1</span> El paquete stringr</h2>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="procesamiento-de-cadenas.html#cb819-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb819-2"><a href="procesamiento-de-cadenas.html#cb819-2"></a><span class="kw">library</span>(stringr)</span></code></pre></div>
<p>En general, las tareas de procesamiento de cadenas se pueden dividir en <strong>detectar</strong>, <strong>ubicar</strong>, <strong>extraer</strong> o <strong>reemplazar</strong> patrones en cadenas. Veremos varios ejemplos. La siguiente tabla incluye las funciones disponibles en el paquete <strong>stringr</strong>. Los dividimos por tarea. También incluimos el equivalente R-base cuando esté disponible.</p>
<p>Todas estas funciones toman un vector de caracteres como primer argumento. Además, para cada función, las operaciones se vectorizan: la operación se aplica a cada cadena en el vector.</p>
<p>Finalmente, tenga en cuenta que en esta tabla mencionamos <em>groups</em>. Estos se explicarán en la Sección <a href="procesamiento-de-cadenas.html#groups">24.5.9</a>.</p>
<table>
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="50%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th>el</th>
<th>stringr</th>
<th>Tarea</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>str_detect</code> El</td>
<td>Detectar</td>
<td>¿Está el patrón en la cadena? El</td>
<td><code>grepl</code></td>
</tr>
<tr class="even">
<td><code>str_which</code> El</td>
<td>Detectar</td>
<td>Devuelve el índice de entradas que contienen el patrón. El</td>
<td><code>grep</code></td>
</tr>
<tr class="odd">
<td><code>str_subset</code> El</td>
<td>Detectar</td>
<td>Devuelve el subconjunto de cadenas que contienen el patrón. El</td>
<td><code>grep</code> con <code>value = TRUE</code></td>
</tr>
<tr class="even">
<td><code>str_locate</code> El</td>
<td>Localizar</td>
<td>Devuelve las posiciones de la primera aparición del patrón en una cadena. <code>regexpr</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>str_locate_all</code> El</td>
<td>Localizar</td>
<td>Devuelve la posición de todas las apariciones de patrón en una cadena. El</td>
<td><code>gregexpr</code></td>
</tr>
<tr class="even">
<td><code>str_view</code> El</td>
<td>Localizar</td>
<td>Muestra la primera parte de la cadena que coincide con el patrón. El</td>
<td>El</td>
</tr>
<tr class="odd">
<td><code>str_view_all</code> El</td>
<td>Localizar</td>
<td>Muéstrame todas las partes de la cadena que coinciden con el patrón. El</td>
<td></td>
</tr>
<tr class="even">
<td><code>str_extract</code> El</td>
<td>Extracto</td>
<td>Extraiga la primera parte de la cadena que coincida con el patrón. El</td>
<td>El</td>
</tr>
<tr class="odd">
<td><code>str_extract_all</code> El</td>
<td>Extracto</td>
<td>Extraiga todas las partes de la cadena que coincidan con el patrón. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_match</code> El</td>
<td>Extracto</td>
<td>Extraiga la primera parte de la cadena que coincida con los grupos y los patrones definidos por los grupos. El</td>
<td></td>
</tr>
<tr class="odd">
<td><code>str_match_all</code> El</td>
<td>Extracto</td>
<td>Extraiga todas las partes de la cadena que coincidan con los grupos y los patrones definidos por los grupos. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_sub</code> El</td>
<td>Extracto</td>
<td>Extraer una subcadena. El</td>
<td><code>substring</code></td>
</tr>
<tr class="odd">
<td><code>str_split</code> El</td>
<td>Extracto</td>
<td>Dividir una cadena en una lista con partes separadas por patrón. El</td>
<td><code>strsplit</code></td>
</tr>
<tr class="even">
<td><code>str_split_fixed</code> El</td>
<td>Extracto</td>
<td>Dividir una cadena en una matriz con partes separadas por patrón. El</td>
<td><code>strsplit</code> con <code>fixed = TRUE</code></td>
</tr>
<tr class="odd">
<td><code>str_count</code> El</td>
<td>Describa</td>
<td>Cuente el número de veces que aparece un patrón en una cadena. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_length</code> El</td>
<td>Describa</td>
<td>Número de caracteres en la cadena. El</td>
<td><code>nchar</code></td>
</tr>
<tr class="odd">
<td><code>str_replace</code> El</td>
<td>Reemplazar</td>
<td>Reemplace la primera parte de una cadena que coincida con un patrón con otro. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_replace_all</code> El</td>
<td>Reemplazar</td>
<td>Reemplace todas las partes de una cadena que coincida con un patrón con otro. El</td>
<td><code>gsub</code></td>
</tr>
<tr class="odd">
<td><code>str_to_upper</code> El</td>
<td>Reemplazar</td>
<td>Cambia todos los caracteres a mayúsculas. El</td>
<td><code>toupper</code></td>
</tr>
<tr class="even">
<td><code>str_to_lower</code> El</td>
<td>Reemplazar</td>
<td>Cambia todos los caracteres a minúsculas. El</td>
<td><code>tolower</code></td>
</tr>
<tr class="odd">
<td><code>str_to_title</code> El</td>
<td>Reemplazar</td>
<td>Cambie el primer carácter a superior y descanse a inferior. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_replace_na</code> El</td>
<td>Reemplazar</td>
<td>Reemplaza todo <code>NA</code> s a un nuevo valor. El</td>
<td>El</td>
</tr>
<tr class="odd">
<td><code>str_trim</code> El</td>
<td>Reemplazar</td>
<td>Elimine el espacio en blanco desde el inicio y el final de la cadena. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_c</code> El</td>
<td>Manipular</td>
<td>Unir múltiples cadenas. El</td>
<td><code>paste0</code></td>
</tr>
<tr class="odd">
<td><code>str_conv</code> El</td>
<td>Manipular</td>
<td>Cambiar la codificación de la cadena. El</td>
<td></td>
</tr>
<tr class="even">
<td><code>str_sort</code> El</td>
<td>Manipular</td>
<td>Ordenar el vector en orden alfabético. <code>sort</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>str_order</code> El</td>
<td>Manipular</td>
<td>Índice necesario para ordenar el vector en orden alfabético. El</td>
<td><code>order</code></td>
</tr>
<tr class="even">
<td><code>str_trunc</code> El</td>
<td>Manipular</td>
<td>Truncar una cadena a un tamaño fijo. El</td>
<td>El</td>
</tr>
<tr class="odd">
<td><code>str_pad</code> El</td>
<td>Manipular</td>
<td>Agregue espacio en blanco a la cadena para que tenga un tamaño fijo. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_dup</code> El</td>
<td>Manipular</td>
<td>Repite una cuerda. El</td>
<td><code>rep</code> luego <code>paste</code></td>
</tr>
<tr class="odd">
<td><code>str_wrap</code> El</td>
<td>Manipular</td>
<td>Envuelva cosas en párrafos formateados. El</td>
<td>El</td>
</tr>
<tr class="even">
<td><code>str_interp</code> El</td>
<td>Manipular</td>
<td>Interpolación de cuerdas. El</td>
<td><code>sprintf</code></td>
</tr>
</tbody>
</table>
</div>
<div id="estudio-de-caso-1-datos-de-asesinatos-en-ee.-uu." class="section level2">
<h2><span class="header-section-number">24.2</span> Estudio de caso 1: datos de asesinatos en EE. UU.</h2>
<p>En esta sección presentamos algunos de los desafíos de procesamiento de cadenas más simples con los siguientes conjuntos de datos como ejemplo:</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="procesamiento-de-cadenas.html#cb820-1"></a><span class="kw">library</span>(rvest)</span>
<span id="cb820-2"><a href="procesamiento-de-cadenas.html#cb820-2"></a>url &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://en.wikipedia.org/w/index.php?title=&quot;</span>,</span>
<span id="cb820-3"><a href="procesamiento-de-cadenas.html#cb820-3"></a><span class="st">&quot;Gun_violence_in_the_United_States_by_state&quot;</span>,</span>
<span id="cb820-4"><a href="procesamiento-de-cadenas.html#cb820-4"></a><span class="st">&quot;&amp;direction=prev&amp;oldid=810166167&quot;</span>)</span>
<span id="cb820-5"><a href="procesamiento-de-cadenas.html#cb820-5"></a>murders_raw &lt;-<span class="st"> </span><span class="kw">read_html</span>(url) <span class="op">%&gt;%</span></span>
<span id="cb820-6"><a href="procesamiento-de-cadenas.html#cb820-6"></a><span class="kw">html_node</span>(<span class="st">&quot;table&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb820-7"><a href="procesamiento-de-cadenas.html#cb820-7"></a><span class="kw">html_table</span>() <span class="op">%&gt;%</span></span>
<span id="cb820-8"><a href="procesamiento-de-cadenas.html#cb820-8"></a><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&quot;state&quot;</span>, <span class="st">&quot;population&quot;</span>, <span class="st">&quot;total&quot;</span>, <span class="st">&quot;murder_rate&quot;</span>))</span></code></pre></div>
<p>El código anterior muestra el primer paso para construir el conjunto de datos</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="procesamiento-de-cadenas.html#cb821-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb821-2"><a href="procesamiento-de-cadenas.html#cb821-2"></a><span class="kw">data</span>(murders)</span></code></pre></div>
<p>de los datos en bruto, que se extrajo de una página de Wikipedia.</p>
<p>En general, el procesamiento de cadenas implica una cadena y un patrón. En R, generalmente almacenamos cadenas en un vector de caracteres como <code>murders$population</code>. Las primeras tres cadenas en este vector definidas por la variable de población son:</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="procesamiento-de-cadenas.html#cb822-1"></a>murders_raw<span class="op">$</span>population[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb822-2"><a href="procesamiento-de-cadenas.html#cb822-2"></a><span class="co">#&gt; [1] &quot;4,853,875&quot; &quot;737,709&quot;   &quot;6,817,565&quot;</span></span></code></pre></div>
<p>La coerción habitual no funciona aquí:</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="procesamiento-de-cadenas.html#cb823-1"></a><span class="kw">as.numeric</span>(murders_raw<span class="op">$</span>population[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb823-2"><a href="procesamiento-de-cadenas.html#cb823-2"></a><span class="co">#&gt; Warning: NAs introducidos por coerción</span></span>
<span id="cb823-3"><a href="procesamiento-de-cadenas.html#cb823-3"></a><span class="co">#&gt; [1] NA NA NA</span></span></code></pre></div>
<p>Esto se debe a las comas <code>,</code>. El procesamiento de cadenas que queremos hacer aquí es eliminar el <strong>patrón</strong>, <code>,</code>, de las <strong>cadenas</strong> en <code>murders_raw$population</code> y luego coaccionar a los números.
Podemos usar el <code>str_detect</code> funciona para ver que dos de las tres columnas tienen comas en las entradas:</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="procesamiento-de-cadenas.html#cb824-1"></a>commas &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">any</span>(<span class="kw">str_detect</span>(x, <span class="st">&quot;,&quot;</span>))</span>
<span id="cb824-2"><a href="procesamiento-de-cadenas.html#cb824-2"></a>murders_raw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize_all</span>(commas)</span>
<span id="cb824-3"><a href="procesamiento-de-cadenas.html#cb824-3"></a><span class="co">#&gt;   state population total murder_rate</span></span>
<span id="cb824-4"><a href="procesamiento-de-cadenas.html#cb824-4"></a><span class="co">#&gt; 1 FALSE       TRUE  TRUE       FALSE</span></span></code></pre></div>
<p>Entonces podemos usar el <code>str_replace_all</code> función para eliminarlos:</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="procesamiento-de-cadenas.html#cb825-1"></a>test_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(murders_raw<span class="op">$</span>population, <span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb825-2"><a href="procesamiento-de-cadenas.html#cb825-2"></a>test_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(test_<span class="dv">1</span>)</span></code></pre></div>
<p>Entonces podemos usar <code>mutate_all</code> para aplicar esta operación a cada columna, ya que no afectará a las columnas sin comas.</p>
<p>Resulta que esta operación es tan común que <code>readr</code> incluye la función <code>parse_number</code> específicamente destinado a eliminar caracteres no numéricos antes de la coacción:</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="procesamiento-de-cadenas.html#cb826-1"></a>test_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">parse_number</span>(murders_raw<span class="op">$</span>population)</span>
<span id="cb826-2"><a href="procesamiento-de-cadenas.html#cb826-2"></a><span class="kw">identical</span>(test_<span class="dv">1</span>, test_<span class="dv">2</span>)</span>
<span id="cb826-3"><a href="procesamiento-de-cadenas.html#cb826-3"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Entonces podemos obtener nuestra tabla deseada usando:</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="procesamiento-de-cadenas.html#cb827-1"></a>murders_new &lt;-<span class="st"> </span>murders_raw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_at</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, parse_number)</span>
<span id="cb827-2"><a href="procesamiento-de-cadenas.html#cb827-2"></a><span class="kw">head</span>(murders_new)</span>
<span id="cb827-3"><a href="procesamiento-de-cadenas.html#cb827-3"></a><span class="co">#&gt;        state population total murder_rate</span></span>
<span id="cb827-4"><a href="procesamiento-de-cadenas.html#cb827-4"></a><span class="co">#&gt; 1    Alabama    4853875   348         7.2</span></span>
<span id="cb827-5"><a href="procesamiento-de-cadenas.html#cb827-5"></a><span class="co">#&gt; 2     Alaska     737709    59         8.0</span></span>
<span id="cb827-6"><a href="procesamiento-de-cadenas.html#cb827-6"></a><span class="co">#&gt; 3    Arizona    6817565   309         4.5</span></span>
<span id="cb827-7"><a href="procesamiento-de-cadenas.html#cb827-7"></a><span class="co">#&gt; 4   Arkansas    2977853   181         6.1</span></span>
<span id="cb827-8"><a href="procesamiento-de-cadenas.html#cb827-8"></a><span class="co">#&gt; 5 California   38993940  1861         4.8</span></span>
<span id="cb827-9"><a href="procesamiento-de-cadenas.html#cb827-9"></a><span class="co">#&gt; 6   Colorado    5448819   176         3.2</span></span></code></pre></div>
<p>Este caso es relativamente simple en comparación con los desafíos de procesamiento de cadenas que normalmente enfrentamos en la ciencia de datos. El siguiente ejemplo es bastante complejo y ofrece varios desafíos que nos permitirán aprender muchas técnicas de procesamiento de cadenas.</p>
</div>
<div id="estudio-de-caso-2-alturas-autoinformadas" class="section level2">
<h2><span class="header-section-number">24.3</span> Estudio de caso 2: alturas autoinformadas</h2>
<p>El paquete <strong>dslabs</strong> incluye los datos sin procesar de los que se obtuvo el conjunto de datos de alturas. Puedes cargarlo así:</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="procesamiento-de-cadenas.html#cb828-1"></a><span class="kw">data</span>(reported_heights)</span></code></pre></div>
<p>Estas alturas se obtuvieron mediante un formulario web en el que se pedía a los estudiantes que ingresaran sus alturas. Podían ingresar cualquier cosa, pero las instrucciones pedían <em>altura en pulgadas</em>, un número. Recopilamos 1,095 presentaciones, pero desafortunadamente el vector de columna con las alturas reportadas tenía varias entradas no numéricas y como resultado se convirtió en un vector de caracteres:</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="procesamiento-de-cadenas.html#cb829-1"></a><span class="kw">class</span>(reported_heights<span class="op">$</span>height)</span>
<span id="cb829-2"><a href="procesamiento-de-cadenas.html#cb829-2"></a><span class="co">#&gt; [1] &quot;character&quot;</span></span></code></pre></div>
<p>Si intentamos analizarlo en números, recibimos una advertencia:</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="procesamiento-de-cadenas.html#cb830-1"></a>x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(reported_heights<span class="op">$</span>height)</span>
<span id="cb830-2"><a href="procesamiento-de-cadenas.html#cb830-2"></a><span class="co">#&gt; Warning: NAs introducidos por coerción</span></span></code></pre></div>
<p>Aunque la mayoría de los valores parecen ser la altura en pulgadas según lo solicitado:</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="procesamiento-de-cadenas.html#cb831-1"></a><span class="kw">head</span>(x)</span>
<span id="cb831-2"><a href="procesamiento-de-cadenas.html#cb831-2"></a><span class="co">#&gt; [1] 75 70 68 74 61 65</span></span></code></pre></div>
<p>terminamos con muchos <code>NA</code> s:</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="procesamiento-de-cadenas.html#cb832-1"></a><span class="kw">sum</span>(<span class="kw">is.na</span>(x))</span>
<span id="cb832-2"><a href="procesamiento-de-cadenas.html#cb832-2"></a><span class="co">#&gt; [1] 81</span></span></code></pre></div>
<p>Podemos ver algunas de las entradas que no se convierten con éxito utilizando <code>filter</code> para mantener solo las entradas que resultan en <code>NA</code> s:</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="procesamiento-de-cadenas.html#cb833-1"></a>reported_heights <span class="op">%&gt;%</span></span>
<span id="cb833-2"><a href="procesamiento-de-cadenas.html#cb833-2"></a><span class="kw">mutate</span>(<span class="dt">new_height =</span> <span class="kw">as.numeric</span>(height)) <span class="op">%&gt;%</span></span>
<span id="cb833-3"><a href="procesamiento-de-cadenas.html#cb833-3"></a><span class="kw">filter</span>(<span class="kw">is.na</span>(new_height)) <span class="op">%&gt;%</span></span>
<span id="cb833-4"><a href="procesamiento-de-cadenas.html#cb833-4"></a><span class="kw">head</span>(<span class="dt">n=</span><span class="dv">10</span>)</span>
<span id="cb833-5"><a href="procesamiento-de-cadenas.html#cb833-5"></a><span class="co">#&gt;             time_stamp    sex                 height new_height</span></span>
<span id="cb833-6"><a href="procesamiento-de-cadenas.html#cb833-6"></a><span class="co">#&gt; 1  2014-09-02 15:16:28   Male                  5&#39; 4&quot;         NA</span></span>
<span id="cb833-7"><a href="procesamiento-de-cadenas.html#cb833-7"></a><span class="co">#&gt; 2  2014-09-02 15:16:37 Female                  165cm         NA</span></span>
<span id="cb833-8"><a href="procesamiento-de-cadenas.html#cb833-8"></a><span class="co">#&gt; 3  2014-09-02 15:16:52   Male                    5&#39;7         NA</span></span>
<span id="cb833-9"><a href="procesamiento-de-cadenas.html#cb833-9"></a><span class="co">#&gt; 4  2014-09-02 15:16:56   Male                  &gt;9000         NA</span></span>
<span id="cb833-10"><a href="procesamiento-de-cadenas.html#cb833-10"></a><span class="co">#&gt; 5  2014-09-02 15:16:56   Male                   5&#39;7&quot;         NA</span></span>
<span id="cb833-11"><a href="procesamiento-de-cadenas.html#cb833-11"></a><span class="co">#&gt; 6  2014-09-02 15:17:09 Female                   5&#39;3&quot;         NA</span></span>
<span id="cb833-12"><a href="procesamiento-de-cadenas.html#cb833-12"></a><span class="co">#&gt; 7  2014-09-02 15:18:00   Male 5 feet and 8.11 inches         NA</span></span>
<span id="cb833-13"><a href="procesamiento-de-cadenas.html#cb833-13"></a><span class="co">#&gt; 8  2014-09-02 15:19:48   Male                   5&#39;11         NA</span></span>
<span id="cb833-14"><a href="procesamiento-de-cadenas.html#cb833-14"></a><span class="co">#&gt; 9  2014-09-04 00:46:45   Male                  5&#39;9&#39;&#39;         NA</span></span>
<span id="cb833-15"><a href="procesamiento-de-cadenas.html#cb833-15"></a><span class="co">#&gt; 10 2014-09-04 10:29:44   Male                 5&#39;10&#39;&#39;         NA</span></span></code></pre></div>
<p>Inmediatamente vemos lo que está sucediendo. Algunos de los estudiantes no informaron sus alturas en pulgadas según lo solicitado. Podríamos descartar estos datos y continuar. Sin embargo, muchas de las entradas siguen patrones que, en principio, podemos convertir fácilmente a pulgadas. Por ejemplo, en el resultado anterior, vemos varios casos que usan el formato <code>x'y''</code> con <code>x</code> y <code>y</code> representando pies y pulgadas, respectivamente. Cada uno de estos casos puede ser leído y convertido a pulgadas por un humano, por ejemplo <code>5'4''</code> es <code>5*12 + 4 = 64</code>. Entonces podríamos arreglar todas las entradas problemáticas <em>por mano</em>. Sin embargo, los humanos son propensos a cometer errores, por lo que es preferible un enfoque automatizado. Además, debido a que planeamos continuar recolectando datos, será conveniente escribir código que lo haga automáticamente.</p>
<p>Un primer paso en este tipo de tarea es examinar las entradas problemáticas e intentar definir patrones específicos seguidos de un gran grupo de entradas. Cuanto más grandes sean estos grupos, más entradas podremos arreglar con un solo enfoque programático. Queremos encontrar patrones que puedan describirse con precisión con una regla, como “un dígito, seguido de un símbolo de pie, seguido de uno o dos dígitos, seguido de un símbolo de pulgadas”.</p>
<p>Para buscar dichos patrones, es útil eliminar las entradas que son consistentes con estar en pulgadas y ver solo las entradas problemáticas. Por lo tanto, escribimos una función para hacer esto automáticamente. Mantenemos entradas que resultan en <code>NA</code> s al aplicar <code>as.numeric</code> o están fuera de un rango de alturas plausibles. Permitimos un rango que cubre aproximadamente el 99.9999% de la población adulta. También usamos <code>suppressWarnings</code> para evitar el mensaje de advertencia que conocemos <code>as.numeric</code> voluntad nos da.</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="procesamiento-de-cadenas.html#cb834-1"></a>not_inches &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">smallest =</span> <span class="dv">50</span>, <span class="dt">tallest =</span> <span class="dv">84</span>){</span>
<span id="cb834-2"><a href="procesamiento-de-cadenas.html#cb834-2"></a>inches &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">as.numeric</span>(x))</span>
<span id="cb834-3"><a href="procesamiento-de-cadenas.html#cb834-3"></a>ind &lt;-<span class="st"> </span><span class="kw">is.na</span>(inches) <span class="op">|</span><span class="st"> </span>inches <span class="op">&lt;</span><span class="st"> </span>smallest <span class="op">|</span><span class="st"> </span>inches <span class="op">&gt;</span><span class="st"> </span>tallest</span>
<span id="cb834-4"><a href="procesamiento-de-cadenas.html#cb834-4"></a>ind</span>
<span id="cb834-5"><a href="procesamiento-de-cadenas.html#cb834-5"></a>}</span></code></pre></div>
<p>Aplicamos esta función y encontramos el número de entradas problemáticas:</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="procesamiento-de-cadenas.html#cb835-1"></a>problems &lt;-<span class="st"> </span>reported_heights <span class="op">%&gt;%</span></span>
<span id="cb835-2"><a href="procesamiento-de-cadenas.html#cb835-2"></a><span class="kw">filter</span>(<span class="kw">not_inches</span>(height)) <span class="op">%&gt;%</span></span>
<span id="cb835-3"><a href="procesamiento-de-cadenas.html#cb835-3"></a><span class="kw">pull</span>(height)</span>
<span id="cb835-4"><a href="procesamiento-de-cadenas.html#cb835-4"></a><span class="kw">length</span>(problems)</span>
<span id="cb835-5"><a href="procesamiento-de-cadenas.html#cb835-5"></a><span class="co">#&gt; [1] 292</span></span></code></pre></div>
<p>Ahora podemos ver todos los casos simplemente imprimiéndolos. No hacemos eso aquí porque hay <code>length(problems)</code>, pero después de examinarlos cuidadosamente, vemos que se pueden usar tres patrones para definir tres grandes grupos dentro de estas excepciones.</p>
<p>1. Un patrón de la forma. <code>x'y</code> o <code>x' y''</code> o <code>x'y"</code> con <code>x</code> y <code>y</code> representando pies y pulgadas, respectivamente. Aquí hay diez ejemplos:</p>
<pre><code>#&gt; 5&#39; 4&quot; 5&#39;7 5&#39;7&quot; 5&#39;3&quot; 5&#39;11 5&#39;9&#39;&#39; 5&#39;10&#39;&#39; 5&#39; 10 5&#39;5&quot; 5&#39;2&quot;</code></pre>
<p>2. Un patrón de la forma. <code>x.y</code> o <code>x,y</code> con <code>x</code> pies y <code>y</code> pulgadas. Aquí hay diez ejemplos:</p>
<pre><code>#&gt; 5.3 5.5 6.5 5.8 5.6 5,3 5.9 6,8 5.5 6.2</code></pre>
<p>3. Entradas que se informaron en centímetros en lugar de pulgadas. Aquí hay diez ejemplos:</p>
<pre><code>#&gt; 150 175 177 178 163 175 178 165 165 180</code></pre>
<p>Una vez que vemos estos grandes grupos siguiendo patrones específicos, podemos desarrollar un plan de ataque. Recuerde que rara vez hay una sola forma de realizar estas tareas. Aquí elegimos uno que nos ayuda a enseñar varias técnicas útiles. Pero seguramente hay una forma más eficiente de realizar la tarea.</p>
<p><strong>Plan de ataque</strong>: convertiremos las entradas que se ajusten a los dos primeros patrones en uno estandarizado. Luego aprovecharemos la estandarización para extraer los pies y pulgadas y convertirlos a pulgadas. Luego definiremos un procedimiento para identificar entradas que están en centímetros y las convertiremos a pulgadas. Después de aplicar estos pasos, verificaremos nuevamente para ver qué entradas no se corrigieron y ver si podemos ajustar nuestro enfoque para que sea más completo.</p>
<p>Al final, esperamos tener un script que haga que los métodos de recolección de datos basados en la web sean robustos para los errores más comunes de los usuarios.</p>
<p>Para lograr nuestro objetivo, utilizaremos una técnica que nos permita detectar con precisión patrones y extraer las partes que queramos: expresiones regulares (expresiones regulares). Pero primero, describimos rápidamente cómo escapar de la función de ciertos caracteres para que puedan incluirse en cadenas.</p>
</div>
<div id="cómo-escape-al-definir-cadenas" class="section level2">
<h2><span class="header-section-number">24.4</span> Cómo <em>escape</em> al definir cadenas</h2>
<p>Para definir cadenas en R, podemos usar comillas dobles:</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="procesamiento-de-cadenas.html#cb839-1"></a>s &lt;-<span class="st"> &quot;Hello!&quot;</span></span></code></pre></div>
<p>o comillas simples:</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="procesamiento-de-cadenas.html#cb840-1"></a>s &lt;-<span class="st"> &#39;Hello!&#39;</span></span></code></pre></div>
<p>Asegúrese de elegir la comilla simple correcta, ya que usar la comilla invertida le dará un error:</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="procesamiento-de-cadenas.html#cb841-1"></a>s &lt;-<span class="st"> `</span><span class="dt">Hello</span><span class="st">`</span></span></code></pre></div>
<pre><code>Error: object &#39;Hello&#39; not found</code></pre>
<p>Ahora, ¿qué sucede si la cadena que queremos definir incluye comillas dobles? Por ejemplo, si queremos escribir 10 pulgadas así <code>10"</code>?
En este caso no puedes usar:</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="procesamiento-de-cadenas.html#cb843-1"></a>s &lt;-<span class="st"> &quot;10&quot;&quot;</span></span></code></pre></div>
<p>porque esto es solo la cadena <code>10</code> seguido de una cita doble. Si escribe esto en R, obtendrá un error porque tiene una comilla doble <em>descubierta</em>. Para evitar esto, podemos usar las comillas simples:</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="procesamiento-de-cadenas.html#cb844-1"></a>s &lt;-<span class="st"> &#39;10&quot;&#39;</span></span></code></pre></div>
<p>Si imprimimos <code>s</code> vemos que las comillas dobles están <em>escapeadas</em> con la barra invertida <code>\</code>.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="procesamiento-de-cadenas.html#cb845-1"></a>s</span>
<span id="cb845-2"><a href="procesamiento-de-cadenas.html#cb845-2"></a><span class="co">#&gt; [1] &quot;10\&quot;&quot;</span></span></code></pre></div>
<p>De hecho, escapar con la barra diagonal inversa proporciona una forma de definir la cadena mientras se siguen utilizando las comillas dobles para definir cadenas:</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="procesamiento-de-cadenas.html#cb846-1"></a>s &lt;-<span class="st"> &quot;10</span><span class="ch">\&quot;</span><span class="st">&quot;</span></span></code></pre></div>
<p>En R, la función <code>cat</code> veamos cómo se ve realmente la cadena:</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="procesamiento-de-cadenas.html#cb847-1"></a><span class="kw">cat</span>(s)</span>
<span id="cb847-2"><a href="procesamiento-de-cadenas.html#cb847-2"></a><span class="co">#&gt; 10&quot;</span></span></code></pre></div>
<p>Ahora, ¿qué pasa si queremos que nuestra cadena sea de 5 pies escrita así <code>5'</code>? En este caso, podemos usar las comillas dobles:</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="procesamiento-de-cadenas.html#cb848-1"></a>s &lt;-<span class="st"> &quot;5&#39;&quot;</span></span>
<span id="cb848-2"><a href="procesamiento-de-cadenas.html#cb848-2"></a><span class="kw">cat</span>(s)</span>
<span id="cb848-3"><a href="procesamiento-de-cadenas.html#cb848-3"></a><span class="co">#&gt; 5&#39;</span></span></code></pre></div>
<p>Así que hemos aprendido a escribir 5 pies y 10 pulgadas por separado, pero ¿qué pasa si queremos escribirlos juntos para representar <em>5 pies y 10 pulgadas</em> así? <code>5'10"</code>? En este caso, ni las comillas simples ni las dobles funcionarán. Esta:</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="procesamiento-de-cadenas.html#cb849-1"></a>s &lt;-<span class="st"> &#39;5&#39;</span><span class="dv">10</span><span class="st">&quot;&#39;</span></span></code></pre></div>
<p>cierra la cadena después de 5 y esto:</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="procesamiento-de-cadenas.html#cb850-1"></a>s &lt;-<span class="st"> &quot;5&#39;10&quot;&quot;</span></span></code></pre></div>
<p>cierra la cadena después de 10. Tenga en cuenta que si escribimos uno de los fragmentos de código anteriores en R, se atascará esperando que cierre la cita abierta y tendrá que salir de la ejecución con el botón <em>esc</em>.</p>
<p>En esta situación, necesitamos escapar de la función de las comillas con la barra diagonal inversa <code>\</code>. Puedes escapar de cualquier personaje como este:</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="procesamiento-de-cadenas.html#cb851-1"></a>s &lt;-<span class="st"> &#39;5</span><span class="ch">\&#39;</span><span class="st">10&quot;&#39;</span></span>
<span id="cb851-2"><a href="procesamiento-de-cadenas.html#cb851-2"></a><span class="kw">cat</span>(s)</span>
<span id="cb851-3"><a href="procesamiento-de-cadenas.html#cb851-3"></a><span class="co">#&gt; 5&#39;10&quot;</span></span></code></pre></div>
<p>o así:</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="procesamiento-de-cadenas.html#cb852-1"></a>s &lt;-<span class="st"> &quot;5&#39;10</span><span class="ch">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb852-2"><a href="procesamiento-de-cadenas.html#cb852-2"></a><span class="kw">cat</span>(s)</span>
<span id="cb852-3"><a href="procesamiento-de-cadenas.html#cb852-3"></a><span class="co">#&gt; 5&#39;10&quot;</span></span></code></pre></div>
<p>Los caracteres de escape son algo que a menudo tenemos que usar al procesar cadenas.</p>
</div>
<div id="expresiones-regulares" class="section level2">
<h2><span class="header-section-number">24.5</span> Expresiones regulares</h2>
<p>Una expresión regular (regex) es una forma de describir patrones específicos de caracteres de texto. Se pueden usar para determinar si una cadena dada coincide con el patrón. Se ha definido un conjunto de reglas para hacer esto de manera eficiente y precisa, y aquí mostramos algunos ejemplos. Podemos aprender más sobre estas reglas leyendo tutoriales detallados<sup>[<a href="https://www.regular-expressions.info/tutorial.html" class="uri">https://www.regular-expressions.info/tutorial.html</a>]</sup>[<a href="http://r4ds.had.co.nz/strings.html#matching-" class="uri">http://r4ds.had.co.nz/strings.html#matching-</a> patrones-con-expresiones-regulares]. Esta hoja de trucos de RStudio<a href="#fn89" class="footnote-ref" id="fnref89"><sup>89</sup></a> también es muy útil.</p>
<p>Los patrones suministrados a las funciones <strong>stringr</strong> pueden ser una expresión regular en lugar de una cadena estándar. Aprenderemos cómo funciona esto a través de una serie de ejemplos.</p>
<p>A lo largo de esta sección, verá que creamos cadenas para probar nuestra expresión regular. Para hacer esto, definimos patrones que sabemos que deberían coincidir y también patrones que sabemos que no deberían coincidir. Los llamaremos <code>yes</code> y <code>no</code>, respectivamente. Esto nos permite verificar los dos tipos de errores: no coincidir e incorrectamente.</p>
<div id="las-cadenas-son-una-expresión-regular" class="section level3">
<h3><span class="header-section-number">24.5.1</span> Las cadenas son una expresión regular</h3>
<p>Técnicamente, cualquier cadena es una expresión regular, quizás el ejemplo más simple es un solo carácter. Entonces la coma <code>,</code> usado en el siguiente ejemplo de código es un ejemplo simple de búsqueda con expresiones regulares.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="procesamiento-de-cadenas.html#cb853-1"></a>pattern &lt;-<span class="st"> &quot;,&quot;</span></span>
<span id="cb853-2"><a href="procesamiento-de-cadenas.html#cb853-2"></a><span class="kw">str_detect</span>(murders_raw<span class="op">$</span>total, pattern)</span></code></pre></div>
<p>Suprimimos la salida que es un vector lógico que nos dice qué entradas tienen comas.</p>
<p>Arriba, notamos que una entrada incluía un <code>cm</code>. Este es también un ejemplo simple de una expresión regular. Podemos mostrar todas las entradas que usaron <code>cm</code> me gusta esto:</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="procesamiento-de-cadenas.html#cb854-1"></a><span class="kw">str_subset</span>(reported_heights<span class="op">$</span>height, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb854-2"><a href="procesamiento-de-cadenas.html#cb854-2"></a><span class="co">#&gt; [1] &quot;165cm&quot;  &quot;170 cm&quot;</span></span></code></pre></div>
</div>
<div id="caracteres-especiales" class="section level3">
<h3><span class="header-section-number">24.5.2</span> Caracteres especiales</h3>
<p>Ahora consideremos un ejemplo un poco más complicado. ¿Cuál de las siguientes cadenas contiene el patrón? <code>cm</code> o <code>inches</code>?</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="procesamiento-de-cadenas.html#cb855-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;180 cm&quot;</span>, <span class="st">&quot;70 inches&quot;</span>)</span>
<span id="cb855-2"><a href="procesamiento-de-cadenas.html#cb855-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;180&quot;</span>, <span class="st">&quot;70&#39;&#39;&quot;</span>)</span>
<span id="cb855-3"><a href="procesamiento-de-cadenas.html#cb855-3"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span></code></pre></div>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="procesamiento-de-cadenas.html#cb856-1"></a><span class="kw">str_detect</span>(s, <span class="st">&quot;cm&quot;</span>) <span class="op">|</span><span class="st"> </span><span class="kw">str_detect</span>(s, <span class="st">&quot;inches&quot;</span>)</span>
<span id="cb856-2"><a href="procesamiento-de-cadenas.html#cb856-2"></a><span class="co">#&gt; [1]  TRUE  TRUE FALSE FALSE</span></span></code></pre></div>
<p>Sin embargo, no necesitamos hacer esto. La característica principal que distingue la expresión regular <em>language</em> de cadenas simples es que podemos usar caracteres especiales. Estos son personajes con un significado. Comenzamos presentando <code>|</code> lo que significa <em>o</em>. Entonces, si queremos saber si <code>cm</code> o <code>inches</code> aparece en las cadenas, podemos usar la expresión regular <code>cm|inches</code>:</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="procesamiento-de-cadenas.html#cb857-1"></a><span class="kw">str_detect</span>(s, <span class="st">&quot;cm|inches&quot;</span>)</span>
<span id="cb857-2"><a href="procesamiento-de-cadenas.html#cb857-2"></a><span class="co">#&gt; [1]  TRUE  TRUE FALSE FALSE</span></span></code></pre></div>
<p>y obtener la respuesta correcta.</p>
<p>Otro carácter especial que será útil para identificar valores de pies y pulgadas es <code>\d</code> lo que significa cualquier dígito: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9. La barra invertida se utiliza para distinguirlo del carácter <code>d</code>. En R, tenemos que escapar de la barra invertida <code>\</code> así que en realidad tenemos que usar <code>\\d</code> para representar dígitos. Aquí hay un ejemplo:</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="procesamiento-de-cadenas.html#cb858-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;5&#39;10&quot;</span>, <span class="st">&quot;5 feet&quot;</span>, <span class="st">&quot;4&#39;11&quot;</span>)</span>
<span id="cb858-2"><a href="procesamiento-de-cadenas.html#cb858-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;.&quot;</span>, <span class="st">&quot;Five&quot;</span>, <span class="st">&quot;six&quot;</span>)</span>
<span id="cb858-3"><a href="procesamiento-de-cadenas.html#cb858-3"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb858-4"><a href="procesamiento-de-cadenas.html#cb858-4"></a>pattern &lt;-<span class="st"> &quot;</span><span class="ch">\\</span><span class="st">d&quot;</span></span>
<span id="cb858-5"><a href="procesamiento-de-cadenas.html#cb858-5"></a><span class="kw">str_detect</span>(s, pattern)</span>
<span id="cb858-6"><a href="procesamiento-de-cadenas.html#cb858-6"></a><span class="co">#&gt; [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Aprovechamos esta oportunidad para presentar el <code>str_view</code> función, que es útil para la solución de problemas, ya que nos muestra la primera coincidencia para cada cadena:</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="procesamiento-de-cadenas.html#cb859-1"></a><span class="kw">str_view</span>(s, pattern)</span></code></pre></div>
<p><img src="wrangling/img/str_view-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>y <code>str_view_all</code> nos muestra todos los partidos, entonces <code>3'2</code> tiene dos partidos y <code>5'10</code> tiene tres.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="procesamiento-de-cadenas.html#cb860-1"></a><span class="kw">str_view_all</span>(s, pattern)</span></code></pre></div>
<p><img src="wrangling/img/str_view-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Hay muchos otros personajes especiales. Aprenderemos algunos otros a continuación, pero puede ver la mayoría o todos ellos en la hoja de trucos<a href="#fn90" class="footnote-ref" id="fnref90"><sup>90</sup></a> mencionado anteriormente.</p>
</div>
<div id="clases-de-personajes" class="section level3">
<h3><span class="header-section-number">24.5.3</span> Clases de personajes</h3>
<p>Las clases de caracteres se utilizan para definir una serie de caracteres que pueden coincidir. Definimos clases de caracteres entre corchetes. <code>[]</code>. Entonces, por ejemplo, si queremos que el patrón coincida solo si tenemos un <code>5</code> o un <code>6</code>, usamos la expresión regular <code>[56]</code>:</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="procesamiento-de-cadenas.html#cb861-1"></a><span class="kw">str_view</span>(s, <span class="st">&quot;[56]&quot;</span>)</span></code></pre></div>
<p><img src="wrangling/img/str_view-3.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Supongamos que queremos unir valores entre 4 y 7. Una forma común de definir clases de caracteres es con rangos. Así por ejemplo, <code>[0-9]</code> es equivalente a <code>\\d</code>. El patrón que queremos es por lo tanto <code>[4-7]</code>.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="procesamiento-de-cadenas.html#cb862-1"></a>yes &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb862-2"><a href="procesamiento-de-cadenas.html#cb862-2"></a>no &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb862-3"><a href="procesamiento-de-cadenas.html#cb862-3"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb862-4"><a href="procesamiento-de-cadenas.html#cb862-4"></a><span class="kw">str_detect</span>(s, <span class="st">&quot;[4-7]&quot;</span>)</span>
<span id="cb862-5"><a href="procesamiento-de-cadenas.html#cb862-5"></a><span class="co">#&gt; [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Sin embargo, es importante saber que en regex todo es un personaje; No hay números. Entonces <code>4</code> es el personaje <code>4</code> no el número cuatro. Note, por ejemplo, que <code>[1-20]</code> <strong>no</strong> significa 1 a 20, significa los caracteres 1 a 2 o el carácter 0. Entonces <code>[1-20]</code> simplemente significa la clase de caracteres compuesta por 0, 1 y 2.</p>
<p>Tenga en cuenta que los caracteres tienen un orden y los dígitos siguen el orden numérico. Entonces <code>0</code> viene antes <code>1</code> que viene antes <code>2</code> y así. Por la misma razón, podemos definir letras minúsculas como <code>[a-z]</code>, letras mayúsculas como <code>[A-Z]</code> y <code>[a-zA-z]</code> como ambos.</p>
</div>
<div id="anclas" class="section level3">
<h3><span class="header-section-number">24.5.4</span> Anclas</h3>
<p>¿Qué pasa si queremos una coincidencia cuando tenemos exactamente 1 dígito? Esto será útil en nuestro estudio de caso, ya que los pies nunca tienen más de 1 dígito, por lo que una restricción nos ayudará. Una forma de hacer esto con regex es usando <em>anchors</em>, que nos permiten definir patrones que deben comenzar o terminar en un lugar específico. Los dos anclajes más comunes son
<code>^</code> y <code>$</code> which represent the beginning and end of a string, respectively. So the pattern <code>^\\d$</code>se lee como" inicio de la cadena seguido de un dígito seguido por el final de la cadena ".</p>
<p>Este patrón ahora solo detecta las cadenas con exactamente un dígito:</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="procesamiento-de-cadenas.html#cb863-1"></a>pattern &lt;-<span class="st"> &quot;^</span><span class="ch">\\</span><span class="st">d$&quot;</span></span>
<span id="cb863-2"><a href="procesamiento-de-cadenas.html#cb863-2"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;9&quot;</span>)</span>
<span id="cb863-3"><a href="procesamiento-de-cadenas.html#cb863-3"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;12&quot;</span>, <span class="st">&quot;123&quot;</span>, <span class="st">&quot; 1&quot;</span>, <span class="st">&quot;a4&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb863-4"><a href="procesamiento-de-cadenas.html#cb863-4"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb863-5"><a href="procesamiento-de-cadenas.html#cb863-5"></a><span class="kw">str_view_all</span>(s, pattern)</span></code></pre></div>
<p><img src="wrangling/img/str_view-4.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Los <code>1</code> no coincide porque no comienza con el dígito sino con un espacio, que en realidad no es fácil de ver.</p>
</div>
<div id="cuantificadores" class="section level3">
<h3><span class="header-section-number">24.5.5</span> Cuantificadores</h3>
<p>Para la parte de pulgadas, podemos tener uno o dos dígitos. Esto se puede especificar en regex con <em>quantifiers</em>. Esto se hace siguiendo el patrón con llaves que contienen la cantidad de veces que se puede repetir la entrada anterior. Usamos un ejemplo para ilustrar. El patrón para uno o dos dígitos es:</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="procesamiento-de-cadenas.html#cb864-1"></a>pattern &lt;-<span class="st"> &quot;^</span><span class="ch">\\</span><span class="st">d{1,2}$&quot;</span></span>
<span id="cb864-2"><a href="procesamiento-de-cadenas.html#cb864-2"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;9&quot;</span>, <span class="st">&quot;12&quot;</span>)</span>
<span id="cb864-3"><a href="procesamiento-de-cadenas.html#cb864-3"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;123&quot;</span>, <span class="st">&quot;a4&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb864-4"><a href="procesamiento-de-cadenas.html#cb864-4"></a><span class="kw">str_view</span>(<span class="kw">c</span>(yes, no), pattern)</span></code></pre></div>
<p><img src="wrangling/img/str_view-5.png" width="70%" style="display: block; margin: auto;" /></p>
<p>En este caso, <code>123</code> <strong>no</strong> coincide, pero <code>12</code> hace. Entonces, para buscar nuestro patrón de pies y pulgadas, podemos agregar los símbolos para pies <code>'</code> y pulgadas <code>"</code> después de los dígitos.</p>
<p>Con lo que hemos aprendido, ahora podemos construir un ejemplo para el patrón <code>x'y\"</code> con <code>x</code> pies y <code>y</code> pulgadas.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="procesamiento-de-cadenas.html#cb865-1"></a>pattern &lt;-<span class="st"> &quot;^[4-7]&#39;</span><span class="ch">\\</span><span class="st">d{1,2}</span><span class="ch">\&quot;</span><span class="st">$&quot;</span></span></code></pre></div>
<p>El patrón ahora se está volviendo complejo, pero puedes mirarlo cuidadosamente y desglosarlo:</p>
<ul>
<li><code>^</code> = inicio de la cadena</li>
<li><code>[4-7]</code> = un dígito, ya sea 4,5,6 o 7</li>
<li><code>'</code> = símbolo de pies</li>
<li><code>\\d{1,2}</code> = uno o dos dígitos</li>
<li><code>\"</code> = símbolo de pulgadas</li>
<li><code>$</code> = final de la cadena</li>
</ul>
<p>Probémoslo:</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="procesamiento-de-cadenas.html#cb866-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&#39;7</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;6&#39;2</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;5&#39;12</span><span class="ch">\&quot;</span><span class="st">&quot;</span>)</span>
<span id="cb866-2"><a href="procesamiento-de-cadenas.html#cb866-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;6,2</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;6.2</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,<span class="st">&quot;I am 5&#39;11</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;3&#39;2</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;64&quot;</span>)</span>
<span id="cb866-3"><a href="procesamiento-de-cadenas.html#cb866-3"></a><span class="kw">str_detect</span>(yes, pattern)</span>
<span id="cb866-4"><a href="procesamiento-de-cadenas.html#cb866-4"></a><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span id="cb866-5"><a href="procesamiento-de-cadenas.html#cb866-5"></a><span class="kw">str_detect</span>(no, pattern)</span>
<span id="cb866-6"><a href="procesamiento-de-cadenas.html#cb866-6"></a><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Por ahora, estamos permitiendo que las pulgadas sean 12 o más grandes. Agregaremos una restricción más tarde ya que la expresión regular para esto es un poco más compleja de lo que estamos listos para mostrar.</p>
</div>
<div id="espacio-en-blanco-s" class="section level3">
<h3><span class="header-section-number">24.5.6</span> Espacio en blanco <code>\s</code></h3>
<p>Otro problema que tenemos son los espacios. Por ejemplo, nuestro patrón no coincide <code>5' 4"</code> porque hay un espacio entre <code>'</code> y <code>4</code> que nuestro patrón no permite. Los espacios son caracteres y R no los ignora:</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="procesamiento-de-cadenas.html#cb867-1"></a><span class="kw">identical</span>(<span class="st">&quot;Hi&quot;</span>, <span class="st">&quot;Hi &quot;</span>)</span>
<span id="cb867-2"><a href="procesamiento-de-cadenas.html#cb867-2"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>En regex, <code>\s</code> representa el espacio en blanco Para encontrar patrones como <code>5' 4</code>, podemos cambiar nuestro patrón a:</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="procesamiento-de-cadenas.html#cb868-1"></a>pattern_<span class="dv">2</span> &lt;-<span class="st"> &quot;^[4-7]&#39;</span><span class="ch">\\</span><span class="st">s</span><span class="ch">\\</span><span class="st">d{1,2}</span><span class="ch">\&quot;</span><span class="st">$&quot;</span></span>
<span id="cb868-2"><a href="procesamiento-de-cadenas.html#cb868-2"></a><span class="kw">str_subset</span>(problems, pattern_<span class="dv">2</span>)</span>
<span id="cb868-3"><a href="procesamiento-de-cadenas.html#cb868-3"></a><span class="co">#&gt; [1] &quot;5&#39; 4\&quot;&quot;  &quot;5&#39; 11\&quot;&quot; &quot;5&#39; 7\&quot;&quot;</span></span></code></pre></div>
<p>Sin embargo, esto no coincidirá con los patrones sin espacio. Entonces, ¿necesitamos más de un patrón regex? Resulta que también podemos usar un cuantificador para esto.</p>
</div>
<div id="cuantificadores-1" class="section level3">
<h3><span class="header-section-number">24.5.7</span> Cuantificadores: <code>*</code>, <code>?</code>, <code>+</code></h3>
<p>Queremos que el patrón permita espacios pero no los requiera. Incluso si hay varios espacios, como en este ejemplo <code>5' 4</code>, todavía queremos que coincida. Hay un cuantificador para exactamente este propósito. En regex, el personaje <code>*</code> significa cero o más instancias del personaje anterior. Aquí hay un ejemplo:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="procesamiento-de-cadenas.html#cb869-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AB&quot;</span>, <span class="st">&quot;A1B&quot;</span>, <span class="st">&quot;A11B&quot;</span>, <span class="st">&quot;A111B&quot;</span>, <span class="st">&quot;A1111B&quot;</span>)</span>
<span id="cb869-2"><a href="procesamiento-de-cadenas.html#cb869-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A2B&quot;</span>, <span class="st">&quot;A21B&quot;</span>)</span>
<span id="cb869-3"><a href="procesamiento-de-cadenas.html#cb869-3"></a><span class="kw">str_detect</span>(yes, <span class="st">&quot;A1*B&quot;</span>)</span>
<span id="cb869-4"><a href="procesamiento-de-cadenas.html#cb869-4"></a><span class="co">#&gt; [1] TRUE TRUE TRUE TRUE TRUE</span></span>
<span id="cb869-5"><a href="procesamiento-de-cadenas.html#cb869-5"></a><span class="kw">str_detect</span>(no, <span class="st">&quot;A1*B&quot;</span>)</span>
<span id="cb869-6"><a href="procesamiento-de-cadenas.html#cb869-6"></a><span class="co">#&gt; [1] FALSE FALSE</span></span></code></pre></div>
<p>Lo anterior coincide con la primera cadena que tiene cero 1s y todas las cadenas con uno o más 1. Entonces podemos mejorar nuestro patrón agregando el <code>*</code> después del personaje espacial <code>\s</code>.</p>
<p>Hay otros dos cuantificadores similares. Para ninguno o una vez, podemos usar <code>?</code>, y para uno o más, podemos usar <code>+</code>. Puedes ver cómo difieren con este ejemplo:</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="procesamiento-de-cadenas.html#cb870-1"></a><span class="kw">data.frame</span>(<span class="dt">string =</span> <span class="kw">c</span>(<span class="st">&quot;AB&quot;</span>, <span class="st">&quot;A1B&quot;</span>, <span class="st">&quot;A11B&quot;</span>, <span class="st">&quot;A111B&quot;</span>, <span class="st">&quot;A1111B&quot;</span>),</span>
<span id="cb870-2"><a href="procesamiento-de-cadenas.html#cb870-2"></a><span class="dt">none_or_more =</span> <span class="kw">str_detect</span>(yes, <span class="st">&quot;A1*B&quot;</span>),</span>
<span id="cb870-3"><a href="procesamiento-de-cadenas.html#cb870-3"></a><span class="dt">nore_or_once =</span> <span class="kw">str_detect</span>(yes, <span class="st">&quot;A1?B&quot;</span>),</span>
<span id="cb870-4"><a href="procesamiento-de-cadenas.html#cb870-4"></a><span class="dt">once_or_more =</span> <span class="kw">str_detect</span>(yes, <span class="st">&quot;A1+B&quot;</span>))</span>
<span id="cb870-5"><a href="procesamiento-de-cadenas.html#cb870-5"></a><span class="co">#&gt;   string none_or_more nore_or_once once_or_more</span></span>
<span id="cb870-6"><a href="procesamiento-de-cadenas.html#cb870-6"></a><span class="co">#&gt; 1     AB         TRUE         TRUE        FALSE</span></span>
<span id="cb870-7"><a href="procesamiento-de-cadenas.html#cb870-7"></a><span class="co">#&gt; 2    A1B         TRUE         TRUE         TRUE</span></span>
<span id="cb870-8"><a href="procesamiento-de-cadenas.html#cb870-8"></a><span class="co">#&gt; 3   A11B         TRUE        FALSE         TRUE</span></span>
<span id="cb870-9"><a href="procesamiento-de-cadenas.html#cb870-9"></a><span class="co">#&gt; 4  A111B         TRUE        FALSE         TRUE</span></span>
<span id="cb870-10"><a href="procesamiento-de-cadenas.html#cb870-10"></a><span class="co">#&gt; 5 A1111B         TRUE        FALSE         TRUE</span></span></code></pre></div>
<p>Realmente usaremos los tres en nuestro ejemplo de alturas reportadas, pero los veremos en una sección posterior.</p>
</div>
<div id="no" class="section level3">
<h3><span class="header-section-number">24.5.8</span> No</h3>
<p>Para especificar patrones que <strong>no</strong> queremos detectar, podemos usar el <code>^</code> símbolo pero solo <strong>dentro</strong> corchetes. Recuerda que fuera del corchete <code>^</code> significa el inicio de la cadena. Entonces, por ejemplo, si queremos detectar dígitos precedidos por algo que no sea una letra, podemos hacer lo siguiente:</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="procesamiento-de-cadenas.html#cb871-1"></a>pattern &lt;-<span class="st"> &quot;[^a-zA-Z]</span><span class="ch">\\</span><span class="st">d&quot;</span></span>
<span id="cb871-2"><a href="procesamiento-de-cadenas.html#cb871-2"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;.3&quot;</span>, <span class="st">&quot;+2&quot;</span>, <span class="st">&quot;-0&quot;</span>,<span class="st">&quot;*4&quot;</span>)</span>
<span id="cb871-3"><a href="procesamiento-de-cadenas.html#cb871-3"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A3&quot;</span>, <span class="st">&quot;B2&quot;</span>, <span class="st">&quot;C0&quot;</span>, <span class="st">&quot;E4&quot;</span>)</span>
<span id="cb871-4"><a href="procesamiento-de-cadenas.html#cb871-4"></a><span class="kw">str_detect</span>(yes, pattern)</span>
<span id="cb871-5"><a href="procesamiento-de-cadenas.html#cb871-5"></a><span class="co">#&gt; [1] TRUE TRUE TRUE TRUE</span></span>
<span id="cb871-6"><a href="procesamiento-de-cadenas.html#cb871-6"></a><span class="kw">str_detect</span>(no, pattern)</span>
<span id="cb871-7"><a href="procesamiento-de-cadenas.html#cb871-7"></a><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Otra forma de generar un patrón que busca <em>todo, excepto</em> es usar la mayúscula del carácter especial. Por ejemplo <code>\\D</code> significa cualquier cosa que no sea un dígito, <code>\\S</code> significa cualquier cosa excepto un espacio, y así sucesivamente.</p>
</div>
<div id="groups" class="section level3">
<h3><span class="header-section-number">24.5.9</span> Grupos</h3>
<p>Los grupos son un aspecto poderoso de la expresión regular que permite la extracción de valores. Los grupos se definen usando paréntesis. No afectan la coincidencia de patrones per se. En cambio, permite que las herramientas identifiquen partes específicas del patrón para que podamos extraerlas.</p>
<p>Queremos cambiar las alturas escritas como <code>5.6</code> a <code>5'6</code>.</p>
<p>Para evitar cambiar patrones como <code>70.2</code>, requeriremos que el primer dígito esté entre 4 y 7 <code>[4-7]</code> y que el segundo sea ninguno o más dígitos <code>\\d*</code>.
Comencemos definiendo un patrón simple que coincida con esto:</p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="procesamiento-de-cadenas.html#cb872-1"></a>pattern_without_groups &lt;-<span class="st"> &quot;^[4-7],</span><span class="ch">\\</span><span class="st">d*$&quot;</span></span></code></pre></div>
<p>Queremos extraer los dígitos para poder formar la nueva versión usando un punto. Estos son nuestros dos grupos, por lo que los encapsulamos con paréntesis:</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="procesamiento-de-cadenas.html#cb873-1"></a>pattern_with_groups &lt;-<span class="st"> &quot;^([4-7]),(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span></span></code></pre></div>
<p>Encapsulamos la parte del patrón que coincide con las partes que queremos conservar para su uso posterior. Agregar grupos no afecta la detección, ya que solo indica que queremos guardar lo que capturan los grupos. Tenga en cuenta que ambos patrones devuelven el mismo resultado cuando se usa <code>str_detect</code>:</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="procesamiento-de-cadenas.html#cb874-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5,9&quot;</span>, <span class="st">&quot;5,11&quot;</span>, <span class="st">&quot;6,&quot;</span>, <span class="st">&quot;6,1&quot;</span>)</span>
<span id="cb874-2"><a href="procesamiento-de-cadenas.html#cb874-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&#39;9&quot;</span>, <span class="st">&quot;,&quot;</span>, <span class="st">&quot;2,8&quot;</span>, <span class="st">&quot;6.1.1&quot;</span>)</span>
<span id="cb874-3"><a href="procesamiento-de-cadenas.html#cb874-3"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb874-4"><a href="procesamiento-de-cadenas.html#cb874-4"></a><span class="kw">str_detect</span>(s, pattern_without_groups)</span>
<span id="cb874-5"><a href="procesamiento-de-cadenas.html#cb874-5"></a><span class="co">#&gt; [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></span>
<span id="cb874-6"><a href="procesamiento-de-cadenas.html#cb874-6"></a><span class="kw">str_detect</span>(s, pattern_with_groups)</span>
<span id="cb874-7"><a href="procesamiento-de-cadenas.html#cb874-7"></a><span class="co">#&gt; [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Una vez que definimos los grupos, podemos usar la función <code>str_match</code> para extraer los valores que definen estos grupos:</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="procesamiento-de-cadenas.html#cb875-1"></a><span class="kw">str_match</span>(s, pattern_with_groups)</span>
<span id="cb875-2"><a href="procesamiento-de-cadenas.html#cb875-2"></a><span class="co">#&gt;      [,1]   [,2] [,3]</span></span>
<span id="cb875-3"><a href="procesamiento-de-cadenas.html#cb875-3"></a><span class="co">#&gt; [1,] &quot;5,9&quot;  &quot;5&quot;  &quot;9&quot; </span></span>
<span id="cb875-4"><a href="procesamiento-de-cadenas.html#cb875-4"></a><span class="co">#&gt; [2,] &quot;5,11&quot; &quot;5&quot;  &quot;11&quot;</span></span>
<span id="cb875-5"><a href="procesamiento-de-cadenas.html#cb875-5"></a><span class="co">#&gt; [3,] &quot;6,&quot;   &quot;6&quot;  &quot;&quot;  </span></span>
<span id="cb875-6"><a href="procesamiento-de-cadenas.html#cb875-6"></a><span class="co">#&gt; [4,] &quot;6,1&quot;  &quot;6&quot;  &quot;1&quot; </span></span>
<span id="cb875-7"><a href="procesamiento-de-cadenas.html#cb875-7"></a><span class="co">#&gt; [5,] NA     NA   NA  </span></span>
<span id="cb875-8"><a href="procesamiento-de-cadenas.html#cb875-8"></a><span class="co">#&gt; [6,] NA     NA   NA  </span></span>
<span id="cb875-9"><a href="procesamiento-de-cadenas.html#cb875-9"></a><span class="co">#&gt; [7,] NA     NA   NA  </span></span>
<span id="cb875-10"><a href="procesamiento-de-cadenas.html#cb875-10"></a><span class="co">#&gt; [8,] NA     NA   NA</span></span></code></pre></div>
<p>Observe que las columnas segunda y tercera contienen pies y pulgadas, respectivamente. La primera columna es la parte de la cadena que coincide con el patrón. Si no se produjo ninguna coincidencia, vemos un <code>NA</code>.</p>
<p>Ahora podemos entender la diferencia entre las funciones. <code>str_extract</code> y <code>str_match</code>: <code>str_extract</code> extrae solo cadenas que coinciden con un patrón, no los valores definidos por grupos:</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="procesamiento-de-cadenas.html#cb876-1"></a><span class="kw">str_extract</span>(s, pattern_with_groups)</span>
<span id="cb876-2"><a href="procesamiento-de-cadenas.html#cb876-2"></a><span class="co">#&gt; [1] &quot;5,9&quot;  &quot;5,11&quot; &quot;6,&quot;   &quot;6,1&quot;  NA     NA     NA     NA</span></span></code></pre></div>
</div>
</div>
<div id="buscar-y-reemplazar-con-expresiones-regulares" class="section level2">
<h2><span class="header-section-number">24.6</span> Buscar y reemplazar con expresiones regulares</h2>
<p>Anteriormente definimos el objeto <code>problems</code> que contiene las cadenas que no parecen estar en pulgadas. Podemos ver que no muchas de nuestras cadenas problemáticas coinciden con el patrón:</p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="procesamiento-de-cadenas.html#cb877-1"></a>pattern &lt;-<span class="st"> &quot;^[4-7]&#39;</span><span class="ch">\\</span><span class="st">d{1,2}</span><span class="ch">\&quot;</span><span class="st">$&quot;</span></span>
<span id="cb877-2"><a href="procesamiento-de-cadenas.html#cb877-2"></a><span class="kw">sum</span>(<span class="kw">str_detect</span>(problems, pattern))</span>
<span id="cb877-3"><a href="procesamiento-de-cadenas.html#cb877-3"></a><span class="co">#&gt; [1] 14</span></span></code></pre></div>
<p>Para ver por qué esto es así, mostramos algunos ejemplos que exponen por qué no tenemos más coincidencias:</p>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="procesamiento-de-cadenas.html#cb878-1"></a>problems[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">15</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_view</span>(pattern)</span></code></pre></div>
<p><img src="wrangling/img/str_view-6.png" width="70%" style="display: block; margin: auto;" />
Un problema inicial que vemos de inmediato es que algunos estudiantes escribieron las palabras “pies” y “pulgadas”. Podemos ver las entradas que hicieron esto con el <code>str_subset</code> función:</p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="procesamiento-de-cadenas.html#cb879-1"></a><span class="kw">str_subset</span>(problems, <span class="st">&quot;inches&quot;</span>)</span>
<span id="cb879-2"><a href="procesamiento-de-cadenas.html#cb879-2"></a><span class="co">#&gt; [1] &quot;5 feet and 8.11 inches&quot; &quot;Five foot eight inches&quot;</span></span>
<span id="cb879-3"><a href="procesamiento-de-cadenas.html#cb879-3"></a><span class="co">#&gt; [3] &quot;5 feet 7inches&quot;         &quot;5ft 9 inches&quot;          </span></span>
<span id="cb879-4"><a href="procesamiento-de-cadenas.html#cb879-4"></a><span class="co">#&gt; [5] &quot;5 ft 9 inches&quot;          &quot;5 feet 6 inches&quot;</span></span></code></pre></div>
<p>También vemos que algunas entradas usan dos comillas simples <code>''</code> en lugar de una comilla doble <code>"</code>.</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="procesamiento-de-cadenas.html#cb880-1"></a><span class="kw">str_subset</span>(problems, <span class="st">&quot;&#39;&#39;&quot;</span>)</span>
<span id="cb880-2"><a href="procesamiento-de-cadenas.html#cb880-2"></a><span class="co">#&gt;  [1] &quot;5&#39;9&#39;&#39;&quot;   &quot;5&#39;10&#39;&#39;&quot;  &quot;5&#39;10&#39;&#39;&quot;  &quot;5&#39;3&#39;&#39;&quot;   &quot;5&#39;7&#39;&#39;&quot;   &quot;5&#39;6&#39;&#39;&quot;  </span></span>
<span id="cb880-3"><a href="procesamiento-de-cadenas.html#cb880-3"></a><span class="co">#&gt;  [7] &quot;5&#39;7.5&#39;&#39;&quot; &quot;5&#39;7.5&#39;&#39;&quot; &quot;5&#39;10&#39;&#39;&quot;  &quot;5&#39;11&#39;&#39;&quot;  &quot;5&#39;10&#39;&#39;&quot;  &quot;5&#39;5&#39;&#39;&quot;</span></span></code></pre></div>
<p>Para corregir esto, podemos reemplazar las diferentes formas de representar pulgadas y pies con un símbolo uniforme. Usaremos <code>'</code> para pies, mientras que para pulgadas simplemente no usaremos un símbolo ya que algunas entradas tenían la forma <code>x'y</code>. Ahora, si ya no usamos el símbolo de pulgadas, tenemos que cambiar nuestro patrón en consecuencia:</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="procesamiento-de-cadenas.html#cb881-1"></a>pattern &lt;-<span class="st"> &quot;^[4-7]&#39;</span><span class="ch">\\</span><span class="st">d{1,2}$&quot;</span></span></code></pre></div>
<p>Si hacemos este reemplazo antes de la coincidencia, obtendremos muchas más coincidencias:</p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="procesamiento-de-cadenas.html#cb882-1"></a>problems <span class="op">%&gt;%</span></span>
<span id="cb882-2"><a href="procesamiento-de-cadenas.html#cb882-2"></a><span class="kw">str_replace</span>(<span class="st">&quot;feet|ft|foot&quot;</span>, <span class="st">&quot;&#39;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace feet, ft, foot with &#39;</span></span>
<span id="cb882-3"><a href="procesamiento-de-cadenas.html#cb882-3"></a><span class="kw">str_replace</span>(<span class="st">&quot;inches|in|&#39;&#39;|</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># remove all inches symbols</span></span>
<span id="cb882-4"><a href="procesamiento-de-cadenas.html#cb882-4"></a><span class="kw">str_detect</span>(pattern) <span class="op">%&gt;%</span></span>
<span id="cb882-5"><a href="procesamiento-de-cadenas.html#cb882-5"></a><span class="kw">sum</span>()</span>
<span id="cb882-6"><a href="procesamiento-de-cadenas.html#cb882-6"></a><span class="co">#&gt; [1] 48</span></span></code></pre></div>
<p>Sin embargo, todavía tenemos muchos casos por recorrer.</p>
<p>Tenga en cuenta que en el código anterior, aprovechamos la coherencia <strong>stringr</strong> y usamos la tubería.</p>
<p>Por ahora, mejoramos nuestro patrón agregando <code>\\s*</code> delante y después del símbolo de los pies <code>'</code> para permitir espacio entre el símbolo de los pies y los números. Ahora hacemos coincidir algunas entradas más:</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="procesamiento-de-cadenas.html#cb883-1"></a>pattern &lt;-<span class="st"> &quot;^[4-7]</span><span class="ch">\\</span><span class="st">s*&#39;</span><span class="ch">\\</span><span class="st">s*</span><span class="ch">\\</span><span class="st">d{1,2}$&quot;</span></span>
<span id="cb883-2"><a href="procesamiento-de-cadenas.html#cb883-2"></a>problems <span class="op">%&gt;%</span></span>
<span id="cb883-3"><a href="procesamiento-de-cadenas.html#cb883-3"></a><span class="kw">str_replace</span>(<span class="st">&quot;feet|ft|foot&quot;</span>, <span class="st">&quot;&#39;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace feet, ft, foot with &#39;</span></span>
<span id="cb883-4"><a href="procesamiento-de-cadenas.html#cb883-4"></a><span class="kw">str_replace</span>(<span class="st">&quot;inches|in|&#39;&#39;|</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># remove all inches symbols</span></span>
<span id="cb883-5"><a href="procesamiento-de-cadenas.html#cb883-5"></a><span class="kw">str_detect</span>(pattern) <span class="op">%&gt;%</span></span>
<span id="cb883-6"><a href="procesamiento-de-cadenas.html#cb883-6"></a>sum</span>
<span id="cb883-7"><a href="procesamiento-de-cadenas.html#cb883-7"></a><span class="co">#&gt; [1] 53</span></span></code></pre></div>
<p>Podríamos sentir la tentación de evitar hacer esto eliminando todos los espacios con <code>str_replace_all</code>. Sin embargo, al hacer una operación de este tipo, debemos asegurarnos de que no tenga efectos no deseados. En nuestros ejemplos de alturas informadas, esto será un problema porque algunas entradas tienen la forma <code>x y</code> con espacio separando los pies de las pulgadas. Si eliminamos todos los espacios, giraremos incorrectamente <code>x y</code> dentro <code>xy</code> lo que implica que un <code>6 1</code> se convertiría <code>61</code> pulgadas en lugar de <code>73</code> pulgadas.</p>
<p>El segundo gran tipo de entradas problemáticas tenía la forma <code>x.y</code>, <code>x,y</code> y <code>x y</code>. Queremos cambiar todo esto a nuestro formato común <code>x'y</code>. Pero no podemos simplemente buscar y reemplazar porque cambiaríamos valores como <code>70.5</code> dentro <code>70'5</code>.
Por lo tanto, nuestra estrategia será buscar un patrón muy específico que nos asegure que se proporcionen pies y pulgadas y luego, para aquellos que coincidan, reemplazarlos adecuadamente.</p>
<div id="buscar-y-reemplazar-usando-grupos" class="section level3">
<h3><span class="header-section-number">24.6.1</span> Buscar y reemplazar usando grupos</h3>
<p>Otro aspecto poderoso de los grupos es que puede hacer referencia a los valores extraídos en una expresión regular cuando busca y reemplaza.</p>
<p>El carácter especial regex para el <code>i</code>-el grupo es <code>\\i</code>. Entonces <code>\\1</code> es el valor extraído del primer grupo, <code>\\2</code> el valor del segundo y así sucesivamente. Como un ejemplo simple, tenga en cuenta que el siguiente código reemplazará una coma con punto, pero solo si está entre dos dígitos:</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="procesamiento-de-cadenas.html#cb884-1"></a>pattern_with_groups &lt;-<span class="st"> &quot;^([4-7]),(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span></span>
<span id="cb884-2"><a href="procesamiento-de-cadenas.html#cb884-2"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5,9&quot;</span>, <span class="st">&quot;5,11&quot;</span>, <span class="st">&quot;6,&quot;</span>, <span class="st">&quot;6,1&quot;</span>)</span>
<span id="cb884-3"><a href="procesamiento-de-cadenas.html#cb884-3"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&#39;9&quot;</span>, <span class="st">&quot;,&quot;</span>, <span class="st">&quot;2,8&quot;</span>, <span class="st">&quot;6.1.1&quot;</span>)</span>
<span id="cb884-4"><a href="procesamiento-de-cadenas.html#cb884-4"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb884-5"><a href="procesamiento-de-cadenas.html#cb884-5"></a><span class="kw">str_replace</span>(s, pattern_with_groups, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;</span><span class="ch">\\</span><span class="st">2&quot;</span>)</span>
<span id="cb884-6"><a href="procesamiento-de-cadenas.html#cb884-6"></a><span class="co">#&gt; [1] &quot;5&#39;9&quot;   &quot;5&#39;11&quot;  &quot;6&#39;&quot;    &quot;6&#39;1&quot;   &quot;5&#39;9&quot;   &quot;,&quot;     &quot;2,8&quot;   &quot;6.1.1&quot;</span></span></code></pre></div>
<p>Podemos usar esto para convertir casos en nuestras alturas reportadas.</p>
<p>Ahora estamos listos para definir un patrón que nos ayude a convertir todos los <code>x.y</code>, <code>x,y</code> y <code>x y</code> a nuestro formato preferido. Necesitamos adaptarnos <code>pattern_with_groups</code> para ser un poco más flexible y capturar todos los casos.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="procesamiento-de-cadenas.html#cb885-1"></a>pattern_with_groups &lt;-<span class="st">&quot;^([4-7])</span><span class="ch">\\</span><span class="st">s*[,</span><span class="ch">\\</span><span class="st">.</span><span class="ch">\\</span><span class="st">s+]</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span></span></code></pre></div>
<p>Analicemos este:</p>
<ul>
<li><code>^</code> = inicio de la cadena</li>
<li><code>[4-7]</code> = un dígito, ya sea 4, 5, 6 o 7</li>
<li><code>\\s*</code> = ninguno o más espacios en blanco</li>
<li><code>[,\\.\\s+]</code> = el símbolo de pies es <code>,</code>, <code>.</code> o al menos un espacio</li>
<li><code>\\s*</code> = ninguno o más espacios en blanco</li>
<li><code>\\d*</code> = ninguno o más dígitos</li>
<li><code>$</code> = final de la cadena</li>
</ul>
<p>Podemos ver que parece estar funcionando:</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="procesamiento-de-cadenas.html#cb886-1"></a><span class="kw">str_subset</span>(problems, pattern_with_groups) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</span>
<span id="cb886-2"><a href="procesamiento-de-cadenas.html#cb886-2"></a><span class="co">#&gt; [1] &quot;5.3&quot;  &quot;5.25&quot; &quot;5.5&quot;  &quot;6.5&quot;  &quot;5.8&quot;  &quot;5.6&quot;</span></span></code></pre></div>
<p>y podrá realizar la búsqueda y reemplazar:</p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="procesamiento-de-cadenas.html#cb887-1"></a><span class="kw">str_subset</span>(problems, pattern_with_groups) <span class="op">%&gt;%</span></span>
<span id="cb887-2"><a href="procesamiento-de-cadenas.html#cb887-2"></a><span class="kw">str_replace</span>(pattern_with_groups, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;</span><span class="ch">\\</span><span class="st">2&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>head</span>
<span id="cb887-3"><a href="procesamiento-de-cadenas.html#cb887-3"></a><span class="co">#&gt; [1] &quot;5&#39;3&quot;  &quot;5&#39;25&quot; &quot;5&#39;5&quot;  &quot;6&#39;5&quot;  &quot;5&#39;8&quot;  &quot;5&#39;6&quot;</span></span></code></pre></div>
<p>Nuevamente, trataremos el desafío de pulgadas más grandes que doce más tarde.</p>
</div>
</div>
<div id="prueba-y-mejora" class="section level2">
<h2><span class="header-section-number">24.7</span> Prueba y mejora</h2>
<p>Desarrollar la expresión regular correcta en el primer intento a menudo es difícil. Prueba y error es un enfoque común para encontrar el patrón de expresiones regulares que satisfaga todas las condiciones deseadas. En las secciones anteriores, hemos desarrollado una potente técnica de procesamiento de cadenas que puede ayudarnos a detectar muchas de las entradas problemáticas. Aquí probaremos nuestro enfoque, buscaremos más problemas y modificaremos nuestro enfoque para posibles mejoras. Escribamos una función que capture todas las entradas que no se pueden convertir en números recordando que algunas están en centímetros (trataremos con ellas más adelante):</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="procesamiento-de-cadenas.html#cb888-1"></a>not_inches_or_cm &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">smallest =</span> <span class="dv">50</span>, <span class="dt">tallest =</span> <span class="dv">84</span>){</span>
<span id="cb888-2"><a href="procesamiento-de-cadenas.html#cb888-2"></a>inches &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">as.numeric</span>(x))</span>
<span id="cb888-3"><a href="procesamiento-de-cadenas.html#cb888-3"></a>ind &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(inches) <span class="op">&amp;</span></span>
<span id="cb888-4"><a href="procesamiento-de-cadenas.html#cb888-4"></a>((inches <span class="op">&gt;=</span><span class="st"> </span>smallest <span class="op">&amp;</span><span class="st"> </span>inches <span class="op">&lt;=</span><span class="st"> </span>tallest) <span class="op">|</span></span>
<span id="cb888-5"><a href="procesamiento-de-cadenas.html#cb888-5"></a>(inches<span class="op">/</span><span class="fl">2.54</span> <span class="op">&gt;=</span><span class="st"> </span>smallest <span class="op">&amp;</span><span class="st"> </span>inches<span class="op">/</span><span class="fl">2.54</span> <span class="op">&lt;=</span><span class="st"> </span>tallest))</span>
<span id="cb888-6"><a href="procesamiento-de-cadenas.html#cb888-6"></a><span class="op">!</span>ind</span>
<span id="cb888-7"><a href="procesamiento-de-cadenas.html#cb888-7"></a>}</span>
<span id="cb888-8"><a href="procesamiento-de-cadenas.html#cb888-8"></a></span>
<span id="cb888-9"><a href="procesamiento-de-cadenas.html#cb888-9"></a>problems &lt;-<span class="st"> </span>reported_heights <span class="op">%&gt;%</span></span>
<span id="cb888-10"><a href="procesamiento-de-cadenas.html#cb888-10"></a><span class="kw">filter</span>(<span class="kw">not_inches_or_cm</span>(height)) <span class="op">%&gt;%</span></span>
<span id="cb888-11"><a href="procesamiento-de-cadenas.html#cb888-11"></a><span class="kw">pull</span>(height)</span>
<span id="cb888-12"><a href="procesamiento-de-cadenas.html#cb888-12"></a><span class="kw">length</span>(problems)</span>
<span id="cb888-13"><a href="procesamiento-de-cadenas.html#cb888-13"></a><span class="co">#&gt; [1] 200</span></span></code></pre></div>
<p>Veamos qué proporción de estos se ajusta a nuestro patrón después de los pasos de procesamiento que desarrollamos anteriormente:</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="procesamiento-de-cadenas.html#cb889-1"></a>converted &lt;-<span class="st"> </span>problems <span class="op">%&gt;%</span></span>
<span id="cb889-2"><a href="procesamiento-de-cadenas.html#cb889-2"></a><span class="kw">str_replace</span>(<span class="st">&quot;feet|foot|ft&quot;</span>, <span class="st">&quot;&#39;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># convert feet symbols to &#39;</span></span>
<span id="cb889-3"><a href="procesamiento-de-cadenas.html#cb889-3"></a><span class="kw">str_replace</span>(<span class="st">&quot;inches|in|&#39;&#39;|</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># remove inches symbols</span></span>
<span id="cb889-4"><a href="procesamiento-de-cadenas.html#cb889-4"></a><span class="kw">str_replace</span>(<span class="st">&quot;^([4-7])</span><span class="ch">\\</span><span class="st">s*[,</span><span class="ch">\\</span><span class="st">.</span><span class="ch">\\</span><span class="st">s+]</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;</span><span class="ch">\\</span><span class="st">2&quot;</span>)<span class="co"># change format</span></span>
<span id="cb889-5"><a href="procesamiento-de-cadenas.html#cb889-5"></a></span>
<span id="cb889-6"><a href="procesamiento-de-cadenas.html#cb889-6"></a>pattern &lt;-<span class="st"> &quot;^[4-7]</span><span class="ch">\\</span><span class="st">s*&#39;</span><span class="ch">\\</span><span class="st">s*</span><span class="ch">\\</span><span class="st">d{1,2}$&quot;</span></span>
<span id="cb889-7"><a href="procesamiento-de-cadenas.html#cb889-7"></a>index &lt;-<span class="st"> </span><span class="kw">str_detect</span>(converted, pattern)</span>
<span id="cb889-8"><a href="procesamiento-de-cadenas.html#cb889-8"></a><span class="kw">mean</span>(index)</span>
<span id="cb889-9"><a href="procesamiento-de-cadenas.html#cb889-9"></a><span class="co">#&gt; [1] 0.615</span></span></code></pre></div>
<p>Observe cómo aprovechamos la tubería, una de las ventajas de usar <strong>stringr</strong>. Este último fragmento de código muestra que hemos coincidido con más de la mitad de las cadenas. Examinemos los casos restantes:</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="procesamiento-de-cadenas.html#cb890-1"></a>converted[<span class="op">!</span>index]</span>
<span id="cb890-2"><a href="procesamiento-de-cadenas.html#cb890-2"></a><span class="co">#&gt;  [1] &quot;6&quot;             &quot;165cm&quot;         &quot;511&quot;           &quot;6&quot;            </span></span>
<span id="cb890-3"><a href="procesamiento-de-cadenas.html#cb890-3"></a><span class="co">#&gt;  [5] &quot;2&quot;             &quot;&gt;9000&quot;         &quot;5 &#39; and 8.11 &quot; &quot;11111&quot;        </span></span>
<span id="cb890-4"><a href="procesamiento-de-cadenas.html#cb890-4"></a><span class="co">#&gt;  [9] &quot;6&quot;             &quot;103.2&quot;         &quot;19&quot;            &quot;5&quot;            </span></span>
<span id="cb890-5"><a href="procesamiento-de-cadenas.html#cb890-5"></a><span class="co">#&gt; [13] &quot;300&quot;           &quot;6&#39;&quot;            &quot;6&quot;             &quot;Five &#39; eight &quot;</span></span>
<span id="cb890-6"><a href="procesamiento-de-cadenas.html#cb890-6"></a><span class="co">#&gt; [17] &quot;7&quot;             &quot;214&quot;           &quot;6&quot;             &quot;0.7&quot;          </span></span>
<span id="cb890-7"><a href="procesamiento-de-cadenas.html#cb890-7"></a><span class="co">#&gt; [21] &quot;6&quot;             &quot;2&#39;33&quot;          &quot;612&quot;           &quot;1,70&quot;         </span></span>
<span id="cb890-8"><a href="procesamiento-de-cadenas.html#cb890-8"></a><span class="co">#&gt; [25] &quot;87&quot;            &quot;5&#39;7.5&quot;         &quot;5&#39;7.5&quot;         &quot;111&quot;          </span></span>
<span id="cb890-9"><a href="procesamiento-de-cadenas.html#cb890-9"></a><span class="co">#&gt; [29] &quot;5&#39; 7.78&quot;       &quot;12&quot;            &quot;6&quot;             &quot;yyy&quot;          </span></span>
<span id="cb890-10"><a href="procesamiento-de-cadenas.html#cb890-10"></a><span class="co">#&gt; [33] &quot;89&quot;            &quot;34&quot;            &quot;25&quot;            &quot;6&quot;            </span></span>
<span id="cb890-11"><a href="procesamiento-de-cadenas.html#cb890-11"></a><span class="co">#&gt; [37] &quot;6&quot;             &quot;22&quot;            &quot;684&quot;           &quot;6&quot;            </span></span>
<span id="cb890-12"><a href="procesamiento-de-cadenas.html#cb890-12"></a><span class="co">#&gt; [41] &quot;1&quot;             &quot;1&quot;             &quot;6*12&quot;          &quot;87&quot;           </span></span>
<span id="cb890-13"><a href="procesamiento-de-cadenas.html#cb890-13"></a><span class="co">#&gt; [45] &quot;6&quot;             &quot;1.6&quot;           &quot;120&quot;           &quot;120&quot;          </span></span>
<span id="cb890-14"><a href="procesamiento-de-cadenas.html#cb890-14"></a><span class="co">#&gt; [49] &quot;23&quot;            &quot;1.7&quot;           &quot;6&quot;             &quot;5&quot;            </span></span>
<span id="cb890-15"><a href="procesamiento-de-cadenas.html#cb890-15"></a><span class="co">#&gt; [53] &quot;69&quot;            &quot;5&#39; 9 &quot;         &quot;5 &#39; 9 &quot;        &quot;6&quot;            </span></span>
<span id="cb890-16"><a href="procesamiento-de-cadenas.html#cb890-16"></a><span class="co">#&gt; [57] &quot;6&quot;             &quot;86&quot;            &quot;708,661&quot;       &quot;5 &#39; 6 &quot;       </span></span>
<span id="cb890-17"><a href="procesamiento-de-cadenas.html#cb890-17"></a><span class="co">#&gt; [61] &quot;6&quot;             &quot;649,606&quot;       &quot;10000&quot;         &quot;1&quot;            </span></span>
<span id="cb890-18"><a href="procesamiento-de-cadenas.html#cb890-18"></a><span class="co">#&gt; [65] &quot;728,346&quot;       &quot;0&quot;             &quot;6&quot;             &quot;6&quot;            </span></span>
<span id="cb890-19"><a href="procesamiento-de-cadenas.html#cb890-19"></a><span class="co">#&gt; [69] &quot;6&quot;             &quot;100&quot;           &quot;88&quot;            &quot;6&quot;            </span></span>
<span id="cb890-20"><a href="procesamiento-de-cadenas.html#cb890-20"></a><span class="co">#&gt; [73] &quot;170 cm&quot;        &quot;7,283,465&quot;     &quot;5&quot;             &quot;5&quot;            </span></span>
<span id="cb890-21"><a href="procesamiento-de-cadenas.html#cb890-21"></a><span class="co">#&gt; [77] &quot;34&quot;</span></span></code></pre></div>
<p>Surgen cuatro patrones claros:</p>
<ol style="list-style-type: decimal">
<li>Muchos estudiantes que miden exactamente 5 o 6 pies no ingresaron ninguna pulgada, por ejemplo <code>6'</code>, y nuestro patrón requiere que se incluyan pulgadas.</li>
<li>Algunos estudiantes que miden exactamente 5 o 6 pies ingresaron solo ese número.</li>
<li>Algunas de las pulgadas se ingresaron con puntos decimales. Por ejemplo <code>5'7.5''</code>. Nuestro patrón solo busca dos dígitos.</li>
<li>Algunas entradas tienen espacios al final, por ejemplo <code>5 ' 9</code>.</li>
</ol>
<p>Aunque no es tan común, también vemos los siguientes problemas:</p>
<ol start="5" style="list-style-type: decimal">
<li>Algunas entradas están en metros y algunas usan decimales europeos: <code>1.6</code>, <code>1,70</code>.</li>
<li>Dos estudiantes añadieron <code>cm</code>.</li>
<li>Un estudiante deletreó los números: <code>Five foot eight inches</code>.</li>
</ol>
<p>No está necesariamente claro que valga la pena escribir código para manejar estos últimos tres casos, ya que pueden ser lo suficientemente raros. Sin embargo, algunos de ellos nos brindan la oportunidad de aprender algunas técnicas más de expresiones regulares, por lo que crearemos una solución.</p>
<p>Para el caso 1, si agregamos un <code>'0</code> después del primer dígito, por ejemplo, convertir todo <code>6</code> a <code>6'0</code>, entonces nuestro patrón previamente definido coincidirá. Esto se puede hacer usando grupos:</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="procesamiento-de-cadenas.html#cb891-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;5&quot;</span>)</span>
<span id="cb891-2"><a href="procesamiento-de-cadenas.html#cb891-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&#39;&quot;</span>, <span class="st">&quot;5&#39;&#39;&quot;</span>, <span class="st">&quot;5&#39;4&quot;</span>)</span>
<span id="cb891-3"><a href="procesamiento-de-cadenas.html#cb891-3"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb891-4"><a href="procesamiento-de-cadenas.html#cb891-4"></a><span class="kw">str_replace</span>(s, <span class="st">&quot;^([4-7])$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;0&quot;</span>)</span>
<span id="cb891-5"><a href="procesamiento-de-cadenas.html#cb891-5"></a><span class="co">#&gt; [1] &quot;5&#39;0&quot; &quot;6&#39;0&quot; &quot;5&#39;0&quot; &quot;5&#39;&quot;  &quot;5&#39;&#39;&quot; &quot;5&#39;4&quot;</span></span></code></pre></div>
<p>El patrón dice que tiene que comenzar ( <code>^</code>) con un dígito entre 4 y 7 y termina allí ( <code>$</code>) El paréntesis define el grupo que pasamos como <code>\\1</code> para generar la cadena de expresiones regulares de reemplazo.</p>
<p>Podemos adaptar este código ligeramente para manejar también el caso 2, que cubre la entrada <code>5'</code>. Nota <code>5'</code> se deja intacto. Esto es porque el extra <code>'</code> hace que el patrón no coincida ya que tenemos que terminar con un 5 o 6. Queremos permitir que el 5 o 6 sea seguido por un signo de 0 o 1 pie. Entonces podemos simplemente agregar <code>'{0,1}</code> después de la <code>'</code> para hacer esto. Sin embargo, podemos usar el carácter especial ninguno o una vez <code>?</code>. Como vimos anteriormente, esto es diferente de <code>*</code> que es ninguno o más Ahora vemos que el cuarto caso también se convierte:</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="procesamiento-de-cadenas.html#cb892-1"></a><span class="kw">str_replace</span>(s, <span class="st">&quot;^([56])&#39;?$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;0&quot;</span>)</span>
<span id="cb892-2"><a href="procesamiento-de-cadenas.html#cb892-2"></a><span class="co">#&gt; [1] &quot;5&#39;0&quot; &quot;6&#39;0&quot; &quot;5&#39;0&quot; &quot;5&#39;0&quot; &quot;5&#39;&#39;&quot; &quot;5&#39;4&quot;</span></span></code></pre></div>
<p>Aquí solo permitimos 5 y 6, pero no 4 y 7. Esto se debe a que 5 y 6 pies de altura es bastante común, por lo que asumimos que aquellos que escribieron 5 o 6 realmente significaron <code>60</code> o <code>72</code> pulgadas. Sin embargo, <code>4</code> y <code>7</code> los pies de altura son tan raros que, aunque aceptamos <code>84</code> como entrada válida, suponemos <code>7</code> fue ingresado por error.</p>
<p>Podemos usar cuantificadores para tratar el caso <strong>3</strong>. Estas entradas no coinciden porque las pulgadas incluyen decimales y nuestro patrón no lo permite. Necesitamos permitir que el segundo grupo incluya decimales, no solo dígitos. Esto significa que debemos permitir cero o un período <code>.</code> entonces cero o más dígitos. Entonces usaremos ambos <code>?</code> y <code>*</code>.
También recuerde que, para este caso particular, el período debe escaparse ya que es un carácter especial (significa cualquier carácter excepto el salto de línea). Aquí hay un ejemplo simple de cómo podemos usar <code>*</code>.</p>
<p>Entonces podemos adaptar nuestro patrón, actualmente <code>^[4-7]\\s*'\\s*\\d{1,2}$</code> para permitir un decimal al final:</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="procesamiento-de-cadenas.html#cb893-1"></a>pattern &lt;-<span class="st"> &quot;^[4-7]</span><span class="ch">\\</span><span class="st">s*&#39;</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d+</span><span class="ch">\\</span><span class="st">.?</span><span class="ch">\\</span><span class="st">d*)$&quot;</span></span></code></pre></div>
<p>Caso 4, metros usando comas, podemos acercarnos de manera similar a cómo convertimos el <code>x.y</code> a <code>x'y</code>. Una diferencia es que requerimos que el primer dígito sea 1 o 2:</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="procesamiento-de-cadenas.html#cb894-1"></a>yes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1,7&quot;</span>, <span class="st">&quot;1, 8&quot;</span>, <span class="st">&quot;2, &quot;</span> )</span>
<span id="cb894-2"><a href="procesamiento-de-cadenas.html#cb894-2"></a>no &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5,8&quot;</span>, <span class="st">&quot;5,3,2&quot;</span>, <span class="st">&quot;1.7&quot;</span>)</span>
<span id="cb894-3"><a href="procesamiento-de-cadenas.html#cb894-3"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(yes, no)</span>
<span id="cb894-4"><a href="procesamiento-de-cadenas.html#cb894-4"></a><span class="kw">str_replace</span>(s, <span class="st">&quot;^([12])</span><span class="ch">\\</span><span class="st">s*,</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1</span><span class="ch">\\</span><span class="st">.</span><span class="ch">\\</span><span class="st">2&quot;</span>)</span>
<span id="cb894-5"><a href="procesamiento-de-cadenas.html#cb894-5"></a><span class="co">#&gt; [1] &quot;1.7&quot;   &quot;1.8&quot;   &quot;2.&quot;    &quot;5,8&quot;   &quot;5,3,2&quot; &quot;1.7&quot;</span></span></code></pre></div>
<p>Luego verificaremos si las entradas son medidores utilizando sus valores numéricos. Volveremos al estudio de caso después de introducir dos funciones ampliamente utilizadas en el procesamiento de cadenas que serán útiles al desarrollar nuestra solución final para las alturas autoinformadas.</p>
</div>
<div id="recorte" class="section level2">
<h2><span class="header-section-number">24.8</span> Recorte</h2>
<p>En general, los espacios al principio o al final de la cadena no son informativos.
Estos pueden ser particularmente engañosos porque a veces pueden ser difíciles de ver:</p>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="procesamiento-de-cadenas.html#cb895-1"></a>s &lt;-<span class="st"> &quot;Hi &quot;</span></span>
<span id="cb895-2"><a href="procesamiento-de-cadenas.html#cb895-2"></a><span class="kw">cat</span>(s)</span>
<span id="cb895-3"><a href="procesamiento-de-cadenas.html#cb895-3"></a><span class="co">#&gt; Hi</span></span>
<span id="cb895-4"><a href="procesamiento-de-cadenas.html#cb895-4"></a><span class="kw">identical</span>(s, <span class="st">&quot;Hi&quot;</span>)</span>
<span id="cb895-5"><a href="procesamiento-de-cadenas.html#cb895-5"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Este es un problema lo suficientemente general como para que haya una función dedicada a eliminarlos:
<code>str_trim</code>.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="procesamiento-de-cadenas.html#cb896-1"></a><span class="kw">str_trim</span>(<span class="st">&quot;5 &#39; 9 &quot;</span>)</span>
<span id="cb896-2"><a href="procesamiento-de-cadenas.html#cb896-2"></a><span class="co">#&gt; [1] &quot;5 &#39; 9&quot;</span></span></code></pre></div>
</div>
<div id="cambio-de-letra" class="section level2">
<h2><span class="header-section-number">24.9</span> Cambio de letra</h2>
<p>Tenga en cuenta que regex distingue entre mayúsculas y minúsculas. A menudo queremos hacer coincidir una palabra independientemente del caso. Un enfoque para hacer esto es cambiar primero todo a minúsculas y luego continuar ignorando mayúsculas y minúsculas. Como ejemplo, tenga en cuenta que una de las entradas escribe números como palabras <code>Five foot eight inches</code>. Aunque no es eficiente, podríamos agregar 13 adicionales <code>str_replace</code> llamadas para convertir <code>zero</code> a <code>0</code>, <code>one</code> a <code>1</code>, y así. Para evitar tener que escribir dos operaciones separadas para <code>Zero</code> y <code>zero</code>, <code>One</code> y <code>one</code>, etc., podemos usar el <code>str_to_lower</code> función para hacer que todas las obras sean minúsculas primero:</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="procesamiento-de-cadenas.html#cb897-1"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Five feet eight inches&quot;</span>)</span>
<span id="cb897-2"><a href="procesamiento-de-cadenas.html#cb897-2"></a><span class="kw">str_to_lower</span>(s)</span>
<span id="cb897-3"><a href="procesamiento-de-cadenas.html#cb897-3"></a><span class="co">#&gt; [1] &quot;five feet eight inches&quot;</span></span></code></pre></div>
<p>Otras funciones relacionadas son <code>str_to_upper</code> y <code>str_to_title</code>. Ahora estamos listos para definir un procedimiento que convierta todos los casos problemáticos a pulgadas.</p>
</div>
<div id="estudio-de-caso-2-alturas-autoinformadas-continuación" class="section level2">
<h2><span class="header-section-number">24.10</span> Estudio de caso 2: alturas autoinformadas (continuación)</h2>
<p>Ahora ponemos todo lo que hemos aprendido en una función que toma un vector de cadena e intenta convertir tantas cadenas como sea posible a un formato. Escribimos una función que reúne lo que hemos hecho anteriormente.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="procesamiento-de-cadenas.html#cb898-1"></a>convert_format &lt;-<span class="st"> </span><span class="cf">function</span>(s){</span>
<span id="cb898-2"><a href="procesamiento-de-cadenas.html#cb898-2"></a>s <span class="op">%&gt;%</span></span>
<span id="cb898-3"><a href="procesamiento-de-cadenas.html#cb898-3"></a><span class="kw">str_replace</span>(<span class="st">&quot;feet|foot|ft&quot;</span>, <span class="st">&quot;&#39;&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb898-4"><a href="procesamiento-de-cadenas.html#cb898-4"></a><span class="kw">str_replace_all</span>(<span class="st">&quot;inches|in|&#39;&#39;|</span><span class="ch">\&quot;</span><span class="st">|cm|and&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb898-5"><a href="procesamiento-de-cadenas.html#cb898-5"></a><span class="kw">str_replace</span>(<span class="st">&quot;^([4-7])</span><span class="ch">\\</span><span class="st">s*[,</span><span class="ch">\\</span><span class="st">.</span><span class="ch">\\</span><span class="st">s+]</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;</span><span class="ch">\\</span><span class="st">2&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb898-6"><a href="procesamiento-de-cadenas.html#cb898-6"></a><span class="kw">str_replace</span>(<span class="st">&quot;^([56])&#39;?$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&#39;0&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb898-7"><a href="procesamiento-de-cadenas.html#cb898-7"></a><span class="kw">str_replace</span>(<span class="st">&quot;^([12])</span><span class="ch">\\</span><span class="st">s*,</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d*)$&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1</span><span class="ch">\\</span><span class="st">.</span><span class="ch">\\</span><span class="st">2&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb898-8"><a href="procesamiento-de-cadenas.html#cb898-8"></a><span class="kw">str_trim</span>()</span>
<span id="cb898-9"><a href="procesamiento-de-cadenas.html#cb898-9"></a>}</span></code></pre></div>
<p>También podemos escribir una función que convierta palabras en números:</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="procesamiento-de-cadenas.html#cb899-1"></a><span class="kw">library</span>(english)</span>
<span id="cb899-2"><a href="procesamiento-de-cadenas.html#cb899-2"></a>words_to_numbers &lt;-<span class="st"> </span><span class="cf">function</span>(s){</span>
<span id="cb899-3"><a href="procesamiento-de-cadenas.html#cb899-3"></a>s &lt;-<span class="st"> </span><span class="kw">str_to_lower</span>(s)</span>
<span id="cb899-4"><a href="procesamiento-de-cadenas.html#cb899-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">11</span>)</span>
<span id="cb899-5"><a href="procesamiento-de-cadenas.html#cb899-5"></a>s &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(s, <span class="kw">words</span>(i), <span class="kw">as.character</span>(i))</span>
<span id="cb899-6"><a href="procesamiento-de-cadenas.html#cb899-6"></a>s</span>
<span id="cb899-7"><a href="procesamiento-de-cadenas.html#cb899-7"></a>}</span></code></pre></div>
<p>Tenga en cuenta que podemos realizar la operación anterior de manera más eficiente con la función <code>recode</code>, que aprendemos en la Sección <a href="procesamiento-de-cadenas.html#recode">24.13</a>.
Ahora podemos ver qué entradas problemáticas permanecen:</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="procesamiento-de-cadenas.html#cb900-1"></a>converted &lt;-<span class="st"> </span>problems <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">words_to_numbers</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">convert_format</span>()</span>
<span id="cb900-2"><a href="procesamiento-de-cadenas.html#cb900-2"></a>remaining_problems &lt;-<span class="st"> </span>converted[<span class="kw">not_inches_or_cm</span>(converted)]</span>
<span id="cb900-3"><a href="procesamiento-de-cadenas.html#cb900-3"></a>pattern &lt;-<span class="st"> &quot;^[4-7]</span><span class="ch">\\</span><span class="st">s*&#39;</span><span class="ch">\\</span><span class="st">s*</span><span class="ch">\\</span><span class="st">d+</span><span class="ch">\\</span><span class="st">.?</span><span class="ch">\\</span><span class="st">d*$&quot;</span></span>
<span id="cb900-4"><a href="procesamiento-de-cadenas.html#cb900-4"></a>index &lt;-<span class="st"> </span><span class="kw">str_detect</span>(remaining_problems, pattern)</span>
<span id="cb900-5"><a href="procesamiento-de-cadenas.html#cb900-5"></a>remaining_problems[<span class="op">!</span>index]</span>
<span id="cb900-6"><a href="procesamiento-de-cadenas.html#cb900-6"></a><span class="co">#&gt;  [1] &quot;511&quot;       &quot;2&quot;         &quot;&gt;9000&quot;     &quot;11111&quot;     &quot;103.2&quot;    </span></span>
<span id="cb900-7"><a href="procesamiento-de-cadenas.html#cb900-7"></a><span class="co">#&gt;  [6] &quot;19&quot;        &quot;300&quot;       &quot;7&quot;         &quot;214&quot;       &quot;0.7&quot;      </span></span>
<span id="cb900-8"><a href="procesamiento-de-cadenas.html#cb900-8"></a><span class="co">#&gt; [11] &quot;2&#39;33&quot;      &quot;612&quot;       &quot;1.70&quot;      &quot;87&quot;        &quot;111&quot;      </span></span>
<span id="cb900-9"><a href="procesamiento-de-cadenas.html#cb900-9"></a><span class="co">#&gt; [16] &quot;12&quot;        &quot;yyy&quot;       &quot;89&quot;        &quot;34&quot;        &quot;25&quot;       </span></span>
<span id="cb900-10"><a href="procesamiento-de-cadenas.html#cb900-10"></a><span class="co">#&gt; [21] &quot;22&quot;        &quot;684&quot;       &quot;1&quot;         &quot;1&quot;         &quot;6*12&quot;     </span></span>
<span id="cb900-11"><a href="procesamiento-de-cadenas.html#cb900-11"></a><span class="co">#&gt; [26] &quot;87&quot;        &quot;1.6&quot;       &quot;120&quot;       &quot;120&quot;       &quot;23&quot;       </span></span>
<span id="cb900-12"><a href="procesamiento-de-cadenas.html#cb900-12"></a><span class="co">#&gt; [31] &quot;1.7&quot;       &quot;86&quot;        &quot;708,661&quot;   &quot;649,606&quot;   &quot;10000&quot;    </span></span>
<span id="cb900-13"><a href="procesamiento-de-cadenas.html#cb900-13"></a><span class="co">#&gt; [36] &quot;1&quot;         &quot;728,346&quot;   &quot;0&quot;         &quot;100&quot;       &quot;88&quot;       </span></span>
<span id="cb900-14"><a href="procesamiento-de-cadenas.html#cb900-14"></a><span class="co">#&gt; [41] &quot;7,283,465&quot; &quot;34&quot;</span></span></code></pre></div>
<p>además de los casos informados como medidores, que solucionaremos a continuación, todos parecen ser casos imposibles de solucionar.</p>
<div id="los-extract-función" class="section level3">
<h3><span class="header-section-number">24.10.1</span> Los <code>extract</code> función</h3>
<p>Los <code>extract</code> la función es una función <strong>tidyverse</strong> útil para el procesamiento de cadenas que usaremos en nuestra solución final, así que la presentamos aquí. En una sección anterior, construimos una expresión regular que nos permite identificar qué elementos de un vector de caracteres coinciden con el patrón de pies y pulgadas. Sin embargo, queremos hacer más. Queremos extraer y guardar los pies y los valores numéricos para poder convertirlos a pulgadas cuando sea apropiado.</p>
<p>Si tenemos un caso más simple como este:</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="procesamiento-de-cadenas.html#cb901-1"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&#39;10&quot;</span>, <span class="st">&quot;6&#39;1&quot;</span>)</span>
<span id="cb901-2"><a href="procesamiento-de-cadenas.html#cb901-2"></a>tab &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> s)</span></code></pre></div>
<p>En la sección <a href="reformar-datos.html#separate">21.3</a> aprendimos sobre el <code>separate</code> función, que se puede utilizar para lograr nuestro objetivo actual:</p>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="procesamiento-de-cadenas.html#cb902-1"></a>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(x, <span class="kw">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;&#39;&quot;</span>)</span>
<span id="cb902-2"><a href="procesamiento-de-cadenas.html#cb902-2"></a><span class="co">#&gt;   feet inches</span></span>
<span id="cb902-3"><a href="procesamiento-de-cadenas.html#cb902-3"></a><span class="co">#&gt; 1    5     10</span></span>
<span id="cb902-4"><a href="procesamiento-de-cadenas.html#cb902-4"></a><span class="co">#&gt; 2    6      1</span></span></code></pre></div>
<p>Los <code>extract</code> la función del paquete <strong>tidyr</strong> nos permite usar grupos regex para extraer los valores deseados. Aquí está el equivalente al código anterior usando <code>separate</code> pero usando <code>extract</code>:</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="procesamiento-de-cadenas.html#cb903-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb903-2"><a href="procesamiento-de-cadenas.html#cb903-2"></a>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">extract</span>(x, <span class="kw">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="dt">regex =</span> <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">d)&#39;(</span><span class="ch">\\</span><span class="st">d{1,2})&quot;</span>)</span>
<span id="cb903-3"><a href="procesamiento-de-cadenas.html#cb903-3"></a><span class="co">#&gt;   feet inches</span></span>
<span id="cb903-4"><a href="procesamiento-de-cadenas.html#cb903-4"></a><span class="co">#&gt; 1    5     10</span></span>
<span id="cb903-5"><a href="procesamiento-de-cadenas.html#cb903-5"></a><span class="co">#&gt; 2    6      1</span></span></code></pre></div>
<p>Entonces, ¿por qué necesitamos la nueva función? <code>extract</code>? Hemos visto cómo pequeños cambios pueden provocar la coincidencia exacta de patrones. Los grupos en expresiones regulares nos dan más flexibilidad. Por ejemplo, si definimos:</p>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="procesamiento-de-cadenas.html#cb904-1"></a>s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;5&#39;10&quot;</span>, <span class="st">&quot;6&#39;1</span><span class="ch">\&quot;</span><span class="st">&quot;</span>,<span class="st">&quot;5&#39;8inches&quot;</span>)</span>
<span id="cb904-2"><a href="procesamiento-de-cadenas.html#cb904-2"></a>tab &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> s)</span></code></pre></div>
<p>y solo queremos los números, <code>separate</code> falla:</p>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="procesamiento-de-cadenas.html#cb905-1"></a>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(x, <span class="kw">c</span>(<span class="st">&quot;feet&quot;</span>,<span class="st">&quot;inches&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;&#39;&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb905-2"><a href="procesamiento-de-cadenas.html#cb905-2"></a><span class="co">#&gt;   feet  inches</span></span>
<span id="cb905-3"><a href="procesamiento-de-cadenas.html#cb905-3"></a><span class="co">#&gt; 1    5      10</span></span>
<span id="cb905-4"><a href="procesamiento-de-cadenas.html#cb905-4"></a><span class="co">#&gt; 2    6      1&quot;</span></span>
<span id="cb905-5"><a href="procesamiento-de-cadenas.html#cb905-5"></a><span class="co">#&gt; 3    5 8inches</span></span></code></pre></div>
<p>Sin embargo, podemos usar <code>extract</code>. La expresión regular aquí es un poco más complicada ya que tenemos que permitir <code>'</code> con espacios y <code>feet</code>. Tampoco queremos el <code>"</code> incluido en el valor, por lo que no lo incluimos en el grupo:</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="procesamiento-de-cadenas.html#cb906-1"></a>tab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">extract</span>(x, <span class="kw">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="dt">regex =</span> <span class="st">&quot;(</span><span class="ch">\\</span><span class="st">d)&#39;(</span><span class="ch">\\</span><span class="st">d{1,2})&quot;</span>)</span>
<span id="cb906-2"><a href="procesamiento-de-cadenas.html#cb906-2"></a><span class="co">#&gt;   feet inches</span></span>
<span id="cb906-3"><a href="procesamiento-de-cadenas.html#cb906-3"></a><span class="co">#&gt; 1    5     10</span></span>
<span id="cb906-4"><a href="procesamiento-de-cadenas.html#cb906-4"></a><span class="co">#&gt; 2    6      1</span></span>
<span id="cb906-5"><a href="procesamiento-de-cadenas.html#cb906-5"></a><span class="co">#&gt; 3    5      8</span></span></code></pre></div>
</div>
<div id="poniendolo-todo-junto" class="section level3">
<h3><span class="header-section-number">24.10.2</span> Poniendolo todo junto</h3>
<p>Ahora estamos listos para poner todo junto y discutir nuestros datos de alturas reportados para tratar de recuperar tantas alturas como sea posible. El código es complejo, pero lo dividiremos en partes.</p>
<p>Comenzamos limpiando el <code>height</code> columna para que las alturas estén más cerca de un formato de pulgadas y pies. Agregamos una columna de alturas original para poder comparar antes y después.</p>
<p>Ahora estamos listos para discutir nuestro conjunto de datos de alturas reportadas:</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="procesamiento-de-cadenas.html#cb907-1"></a>pattern &lt;-<span class="st"> &quot;^([4-7])</span><span class="ch">\\</span><span class="st">s*&#39;</span><span class="ch">\\</span><span class="st">s*(</span><span class="ch">\\</span><span class="st">d+</span><span class="ch">\\</span><span class="st">.?</span><span class="ch">\\</span><span class="st">d*)$&quot;</span></span>
<span id="cb907-2"><a href="procesamiento-de-cadenas.html#cb907-2"></a></span>
<span id="cb907-3"><a href="procesamiento-de-cadenas.html#cb907-3"></a>smallest &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb907-4"><a href="procesamiento-de-cadenas.html#cb907-4"></a>tallest &lt;-<span class="st"> </span><span class="dv">84</span></span>
<span id="cb907-5"><a href="procesamiento-de-cadenas.html#cb907-5"></a>new_heights &lt;-<span class="st"> </span>reported_heights <span class="op">%&gt;%</span></span>
<span id="cb907-6"><a href="procesamiento-de-cadenas.html#cb907-6"></a><span class="kw">mutate</span>(<span class="dt">original =</span> height,</span>
<span id="cb907-7"><a href="procesamiento-de-cadenas.html#cb907-7"></a><span class="dt">height =</span> <span class="kw">words_to_numbers</span>(height) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">convert_format</span>()) <span class="op">%&gt;%</span></span>
<span id="cb907-8"><a href="procesamiento-de-cadenas.html#cb907-8"></a><span class="kw">extract</span>(height, <span class="kw">c</span>(<span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), <span class="dt">regex =</span> pattern, <span class="dt">remove =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb907-9"><a href="procesamiento-de-cadenas.html#cb907-9"></a><span class="kw">mutate_at</span>(<span class="kw">c</span>(<span class="st">&quot;height&quot;</span>, <span class="st">&quot;feet&quot;</span>, <span class="st">&quot;inches&quot;</span>), as.numeric) <span class="op">%&gt;%</span></span>
<span id="cb907-10"><a href="procesamiento-de-cadenas.html#cb907-10"></a><span class="kw">mutate</span>(<span class="dt">guess =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span>feet <span class="op">+</span><span class="st"> </span>inches) <span class="op">%&gt;%</span></span>
<span id="cb907-11"><a href="procesamiento-de-cadenas.html#cb907-11"></a><span class="kw">mutate</span>(<span class="dt">height =</span> <span class="kw">case_when</span>(</span>
<span id="cb907-12"><a href="procesamiento-de-cadenas.html#cb907-12"></a><span class="kw">is.na</span>(height) <span class="op">~</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="ot">NA</span>),</span>
<span id="cb907-13"><a href="procesamiento-de-cadenas.html#cb907-13"></a><span class="kw">between</span>(height, smallest, tallest) <span class="op">~</span><span class="st"> </span>height, <span class="co">#inches</span></span>
<span id="cb907-14"><a href="procesamiento-de-cadenas.html#cb907-14"></a><span class="kw">between</span>(height<span class="op">/</span><span class="fl">2.54</span>, smallest, tallest) <span class="op">~</span><span class="st"> </span>height<span class="op">/</span><span class="fl">2.54</span>, <span class="co">#cm</span></span>
<span id="cb907-15"><a href="procesamiento-de-cadenas.html#cb907-15"></a><span class="kw">between</span>(height<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="fl">2.54</span>, smallest, tallest) <span class="op">~</span><span class="st"> </span>height<span class="op">*</span><span class="dv">100</span><span class="op">/</span><span class="fl">2.54</span>, <span class="co">#meters</span></span>
<span id="cb907-16"><a href="procesamiento-de-cadenas.html#cb907-16"></a><span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="ot">NA</span>))) <span class="op">%&gt;%</span></span>
<span id="cb907-17"><a href="procesamiento-de-cadenas.html#cb907-17"></a><span class="kw">mutate</span>(<span class="dt">height =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(height) <span class="op">&amp;</span></span>
<span id="cb907-18"><a href="procesamiento-de-cadenas.html#cb907-18"></a>inches <span class="op">&lt;</span><span class="st"> </span><span class="dv">12</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">between</span>(guess, smallest, tallest),</span>
<span id="cb907-19"><a href="procesamiento-de-cadenas.html#cb907-19"></a>guess, height)) <span class="op">%&gt;%</span></span>
<span id="cb907-20"><a href="procesamiento-de-cadenas.html#cb907-20"></a><span class="kw">select</span>(<span class="op">-</span>guess)</span></code></pre></div>
<p>Podemos verificar todas las entradas que convertimos escribiendo:</p>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="procesamiento-de-cadenas.html#cb908-1"></a>new_heights <span class="op">%&gt;%</span></span>
<span id="cb908-2"><a href="procesamiento-de-cadenas.html#cb908-2"></a><span class="kw">filter</span>(<span class="kw">not_inches</span>(original)) <span class="op">%&gt;%</span></span>
<span id="cb908-3"><a href="procesamiento-de-cadenas.html#cb908-3"></a><span class="kw">select</span>(original, height) <span class="op">%&gt;%</span></span>
<span id="cb908-4"><a href="procesamiento-de-cadenas.html#cb908-4"></a><span class="kw">arrange</span>(height) <span class="op">%&gt;%</span></span>
<span id="cb908-5"><a href="procesamiento-de-cadenas.html#cb908-5"></a><span class="kw">View</span>()</span></code></pre></div>
<p>Una observación final es que si miramos a los estudiantes más bajos de nuestro curso:</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="procesamiento-de-cadenas.html#cb909-1"></a>new_heights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(height) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dt">n=</span><span class="dv">7</span>)</span>
<span id="cb909-2"><a href="procesamiento-de-cadenas.html#cb909-2"></a><span class="co">#&gt;            time_stamp    sex height feet inches original</span></span>
<span id="cb909-3"><a href="procesamiento-de-cadenas.html#cb909-3"></a><span class="co">#&gt; 1 2017-07-04 01:30:25   Male   50.0   NA     NA       50</span></span>
<span id="cb909-4"><a href="procesamiento-de-cadenas.html#cb909-4"></a><span class="co">#&gt; 2 2017-09-07 10:40:35   Male   50.0   NA     NA       50</span></span>
<span id="cb909-5"><a href="procesamiento-de-cadenas.html#cb909-5"></a><span class="co">#&gt; 3 2014-09-02 15:18:30 Female   51.0   NA     NA       51</span></span>
<span id="cb909-6"><a href="procesamiento-de-cadenas.html#cb909-6"></a><span class="co">#&gt; 4 2016-06-05 14:07:20 Female   52.0   NA     NA       52</span></span>
<span id="cb909-7"><a href="procesamiento-de-cadenas.html#cb909-7"></a><span class="co">#&gt; 5 2016-06-05 14:07:38 Female   52.0   NA     NA       52</span></span>
<span id="cb909-8"><a href="procesamiento-de-cadenas.html#cb909-8"></a><span class="co">#&gt; 6 2014-09-23 03:39:56 Female   53.0   NA     NA       53</span></span>
<span id="cb909-9"><a href="procesamiento-de-cadenas.html#cb909-9"></a><span class="co">#&gt; 7 2015-01-07 08:57:29   Male   53.8   NA     NA    53.77</span></span></code></pre></div>
<p>Vemos alturas de 53, 54 y 55. En los originales, también tenemos 51 y 52. Estas alturas cortas son raras y es probable que los estudiantes realmente quisieran decir <code>5'1</code>, <code>5'2</code>, <code>5'3</code>, <code>5'4</code> y <code>5'5</code>. Debido a que no estamos completamente seguros, los dejaremos según lo informado. El objeto <code>new_heights</code> contiene nuestra solución final para este caso de estudio.</p>
</div>
</div>
<div id="división-de-cadenas" class="section level2">
<h2><span class="header-section-number">24.11</span> División de cadenas</h2>
<p>Otra operación de disputa de datos muy común es la división de cadenas. Para ilustrar cómo surge esto, comenzamos con un ejemplo ilustrativo. Supongamos que no tenemos la función <code>read_csv</code> o <code>read.csv</code> disponible para nosotros. En cambio, tenemos que leer un archivo csv usando la función base R <code>readLines</code> me gusta esto:</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="procesamiento-de-cadenas.html#cb910-1"></a>filename &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata/murders.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;dslabs&quot;</span>)</span>
<span id="cb910-2"><a href="procesamiento-de-cadenas.html#cb910-2"></a>lines &lt;-<span class="st"> </span><span class="kw">readLines</span>(filename)</span></code></pre></div>
<p>Esta función lee los datos línea por línea para crear un vector de cadenas. En este caso, una cadena para cada fila en la hoja de cálculo. Las primeras seis líneas son:</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="procesamiento-de-cadenas.html#cb911-1"></a>lines <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</span>
<span id="cb911-2"><a href="procesamiento-de-cadenas.html#cb911-2"></a><span class="co">#&gt; [1] &quot;state,abb,region,population,total&quot;</span></span>
<span id="cb911-3"><a href="procesamiento-de-cadenas.html#cb911-3"></a><span class="co">#&gt; [2] &quot;Alabama,AL,South,4779736,135&quot;     </span></span>
<span id="cb911-4"><a href="procesamiento-de-cadenas.html#cb911-4"></a><span class="co">#&gt; [3] &quot;Alaska,AK,West,710231,19&quot;         </span></span>
<span id="cb911-5"><a href="procesamiento-de-cadenas.html#cb911-5"></a><span class="co">#&gt; [4] &quot;Arizona,AZ,West,6392017,232&quot;      </span></span>
<span id="cb911-6"><a href="procesamiento-de-cadenas.html#cb911-6"></a><span class="co">#&gt; [5] &quot;Arkansas,AR,South,2915918,93&quot;     </span></span>
<span id="cb911-7"><a href="procesamiento-de-cadenas.html#cb911-7"></a><span class="co">#&gt; [6] &quot;California,CA,West,37253956,1257&quot;</span></span></code></pre></div>
<p>Queremos extraer los valores que están separados por una coma para cada cadena en el vector. El comando <code>str_split</code> hace exactamente esto:</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="procesamiento-de-cadenas.html#cb912-1"></a>x &lt;-<span class="st"> </span><span class="kw">str_split</span>(lines, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb912-2"><a href="procesamiento-de-cadenas.html#cb912-2"></a>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb912-3"><a href="procesamiento-de-cadenas.html#cb912-3"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb912-4"><a href="procesamiento-de-cadenas.html#cb912-4"></a><span class="co">#&gt; [1] &quot;state&quot;      &quot;abb&quot;        &quot;region&quot;     &quot;population&quot; &quot;total&quot;     </span></span>
<span id="cb912-5"><a href="procesamiento-de-cadenas.html#cb912-5"></a><span class="co">#&gt; </span></span>
<span id="cb912-6"><a href="procesamiento-de-cadenas.html#cb912-6"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb912-7"><a href="procesamiento-de-cadenas.html#cb912-7"></a><span class="co">#&gt; [1] &quot;Alabama&quot; &quot;AL&quot;      &quot;South&quot;   &quot;4779736&quot; &quot;135&quot;</span></span></code></pre></div>
<p>Tenga en cuenta que la primera entrada tiene los nombres de columna, por lo que podemos separar eso:</p>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="procesamiento-de-cadenas.html#cb913-1"></a>col_names &lt;-<span class="st"> </span>x[[<span class="dv">1</span>]]</span>
<span id="cb913-2"><a href="procesamiento-de-cadenas.html#cb913-2"></a>x &lt;-<span class="st"> </span>x[<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
<p>Para convertir nuestra lista en un marco de datos, podemos usar un acceso directo proporcionado por el <code>map</code> funciona en el paquete <strong>purrr</strong>. La función de mapa aplica la misma función a cada elemento en una lista. Entonces, si queremos extraer la primera entrada de cada elemento en <code>x</code>, podemos escribir:</p>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="procesamiento-de-cadenas.html#cb914-1"></a><span class="kw">library</span>(purrr)</span>
<span id="cb914-2"><a href="procesamiento-de-cadenas.html#cb914-2"></a><span class="kw">map</span>(x, <span class="cf">function</span>(y) y[<span class="dv">1</span>]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span>
<span id="cb914-3"><a href="procesamiento-de-cadenas.html#cb914-3"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb914-4"><a href="procesamiento-de-cadenas.html#cb914-4"></a><span class="co">#&gt; [1] &quot;Alabama&quot;</span></span>
<span id="cb914-5"><a href="procesamiento-de-cadenas.html#cb914-5"></a><span class="co">#&gt; </span></span>
<span id="cb914-6"><a href="procesamiento-de-cadenas.html#cb914-6"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb914-7"><a href="procesamiento-de-cadenas.html#cb914-7"></a><span class="co">#&gt; [1] &quot;Alaska&quot;</span></span></code></pre></div>
<p>Sin embargo, debido a que esta es una tarea tan común, <strong>purrr</strong> proporciona un acceso directo. Si el segundo argumento recibe un entero en lugar de una función, se supone que queremos esa entrada. Entonces, el código anterior se puede escribir de manera más eficiente de esta manera:</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="procesamiento-de-cadenas.html#cb915-1"></a><span class="kw">map</span>(x, <span class="dv">1</span>)</span></code></pre></div>
<p>Para forzar <code>map</code> para devolver un vector de caracteres en lugar de una lista, podemos usar <code>map_chr</code>. Similar, <code>map_int</code> devuelve enteros. Entonces, para crear nuestro marco de datos, podemos usar:</p>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="procesamiento-de-cadenas.html#cb916-1"></a>dat &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="kw">map_chr</span>(x, <span class="dv">1</span>),</span>
<span id="cb916-2"><a href="procesamiento-de-cadenas.html#cb916-2"></a><span class="kw">map_chr</span>(x, <span class="dv">2</span>),</span>
<span id="cb916-3"><a href="procesamiento-de-cadenas.html#cb916-3"></a><span class="kw">map_chr</span>(x, <span class="dv">3</span>),</span>
<span id="cb916-4"><a href="procesamiento-de-cadenas.html#cb916-4"></a><span class="kw">map_chr</span>(x, <span class="dv">4</span>),</span>
<span id="cb916-5"><a href="procesamiento-de-cadenas.html#cb916-5"></a><span class="kw">map_chr</span>(x, <span class="dv">5</span>)) <span class="op">%&gt;%</span></span>
<span id="cb916-6"><a href="procesamiento-de-cadenas.html#cb916-6"></a><span class="kw">mutate_all</span>(parse_guess) <span class="op">%&gt;%</span></span>
<span id="cb916-7"><a href="procesamiento-de-cadenas.html#cb916-7"></a><span class="kw">setNames</span>(col_names)</span>
<span id="cb916-8"><a href="procesamiento-de-cadenas.html#cb916-8"></a>dat <span class="op">%&gt;%</span><span class="st"> </span>head</span>
<span id="cb916-9"><a href="procesamiento-de-cadenas.html#cb916-9"></a><span class="co">#&gt; # A tibble: 6 x 5</span></span>
<span id="cb916-10"><a href="procesamiento-de-cadenas.html#cb916-10"></a><span class="co">#&gt;   state      abb   region population total</span></span>
<span id="cb916-11"><a href="procesamiento-de-cadenas.html#cb916-11"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb916-12"><a href="procesamiento-de-cadenas.html#cb916-12"></a><span class="co">#&gt; 1 Alabama    AL    South     4779736   135</span></span>
<span id="cb916-13"><a href="procesamiento-de-cadenas.html#cb916-13"></a><span class="co">#&gt; 2 Alaska     AK    West       710231    19</span></span>
<span id="cb916-14"><a href="procesamiento-de-cadenas.html#cb916-14"></a><span class="co">#&gt; 3 Arizona    AZ    West      6392017   232</span></span>
<span id="cb916-15"><a href="procesamiento-de-cadenas.html#cb916-15"></a><span class="co">#&gt; 4 Arkansas   AR    South     2915918    93</span></span>
<span id="cb916-16"><a href="procesamiento-de-cadenas.html#cb916-16"></a><span class="co">#&gt; 5 California CA    West     37253956  1257</span></span>
<span id="cb916-17"><a href="procesamiento-de-cadenas.html#cb916-17"></a><span class="co">#&gt; # … with 1 more row</span></span></code></pre></div>
<p>Si aprende más sobre el paquete <strong>purrr</strong>, aprenderá que realiza lo anterior con el siguiente código, más eficiente:</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="procesamiento-de-cadenas.html#cb917-1"></a>dat &lt;-<span class="st"> </span>x <span class="op">%&gt;%</span></span>
<span id="cb917-2"><a href="procesamiento-de-cadenas.html#cb917-2"></a><span class="kw">transpose</span>() <span class="op">%&gt;%</span></span>
<span id="cb917-3"><a href="procesamiento-de-cadenas.html#cb917-3"></a><span class="kw">map</span>( <span class="op">~</span><span class="st"> </span><span class="kw">parse_guess</span>(<span class="kw">unlist</span>(.))) <span class="op">%&gt;%</span></span>
<span id="cb917-4"><a href="procesamiento-de-cadenas.html#cb917-4"></a><span class="kw">setNames</span>(col_names) <span class="op">%&gt;%</span></span>
<span id="cb917-5"><a href="procesamiento-de-cadenas.html#cb917-5"></a><span class="kw">as_tibble</span>()</span></code></pre></div>
<p>Resulta que podemos evitar todo el trabajo que se muestra arriba después de la llamada a <code>str_split</code>. Específicamente, si sabemos que los datos que estamos extrayendo se pueden representar como una tabla, podemos usar el argumento <code>simplify=TRUE</code> y <code>str_split</code> devuelve una matriz en lugar de una lista:</p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="procesamiento-de-cadenas.html#cb918-1"></a>x &lt;-<span class="st"> </span><span class="kw">str_split</span>(lines, <span class="st">&quot;,&quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>)</span>
<span id="cb918-2"><a href="procesamiento-de-cadenas.html#cb918-2"></a>col_names &lt;-<span class="st"> </span>x[<span class="dv">1</span>,]</span>
<span id="cb918-3"><a href="procesamiento-de-cadenas.html#cb918-3"></a>x &lt;-<span class="st"> </span>x[<span class="op">-</span><span class="dv">1</span>,]</span>
<span id="cb918-4"><a href="procesamiento-de-cadenas.html#cb918-4"></a><span class="kw">colnames</span>(x) &lt;-<span class="st"> </span>col_names</span>
<span id="cb918-5"><a href="procesamiento-de-cadenas.html#cb918-5"></a>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></span>
<span id="cb918-6"><a href="procesamiento-de-cadenas.html#cb918-6"></a><span class="kw">mutate_all</span>(parse_guess) <span class="op">%&gt;%</span></span>
<span id="cb918-7"><a href="procesamiento-de-cadenas.html#cb918-7"></a><span class="kw">head</span>(<span class="dv">5</span>)</span>
<span id="cb918-8"><a href="procesamiento-de-cadenas.html#cb918-8"></a><span class="co">#&gt; # A tibble: 5 x 5</span></span>
<span id="cb918-9"><a href="procesamiento-de-cadenas.html#cb918-9"></a><span class="co">#&gt;   state      abb   region population total</span></span>
<span id="cb918-10"><a href="procesamiento-de-cadenas.html#cb918-10"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb918-11"><a href="procesamiento-de-cadenas.html#cb918-11"></a><span class="co">#&gt; 1 Alabama    AL    South     4779736   135</span></span>
<span id="cb918-12"><a href="procesamiento-de-cadenas.html#cb918-12"></a><span class="co">#&gt; 2 Alaska     AK    West       710231    19</span></span>
<span id="cb918-13"><a href="procesamiento-de-cadenas.html#cb918-13"></a><span class="co">#&gt; 3 Arizona    AZ    West      6392017   232</span></span>
<span id="cb918-14"><a href="procesamiento-de-cadenas.html#cb918-14"></a><span class="co">#&gt; 4 Arkansas   AR    South     2915918    93</span></span>
<span id="cb918-15"><a href="procesamiento-de-cadenas.html#cb918-15"></a><span class="co">#&gt; 5 California CA    West     37253956  1257</span></span></code></pre></div>
</div>
<div id="estudio-de-caso-3-extracción-de-tablas-de-un-pdf" class="section level2">
<h2><span class="header-section-number">24.12</span> Estudio de caso 3: extracción de tablas de un PDF</h2>
<p>Uno de los conjuntos de datos proporcionados en <strong>dslabs</strong> muestra las tasas de financiación científica por género en los Países Bajos:</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="procesamiento-de-cadenas.html#cb919-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb919-2"><a href="procesamiento-de-cadenas.html#cb919-2"></a><span class="kw">data</span>(<span class="st">&quot;research_funding_rates&quot;</span>)</span>
<span id="cb919-3"><a href="procesamiento-de-cadenas.html#cb919-3"></a>research_funding_rates <span class="op">%&gt;%</span></span>
<span id="cb919-4"><a href="procesamiento-de-cadenas.html#cb919-4"></a><span class="kw">select</span>(<span class="st">&quot;discipline&quot;</span>, <span class="st">&quot;success_rates_men&quot;</span>, <span class="st">&quot;success_rates_women&quot;</span>)</span>
<span id="cb919-5"><a href="procesamiento-de-cadenas.html#cb919-5"></a><span class="co">#&gt;            discipline success_rates_men success_rates_women</span></span>
<span id="cb919-6"><a href="procesamiento-de-cadenas.html#cb919-6"></a><span class="co">#&gt; 1   Chemical sciences              26.5                25.6</span></span>
<span id="cb919-7"><a href="procesamiento-de-cadenas.html#cb919-7"></a><span class="co">#&gt; 2   Physical sciences              19.3                23.1</span></span>
<span id="cb919-8"><a href="procesamiento-de-cadenas.html#cb919-8"></a><span class="co">#&gt; 3             Physics              26.9                22.2</span></span>
<span id="cb919-9"><a href="procesamiento-de-cadenas.html#cb919-9"></a><span class="co">#&gt; 4          Humanities              14.3                19.3</span></span>
<span id="cb919-10"><a href="procesamiento-de-cadenas.html#cb919-10"></a><span class="co">#&gt; 5  Technical sciences              15.9                21.0</span></span>
<span id="cb919-11"><a href="procesamiento-de-cadenas.html#cb919-11"></a><span class="co">#&gt; 6   Interdisciplinary              11.4                21.8</span></span>
<span id="cb919-12"><a href="procesamiento-de-cadenas.html#cb919-12"></a><span class="co">#&gt; 7 Earth/life sciences              24.4                14.3</span></span>
<span id="cb919-13"><a href="procesamiento-de-cadenas.html#cb919-13"></a><span class="co">#&gt; 8     Social sciences              15.3                11.5</span></span>
<span id="cb919-14"><a href="procesamiento-de-cadenas.html#cb919-14"></a><span class="co">#&gt; 9    Medical sciences              18.8                11.2</span></span></code></pre></div>
<p>Los datos provienen de un artículo publicado en las Actas de la Academia Nacional de Ciencias (PNAS)<a href="#fn91" class="footnote-ref" id="fnref91"><sup>91</sup></a>, una revista científica ampliamente leída. Sin embargo, los datos no se proporcionan en una hoja de cálculo; Está en una tabla en un documento PDF. Aquí hay una captura de pantalla de la tabla:</p>
<p><img src="wrangling/img/pnas-table-s1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>(Fuente: Romy van der Lee y Naomi Ellemers, PNAS 2015 112 (40) 12349-12353<a href="#fn92" class="footnote-ref" id="fnref92"><sup>92</sup></a>.)</p>
<p>Podríamos extraer los números a mano, pero esto podría conducir a un error humano. En su lugar, podemos intentar cambiar los datos con R. Comenzamos descargando el documento pdf y luego importándolo a R:</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="procesamiento-de-cadenas.html#cb920-1"></a><span class="kw">library</span>(<span class="st">&quot;pdftools&quot;</span>)</span>
<span id="cb920-2"><a href="procesamiento-de-cadenas.html#cb920-2"></a>temp_file &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</span>
<span id="cb920-3"><a href="procesamiento-de-cadenas.html#cb920-3"></a>url &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;http://www.pnas.org/content/suppl/2015/09/16/&quot;</span>,</span>
<span id="cb920-4"><a href="procesamiento-de-cadenas.html#cb920-4"></a><span class="st">&quot;1510159112.DCSupplemental/pnas.201510159SI.pdf&quot;</span>)</span>
<span id="cb920-5"><a href="procesamiento-de-cadenas.html#cb920-5"></a><span class="kw">download.file</span>(url, temp_file)</span>
<span id="cb920-6"><a href="procesamiento-de-cadenas.html#cb920-6"></a>txt &lt;-<span class="st"> </span><span class="kw">pdf_text</span>(temp_file)</span>
<span id="cb920-7"><a href="procesamiento-de-cadenas.html#cb920-7"></a><span class="kw">file.remove</span>(temp_file)</span></code></pre></div>
<p>Si examinamos el texto del objeto, notamos que es un vector de caracteres con una entrada para cada página. Entonces mantenemos la página que queremos:</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="procesamiento-de-cadenas.html#cb921-1"></a>raw_data_research_funding_rates &lt;-<span class="st"> </span>txt[<span class="dv">2</span>]</span></code></pre></div>
<p>Los pasos anteriores se pueden omitir realmente porque también incluimos estos datos en bruto en el paquete <strong>dslabs</strong>:</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="procesamiento-de-cadenas.html#cb922-1"></a><span class="kw">data</span>(<span class="st">&quot;raw_data_research_funding_rates&quot;</span>)</span></code></pre></div>
<p>Examinando el objeto <code>raw_data_research_funding_rates</code>
vemos que es una cadena larga y cada línea de la página, incluidas las filas de la tabla, están separadas por el símbolo de nueva línea: <code>\n</code>. Por lo tanto, podemos crear una lista con las líneas del texto como elementos de la siguiente manera:</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="procesamiento-de-cadenas.html#cb923-1"></a>tab &lt;-<span class="st"> </span><span class="kw">str_split</span>(raw_data_research_funding_rates, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Debido a que comenzamos con solo un elemento en la cadena, terminamos con una lista con solo una entrada.</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="procesamiento-de-cadenas.html#cb924-1"></a>tab &lt;-<span class="st"> </span>tab[[<span class="dv">1</span>]]</span></code></pre></div>
<p>Mediante el examen <code>tab</code> vemos que la información para los nombres de columna es la tercera y cuarta entrada:</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="procesamiento-de-cadenas.html#cb925-1"></a>the_names_<span class="dv">1</span> &lt;-<span class="st"> </span>tab[<span class="dv">3</span>]</span>
<span id="cb925-2"><a href="procesamiento-de-cadenas.html#cb925-2"></a>the_names_<span class="dv">2</span> &lt;-<span class="st"> </span>tab[<span class="dv">4</span>]</span></code></pre></div>
<p>La primera de estas filas se ve así:</p>
<pre><code>#&gt;                                                       Applications, n
#&gt;                   Awards, n                      Success rates, %</code></pre>
<p>Queremos crear un vector con un nombre para cada columna. Usando algunas de las funciones que acabamos de aprender, hacemos esto. Empecemos con <code>the_names_1</code>, mostrado anteriormente. Queremos eliminar el espacio inicial y todo lo que sigue a la coma. Utilizamos regex para este último. Entonces podemos obtener los elementos dividiendo cadenas separadas por espacio. Queremos dividir solo cuando hay 2 o más espacios para evitar dividir <code>Success rates</code>. Entonces usamos la expresión regular <code>\\s{2,}</code></p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="procesamiento-de-cadenas.html#cb927-1"></a>the_names_<span class="dv">1</span> &lt;-<span class="st"> </span>the_names_<span class="dv">1</span> <span class="op">%&gt;%</span></span>
<span id="cb927-2"><a href="procesamiento-de-cadenas.html#cb927-2"></a><span class="kw">str_trim</span>() <span class="op">%&gt;%</span></span>
<span id="cb927-3"><a href="procesamiento-de-cadenas.html#cb927-3"></a><span class="kw">str_replace_all</span>(<span class="st">&quot;,</span><span class="ch">\\</span><span class="st">s.&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb927-4"><a href="procesamiento-de-cadenas.html#cb927-4"></a><span class="kw">str_split</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">s{2,}&quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>)</span>
<span id="cb927-5"><a href="procesamiento-de-cadenas.html#cb927-5"></a>the_names_<span class="dv">1</span></span>
<span id="cb927-6"><a href="procesamiento-de-cadenas.html#cb927-6"></a><span class="co">#&gt;      [,1]           [,2]     [,3]           </span></span>
<span id="cb927-7"><a href="procesamiento-de-cadenas.html#cb927-7"></a><span class="co">#&gt; [1,] &quot;Applications&quot; &quot;Awards&quot; &quot;Success rates&quot;</span></span></code></pre></div>
<p>Ahora veremos <code>the_names_2</code>:</p>
<pre><code>#&gt;                         Discipline              Total     Men      Women
#&gt; n         Total    Men       Women          Total    Men      Women</code></pre>
<p>Aquí queremos recortar el espacio inicial y luego dividirlo por espacio como lo hicimos para la primera línea:</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="procesamiento-de-cadenas.html#cb929-1"></a>the_names_<span class="dv">2</span> &lt;-<span class="st"> </span>the_names_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb929-2"><a href="procesamiento-de-cadenas.html#cb929-2"></a><span class="kw">str_trim</span>() <span class="op">%&gt;%</span></span>
<span id="cb929-3"><a href="procesamiento-de-cadenas.html#cb929-3"></a><span class="kw">str_split</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">s+&quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>)</span>
<span id="cb929-4"><a href="procesamiento-de-cadenas.html#cb929-4"></a>the_names_<span class="dv">2</span></span>
<span id="cb929-5"><a href="procesamiento-de-cadenas.html#cb929-5"></a><span class="co">#&gt;      [,1]         [,2]    [,3]  [,4]    [,5]    [,6]  [,7]    [,8]   </span></span>
<span id="cb929-6"><a href="procesamiento-de-cadenas.html#cb929-6"></a><span class="co">#&gt; [1,] &quot;Discipline&quot; &quot;Total&quot; &quot;Men&quot; &quot;Women&quot; &quot;Total&quot; &quot;Men&quot; &quot;Women&quot; &quot;Total&quot;</span></span>
<span id="cb929-7"><a href="procesamiento-de-cadenas.html#cb929-7"></a><span class="co">#&gt;      [,9]  [,10]  </span></span>
<span id="cb929-8"><a href="procesamiento-de-cadenas.html#cb929-8"></a><span class="co">#&gt; [1,] &quot;Men&quot; &quot;Women&quot;</span></span></code></pre></div>
<p>Luego podemos unirlos para generar un nombre para cada columna:</p>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="procesamiento-de-cadenas.html#cb930-1"></a>tmp_names &lt;-<span class="st"> </span><span class="kw">str_c</span>(<span class="kw">rep</span>(the_names_<span class="dv">1</span>, <span class="dt">each =</span> <span class="dv">3</span>), the_names_<span class="dv">2</span>[<span class="op">-</span><span class="dv">1</span>], <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb930-2"><a href="procesamiento-de-cadenas.html#cb930-2"></a>the_names &lt;-<span class="st"> </span><span class="kw">c</span>(the_names_<span class="dv">2</span>[<span class="dv">1</span>], tmp_names) <span class="op">%&gt;%</span></span>
<span id="cb930-3"><a href="procesamiento-de-cadenas.html#cb930-3"></a><span class="kw">str_to_lower</span>() <span class="op">%&gt;%</span></span>
<span id="cb930-4"><a href="procesamiento-de-cadenas.html#cb930-4"></a><span class="kw">str_replace_all</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">s&quot;</span>, <span class="st">&quot;_&quot;</span>)</span>
<span id="cb930-5"><a href="procesamiento-de-cadenas.html#cb930-5"></a>the_names</span>
<span id="cb930-6"><a href="procesamiento-de-cadenas.html#cb930-6"></a><span class="co">#&gt;  [1] &quot;discipline&quot;          &quot;applications_total&quot;  &quot;applications_men&quot;   </span></span>
<span id="cb930-7"><a href="procesamiento-de-cadenas.html#cb930-7"></a><span class="co">#&gt;  [4] &quot;applications_women&quot;  &quot;awards_total&quot;        &quot;awards_men&quot;         </span></span>
<span id="cb930-8"><a href="procesamiento-de-cadenas.html#cb930-8"></a><span class="co">#&gt;  [7] &quot;awards_women&quot;        &quot;success_rates_total&quot; &quot;success_rates_men&quot;  </span></span>
<span id="cb930-9"><a href="procesamiento-de-cadenas.html#cb930-9"></a><span class="co">#&gt; [10] &quot;success_rates_women&quot;</span></span></code></pre></div>
<p>Ahora estamos listos para obtener los datos reales. Al examinar el <code>tab</code> objeto, notamos que la información está en las líneas 6 a 14. Podemos usar <code>str_split</code> de nuevo para lograr nuestro objetivo:</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="procesamiento-de-cadenas.html#cb931-1"></a>new_research_funding_rates &lt;-<span class="st"> </span>tab[<span class="dv">6</span><span class="op">:</span><span class="dv">14</span>] <span class="op">%&gt;%</span></span>
<span id="cb931-2"><a href="procesamiento-de-cadenas.html#cb931-2"></a>str_trim <span class="op">%&gt;%</span></span>
<span id="cb931-3"><a href="procesamiento-de-cadenas.html#cb931-3"></a><span class="kw">str_split</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">s{2,}&quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb931-4"><a href="procesamiento-de-cadenas.html#cb931-4"></a><span class="kw">data.frame</span>(<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb931-5"><a href="procesamiento-de-cadenas.html#cb931-5"></a><span class="kw">setNames</span>(the_names) <span class="op">%&gt;%</span></span>
<span id="cb931-6"><a href="procesamiento-de-cadenas.html#cb931-6"></a><span class="kw">mutate_at</span>(<span class="op">-</span><span class="dv">1</span>, parse_number)</span>
<span id="cb931-7"><a href="procesamiento-de-cadenas.html#cb931-7"></a>new_research_funding_rates <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>()</span>
<span id="cb931-8"><a href="procesamiento-de-cadenas.html#cb931-8"></a><span class="co">#&gt; # A tibble: 9 x 10</span></span>
<span id="cb931-9"><a href="procesamiento-de-cadenas.html#cb931-9"></a><span class="co">#&gt;   discipline applications_to… applications_men applications_wo…</span></span>
<span id="cb931-10"><a href="procesamiento-de-cadenas.html#cb931-10"></a><span class="co">#&gt;   &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb931-11"><a href="procesamiento-de-cadenas.html#cb931-11"></a><span class="co">#&gt; 1 Chemical …              122               83               39</span></span>
<span id="cb931-12"><a href="procesamiento-de-cadenas.html#cb931-12"></a><span class="co">#&gt; 2 Physical …              174              135               39</span></span>
<span id="cb931-13"><a href="procesamiento-de-cadenas.html#cb931-13"></a><span class="co">#&gt; 3 Physics                  76               67                9</span></span>
<span id="cb931-14"><a href="procesamiento-de-cadenas.html#cb931-14"></a><span class="co">#&gt; 4 Humanities              396              230              166</span></span>
<span id="cb931-15"><a href="procesamiento-de-cadenas.html#cb931-15"></a><span class="co">#&gt; 5 Technical…              251              189               62</span></span>
<span id="cb931-16"><a href="procesamiento-de-cadenas.html#cb931-16"></a><span class="co">#&gt; # … with 4 more rows, and 6 more variables: awards_total &lt;dbl&gt;,</span></span>
<span id="cb931-17"><a href="procesamiento-de-cadenas.html#cb931-17"></a><span class="co">#&gt; #   awards_men &lt;dbl&gt;, awards_women &lt;dbl&gt;, success_rates_total &lt;dbl&gt;,</span></span>
<span id="cb931-18"><a href="procesamiento-de-cadenas.html#cb931-18"></a><span class="co">#&gt; #   success_rates_men &lt;dbl&gt;, success_rates_women &lt;dbl&gt;</span></span></code></pre></div>
<p>Podemos ver que los objetos son idénticos:</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="procesamiento-de-cadenas.html#cb932-1"></a><span class="kw">identical</span>(research_funding_rates, new_research_funding_rates)</span>
<span id="cb932-2"><a href="procesamiento-de-cadenas.html#cb932-2"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="recode" class="section level2">
<h2><span class="header-section-number">24.13</span> Recodificación</h2>
<p>Otra operación común que involucra cadenas es recodificar los nombres de variables categóricas. Supongamos que tiene nombres realmente largos para sus niveles y los mostrará en diagramas, es posible que desee utilizar versiones más cortas de estos nombres. Por ejemplo, en los vectores de caracteres con nombres de países, es posible que desee cambiar “Estados Unidos de América” a “Estados Unidos” y “Reino Unido” a Reino Unido, y así sucesivamente. Podemos hacer esto con <code>case_when</code>, aunque <strong>tidyverse</strong> ofrece una opción específicamente diseñada para esta tarea: la <code>recode</code> función.</p>
<p>Aquí hay un ejemplo que muestra cómo cambiar el nombre de los países con nombres largos:</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="procesamiento-de-cadenas.html#cb933-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb933-2"><a href="procesamiento-de-cadenas.html#cb933-2"></a><span class="kw">data</span>(<span class="st">&quot;gapminder&quot;</span>)</span></code></pre></div>
<p>Supongamos que queremos mostrar series temporales de esperanza de vida por país para el Caribe:</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="procesamiento-de-cadenas.html#cb934-1"></a>gapminder <span class="op">%&gt;%</span></span>
<span id="cb934-2"><a href="procesamiento-de-cadenas.html#cb934-2"></a><span class="kw">filter</span>(region <span class="op">==</span><span class="st"> &quot;Caribbean&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb934-3"><a href="procesamiento-de-cadenas.html#cb934-3"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, life_expectancy, <span class="dt">color =</span> country)) <span class="op">+</span></span>
<span id="cb934-4"><a href="procesamiento-de-cadenas.html#cb934-4"></a><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="libro_files/figure-html/caribbean-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>La trama es lo que queremos, pero gran parte del espacio se desperdicia para acomodar algunos de los nombres largos de los países.
<!--

```r
gapminder %>%
filter(region == "Caribbean") %>%
filter(str_length(country) >= 12) %>%
distinct(country)
#>                          country
#> 1            Antigua and Barbuda
#> 2             Dominican Republic
#> 3 St. Vincent and the Grenadines
#> 4            Trinidad and Tobago
```
-->
Tenemos cuatro países con nombres de más de 12 caracteres. Estos nombres aparecen una vez por año en el conjunto de datos Gapminder. Una vez que elegimos los apodos, debemos cambiarlos todos de manera consistente. los <code>recode</code> la función se puede utilizar para hacer esto:</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="procesamiento-de-cadenas.html#cb935-1"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(region<span class="op">==</span><span class="st">&quot;Caribbean&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb935-2"><a href="procesamiento-de-cadenas.html#cb935-2"></a><span class="kw">mutate</span>(<span class="dt">country =</span> <span class="kw">recode</span>(country,</span>
<span id="cb935-3"><a href="procesamiento-de-cadenas.html#cb935-3"></a><span class="st">`</span><span class="dt">Antigua and Barbuda</span><span class="st">`</span> =<span class="st"> &quot;Barbuda&quot;</span>,</span>
<span id="cb935-4"><a href="procesamiento-de-cadenas.html#cb935-4"></a><span class="st">`</span><span class="dt">Dominican Republic</span><span class="st">`</span> =<span class="st"> &quot;DR&quot;</span>,</span>
<span id="cb935-5"><a href="procesamiento-de-cadenas.html#cb935-5"></a><span class="st">`</span><span class="dt">St. Vincent and the Grenadines</span><span class="st">`</span> =<span class="st"> &quot;St. Vincent&quot;</span>,</span>
<span id="cb935-6"><a href="procesamiento-de-cadenas.html#cb935-6"></a><span class="st">`</span><span class="dt">Trinidad and Tobago</span><span class="st">`</span> =<span class="st"> &quot;Trinidad&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb935-7"><a href="procesamiento-de-cadenas.html#cb935-7"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, life_expectancy, <span class="dt">color =</span> country)) <span class="op">+</span></span>
<span id="cb935-8"><a href="procesamiento-de-cadenas.html#cb935-8"></a><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="libro_files/figure-html/caribbean-with-nicknames-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Hay otras funciones similares en otros paquetes de R, como <code>recode_factor</code> y <code>fct_recoder</code> en el paquete <strong>forcats</strong>.</p>
</div>
<div id="ejercicios-41" class="section level2">
<h2><span class="header-section-number">24.14</span> Ejercicios</h2>
<p>1. Complete todas las lecciones y ejercicios en el tutorial interactivo en línea [<a href="https://regexone.com/font" class="uri">https://regexone.com/font</a>&gt;(<a href="https://regexone.com/" class="uri">https://regexone.com/</a>).</p>
<p>2. En el <code>extdata</code> en el directorio del paquete <strong>dslabs</strong>, encontrará un archivo PDF que contiene datos de mortalidad diaria para Puerto Rico del 1 de enero de 2015 al 31 de mayo de 2018. Puede encontrar el archivo de esta manera:</p>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="procesamiento-de-cadenas.html#cb936-1"></a>fn &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;RD-Mortality-Report_2015-18-180531.pdf&quot;</span>,</span>
<span id="cb936-2"><a href="procesamiento-de-cadenas.html#cb936-2"></a><span class="dt">package=</span><span class="st">&quot;dslabs&quot;</span>)</span></code></pre></div>
<p>Busque y abra el archivo o ábralo directamente desde RStudio. En una Mac, puede escribir:</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="procesamiento-de-cadenas.html#cb937-1"></a><span class="kw">system2</span>(<span class="st">&quot;open&quot;</span>, <span class="dt">args =</span> fn)</span></code></pre></div>
<p>y en Windows, puede escribir:</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="procesamiento-de-cadenas.html#cb938-1"></a><span class="kw">system</span>(<span class="st">&quot;cmd.exe&quot;</span>, <span class="dt">input =</span> <span class="kw">paste</span>(<span class="st">&quot;start&quot;</span>, fn))</span></code></pre></div>
<p>¿Cuál de las siguientes opciones describe mejor este archivo?</p>
<ol style="list-style-type: lower-alpha">
<li>Es una Mesa. Extraer los datos será fácil.
si. Es un informe escrito en prosa. Extraer los datos será imposible.</li>
<li>Es un informe que combina gráficos y tablas. Extraer los datos parece posible.
re. Muestra gráficos de los datos. Extraer los datos será difícil.</li>
</ol>
<p>3. Vamos a crear un conjunto de datos ordenado con cada fila que representa una observación. Las variables en este conjunto de datos serán año, mes, día y muertes.
Comience instalando y cargando el paquete <strong>pdftools</strong>:</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="procesamiento-de-cadenas.html#cb939-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;pdftools&quot;</span>)</span>
<span id="cb939-2"><a href="procesamiento-de-cadenas.html#cb939-2"></a><span class="kw">library</span>(pdftools)</span></code></pre></div>
<p>Ahora lee <code>fn</code> utilizando la <code>pdf_text</code> funcionar y almacenar los resultados en un objeto llamado <code>txt</code>. ¿Cuál de las siguientes opciones describe mejor lo que ves en <code>txt</code>?</p>
<ol style="list-style-type: lower-alpha">
<li>Una tabla con los datos de mortalidad.
si. Una cadena de caracteres de longitud 12. Cada entrada representa el texto en cada página. Los datos de mortalidad están allí en alguna parte.</li>
<li>Una cadena de caracteres con una entrada que contiene toda la información en el archivo PDF.
re. Un documento html.</li>
</ol>
<p>4. Extraiga la novena página del archivo PDF del objeto <code>txt</code>, luego use el <code>str_split</code> del paquete <strong>stringr</strong> para que tenga cada línea en una entrada diferente. Llame a este vector de cadena <code>s</code>. Luego mira el resultado y elige el que mejor describa lo que ves.</p>
<ol style="list-style-type: lower-alpha">
<li>Es una cadena vacía.
si. Puedo ver la figura que se muestra en la página 1.</li>
<li>Es una mesa ordenada.
re. ¡Puedo ver la mesa! Pero hay muchas otras cosas de las que debemos deshacernos.</li>
</ol>
<p>5. Qué tipo de objeto es <code>s</code> y cuantas entradas tiene?</p>
<p>6. Vemos que la salida es una lista con un componente. Redefinir <code>s</code> ser la primera entrada de la lista. Qué tipo de objeto es <code>s</code> y cuantas entradas tiene?</p>
<p>7. Al inspeccionar la cadena que obtuvimos anteriormente, vemos un problema común: espacios en blanco antes y después de los otros caracteres. El recorte es un primer paso común en el procesamiento de cadenas. Estos espacios adicionales eventualmente harán que dividir las cuerdas sea difícil, por lo que comenzamos por eliminarlas. Aprendimos sobre el comando <code>str_trim</code> que elimina espacios al principio o al final de las cadenas. Use esta función para recortar <code>s</code>.</p>
<p>8. Queremos extraer los números de las cadenas almacenadas en <code>s</code>. Sin embargo, hay muchos caracteres no numéricos que se interpondrán en el camino. Podemos eliminarlos, pero antes de hacerlo queremos preservar la cadena con el encabezado de la columna, que incluye la abreviatura del mes.
Utilizar el <code>str_which</code> función para encontrar las filas con un encabezado. Guarde estos resultados en <code>header_index</code>. Sugerencia: encuentre la primera cadena que coincida con el patrón <code>2015</code> utilizando la <code>str_which</code> función.</p>
<p>9. Ahora vamos a definir dos objetos: <code>month</code> almacenará el mes y <code>header</code> almacenará los nombres de columna. Identifique qué fila contiene el encabezado de la tabla. Guarde el contenido de la fila en un objeto llamado <code>header</code>, luego use <code>str_split</code> para ayudar a definir los dos objetos que necesitamos. Sugerencias: el separador aquí es uno o más espacios. Además, considere usar el <code>simplify</code> argumento.</p>
<p>10. Observe que hacia el final de la página verá una fila <em>totals</em> seguida de filas con otras estadísticas de resumen. Crea un objeto llamado <code>tail_index</code> con el índice de la entrada <em>totals</em>.</p>
<p>11. Debido a que nuestra página PDF incluye gráficos con números, algunas de nuestras filas tienen solo un número (desde el eje y de la gráfica). Utilizar el <code>str_count</code> función para crear un objeto <code>n</code> con el número de números en cada fila. Sugerencia: puede escribir una expresión regular para un número como este <code>\\d+</code>.</p>
<p>12. Ahora estamos listos para eliminar entradas de filas que sabemos que no necesitamos. La entrada <code>header_index</code> y todo antes de que se elimine. Entradas para las cuales <code>n</code> es 1 también debe eliminarse, y la entrada <code>tail_index</code> y todo lo que viene después debe ser eliminado también.</p>
<p>13. Ahora estamos listos para eliminar todas las entradas no numéricas. Haga esto usando regex y el <code>str_remove_all</code> función. Sugerencia: recuerde que en regex, usar la versión en mayúscula de un carácter especial generalmente significa lo contrario. Entonces <code>\\D</code> significa “no un dígito”. Recuerda que también quieres mantener espacios.</p>
<p>14. Para convertir las cadenas en una tabla, use el <code>str_split_fixed</code> función. Convertir <code>s</code> en una matriz de datos con solo los datos de recuento de días y muertes. Sugerencias: tenga en cuenta que el separador es uno o más espacios. Haz el argumento <code>n</code> un valor que limita el número de columnas a los valores en las 4 columnas y la última columna captura todas las cosas adicionales. Luego mantenga solo las primeras cuatro columnas.</p>
<p>15. Ahora ya casi estás listo para terminar. Agregue nombres de columna a la matriz, incluido uno llamado <code>day</code>. Además, agregue una columna con el mes. Llamar al objeto resultante <code>dat</code>. Finalmente, asegúrese de que el día sea un número entero, no un personaje. Sugerencia: use solo las primeras cinco columnas.</p>
<p>Dieciséis. Ahora termine ordenando <code>tab</code> con la función de reunir.</p>
<p>17. Haz un diagrama de muertes versus día con color para indicar el año. Excluya 2018 ya que no tenemos datos para todo el año.</p>
<p>18. Ahora que hemos discutido estos datos paso a paso, póngalos todos juntos en un fragmento R, usando la tubería tanto como sea posible. Sugerencia: primero defina los índices, luego escriba una línea de código que realice todo el procesamiento de la cadena.</p>
<p>19. Avanzado: volvamos al ejemplo de Nómina MLB desde la sección de scraping web. Use lo que aprendió en los capítulos de raspado de la web y procesamiento de cadenas para extraer la nómina de los Yankees de Nueva York, los Medias Rojas de Boston y los Atléticos de Oakland y trazarlos en función del tiempo.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="89">
<li id="fn89"><p><a href="https://www.rstudio.com/wp-content/uploads/2016/09/RegExCheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2016/09/RegExCheatsheet.pdf</a><a href="procesamiento-de-cadenas.html#fnref89" class="footnote-back">↩︎</a></p></li>
<li id="fn90"><p><a href="https://www.rstudio.com/wp-content/uploads/2016/09/RegExCheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2016/09/RegExCheatsheet.pdf</a><a href="procesamiento-de-cadenas.html#fnref90" class="footnote-back">↩︎</a></p></li>
<li id="fn91"><p><a href="http://www.pnas.org/content/112/40/12349.abstract" class="uri">http://www.pnas.org/content/112/40/12349.abstract</a><a href="procesamiento-de-cadenas.html#fnref91" class="footnote-back">↩︎</a></p></li>
<li id="fn92"><p><a href="http://www.pnas.org/content/112/40/12349" class="uri">http://www.pnas.org/content/112/40/12349</a><a href="procesamiento-de-cadenas.html#fnref92" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="web-scraping.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analizando-fechas-y-horas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rafalab/dslibro/edit/master/wrangling/string-processing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
